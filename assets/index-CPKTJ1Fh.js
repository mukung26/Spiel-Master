(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function tk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Lw={exports:{}},Bc={},Ow={exports:{}},se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dl=Symbol.for("react.element"),nk=Symbol.for("react.portal"),rk=Symbol.for("react.fragment"),ik=Symbol.for("react.strict_mode"),ok=Symbol.for("react.profiler"),sk=Symbol.for("react.provider"),ak=Symbol.for("react.context"),lk=Symbol.for("react.forward_ref"),uk=Symbol.for("react.suspense"),ck=Symbol.for("react.memo"),dk=Symbol.for("react.lazy"),pv=Symbol.iterator;function fk(t){return t===null||typeof t!="object"?null:(t=pv&&t[pv]||t["@@iterator"],typeof t=="function"?t:null)}var Uw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Fw=Object.assign,Vw={};function fs(t,e,n){this.props=t,this.context=e,this.refs=Vw,this.updater=n||Uw}fs.prototype.isReactComponent={};fs.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};fs.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Hw(){}Hw.prototype=fs.prototype;function Wp(t,e,n){this.props=t,this.context=e,this.refs=Vw,this.updater=n||Uw}var qp=Wp.prototype=new Hw;qp.constructor=Wp;Fw(qp,fs.prototype);qp.isPureReactComponent=!0;var gv=Array.isArray,Bw=Object.prototype.hasOwnProperty,Jp={current:null},Gw={key:!0,ref:!0,__self:!0,__source:!0};function zw(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)Bw.call(e,r)&&!Gw.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:dl,type:t,key:o,ref:s,props:i,_owner:Jp.current}}function hk(t,e){return{$$typeof:dl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function jp(t){return typeof t=="object"&&t!==null&&t.$$typeof===dl}function pk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var mv=/\/+/g;function Yd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?pk(""+t.key):e.toString(36)}function vu(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case dl:case nk:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+Yd(s,0):r,gv(i)?(n="",t!=null&&(n=t.replace(mv,"$&/")+"/"),vu(i,e,n,"",function(u){return u})):i!=null&&(jp(i)&&(i=hk(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(mv,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",gv(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+Yd(o,a);s+=vu(o,e,n,l,i)}else if(l=fk(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+Yd(o,a++),s+=vu(o,e,n,l,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function zl(t,e,n){if(t==null)return t;var r=[],i=0;return vu(t,r,"","",function(o){return e.call(n,o,i++)}),r}function gk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var At={current:null},yu={transition:null},mk={ReactCurrentDispatcher:At,ReactCurrentBatchConfig:yu,ReactCurrentOwner:Jp};function $w(){throw Error("act(...) is not supported in production builds of React.")}se.Children={map:zl,forEach:function(t,e,n){zl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return zl(t,function(){e++}),e},toArray:function(t){return zl(t,function(e){return e})||[]},only:function(t){if(!jp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};se.Component=fs;se.Fragment=rk;se.Profiler=ok;se.PureComponent=Wp;se.StrictMode=ik;se.Suspense=uk;se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mk;se.act=$w;se.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Fw({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=Jp.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Bw.call(e,l)&&!Gw.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:dl,type:t.type,key:i,ref:o,props:r,_owner:s}};se.createContext=function(t){return t={$$typeof:ak,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sk,_context:t},t.Consumer=t};se.createElement=zw;se.createFactory=function(t){var e=zw.bind(null,t);return e.type=t,e};se.createRef=function(){return{current:null}};se.forwardRef=function(t){return{$$typeof:lk,render:t}};se.isValidElement=jp;se.lazy=function(t){return{$$typeof:dk,_payload:{_status:-1,_result:t},_init:gk}};se.memo=function(t,e){return{$$typeof:ck,type:t,compare:e===void 0?null:e}};se.startTransition=function(t){var e=yu.transition;yu.transition={};try{t()}finally{yu.transition=e}};se.unstable_act=$w;se.useCallback=function(t,e){return At.current.useCallback(t,e)};se.useContext=function(t){return At.current.useContext(t)};se.useDebugValue=function(){};se.useDeferredValue=function(t){return At.current.useDeferredValue(t)};se.useEffect=function(t,e){return At.current.useEffect(t,e)};se.useId=function(){return At.current.useId()};se.useImperativeHandle=function(t,e,n){return At.current.useImperativeHandle(t,e,n)};se.useInsertionEffect=function(t,e){return At.current.useInsertionEffect(t,e)};se.useLayoutEffect=function(t,e){return At.current.useLayoutEffect(t,e)};se.useMemo=function(t,e){return At.current.useMemo(t,e)};se.useReducer=function(t,e,n){return At.current.useReducer(t,e,n)};se.useRef=function(t){return At.current.useRef(t)};se.useState=function(t){return At.current.useState(t)};se.useSyncExternalStore=function(t,e,n){return At.current.useSyncExternalStore(t,e,n)};se.useTransition=function(){return At.current.useTransition()};se.version="18.3.1";Ow.exports=se;var S=Ow.exports;const kt=tk(S);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vk=S,yk=Symbol.for("react.element"),_k=Symbol.for("react.fragment"),wk=Object.prototype.hasOwnProperty,xk=vk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ek={key:!0,ref:!0,__self:!0,__source:!0};function Ww(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)wk.call(e,r)&&!Ek.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:yk,type:t,key:o,ref:s,props:i,_owner:xk.current}}Bc.Fragment=_k;Bc.jsx=Ww;Bc.jsxs=Ww;Lw.exports=Bc;var g=Lw.exports,Jf={},qw={exports:{}},nn={},Jw={exports:{}},jw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,P){var A=V.length;V.push(P);e:for(;0<A;){var B=A-1>>>1,$=V[B];if(0<i($,P))V[B]=P,V[A]=$,A=B;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var P=V[0],A=V.pop();if(A!==P){V[0]=A;e:for(var B=0,$=V.length,q=$>>>1;B<q;){var ue=2*(B+1)-1,ve=V[ue],ae=ue+1,Ae=V[ae];if(0>i(ve,A))ae<$&&0>i(Ae,ve)?(V[B]=Ae,V[ae]=A,B=ae):(V[B]=ve,V[ue]=A,B=ue);else if(ae<$&&0>i(Ae,A))V[B]=Ae,V[ae]=A,B=ae;else break e}}return P}function i(V,P){var A=V.sortIndex-P.sortIndex;return A!==0?A:V.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],u=[],f=1,h=null,p=3,m=!1,_=!1,x=!1,C=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(V){for(var P=n(u);P!==null;){if(P.callback===null)r(u);else if(P.startTime<=V)r(u),P.sortIndex=P.expirationTime,e(l,P);else break;P=n(u)}}function E(V){if(x=!1,v(V),!_)if(n(l)!==null)_=!0,Oe(I);else{var P=n(u);P!==null&&ee(E,P.startTime-V)}}function I(V,P){_=!1,x&&(x=!1,y(T),T=-1),m=!0;var A=p;try{for(v(P),h=n(l);h!==null&&(!(h.expirationTime>P)||V&&!D());){var B=h.callback;if(typeof B=="function"){h.callback=null,p=h.priorityLevel;var $=B(h.expirationTime<=P);P=t.unstable_now(),typeof $=="function"?h.callback=$:h===n(l)&&r(l),v(P)}else r(l);h=n(l)}if(h!==null)var q=!0;else{var ue=n(u);ue!==null&&ee(E,ue.startTime-P),q=!1}return q}finally{h=null,p=A,m=!1}}var k=!1,b=null,T=-1,R=5,N=-1;function D(){return!(t.unstable_now()-N<R)}function G(){if(b!==null){var V=t.unstable_now();N=V;var P=!0;try{P=b(!0,V)}finally{P?F():(k=!1,b=null)}}else k=!1}var F;if(typeof w=="function")F=function(){w(G)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,re=J.port2;J.port1.onmessage=G,F=function(){re.postMessage(null)}}else F=function(){C(G,0)};function Oe(V){b=V,k||(k=!0,F())}function ee(V,P){T=C(function(){V(t.unstable_now())},P)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){_||m||(_=!0,Oe(I))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(V){switch(p){case 1:case 2:case 3:var P=3;break;default:P=p}var A=p;p=P;try{return V()}finally{p=A}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,P){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var A=p;p=V;try{return P()}finally{p=A}},t.unstable_scheduleCallback=function(V,P,A){var B=t.unstable_now();switch(typeof A=="object"&&A!==null?(A=A.delay,A=typeof A=="number"&&0<A?B+A:B):A=B,V){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=A+$,V={id:f++,callback:P,priorityLevel:V,startTime:A,expirationTime:$,sortIndex:-1},A>B?(V.sortIndex=A,e(u,V),n(l)===null&&V===n(u)&&(x?(y(T),T=-1):x=!0,ee(E,A-B))):(V.sortIndex=$,e(l,V),_||m||(_=!0,Oe(I))),V},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(V){var P=p;return function(){var A=p;p=P;try{return V.apply(this,arguments)}finally{p=A}}}})(jw);Jw.exports=jw;var Ck=Jw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sk=S,Zt=Ck;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Kw=new Set,Ta={};function no(t,e){Yo(t,e),Yo(t+"Capture",e)}function Yo(t,e){for(Ta[t]=e,t=0;t<e.length;t++)Kw.add(e[t])}var gr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jf=Object.prototype.hasOwnProperty,Tk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vv={},yv={};function Ik(t){return jf.call(yv,t)?!0:jf.call(vv,t)?!1:Tk.test(t)?yv[t]=!0:(vv[t]=!0,!1)}function kk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bk(t,e,n,r){if(e===null||typeof e>"u"||kk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Pt(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ft[t]=new Pt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ft[e]=new Pt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ft[t]=new Pt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ft[t]=new Pt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ft[t]=new Pt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ft[t]=new Pt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ft[t]=new Pt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ft[t]=new Pt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ft[t]=new Pt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Kp=/[\-:]([a-z])/g;function Yp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Kp,Yp);ft[e]=new Pt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Kp,Yp);ft[e]=new Pt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Kp,Yp);ft[e]=new Pt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ft[t]=new Pt(t,1,!1,t.toLowerCase(),null,!1,!1)});ft.xlinkHref=new Pt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ft[t]=new Pt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Qp(t,e,n,r){var i=ft.hasOwnProperty(e)?ft[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bk(e,n,i,r)&&(n=null),r||i===null?Ik(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Sr=Sk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$l=Symbol.for("react.element"),_o=Symbol.for("react.portal"),wo=Symbol.for("react.fragment"),Xp=Symbol.for("react.strict_mode"),Kf=Symbol.for("react.profiler"),Yw=Symbol.for("react.provider"),Qw=Symbol.for("react.context"),Zp=Symbol.for("react.forward_ref"),Yf=Symbol.for("react.suspense"),Qf=Symbol.for("react.suspense_list"),eg=Symbol.for("react.memo"),Ur=Symbol.for("react.lazy"),Xw=Symbol.for("react.offscreen"),_v=Symbol.iterator;function Ls(t){return t===null||typeof t!="object"?null:(t=_v&&t[_v]||t["@@iterator"],typeof t=="function"?t:null)}var Le=Object.assign,Qd;function Xs(t){if(Qd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Qd=e&&e[1]||""}return`
`+Qd+t}var Xd=!1;function Zd(t,e){if(!t||Xd)return"";Xd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{Xd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xs(t):""}function Nk(t){switch(t.tag){case 5:return Xs(t.type);case 16:return Xs("Lazy");case 13:return Xs("Suspense");case 19:return Xs("SuspenseList");case 0:case 2:case 15:return t=Zd(t.type,!1),t;case 11:return t=Zd(t.type.render,!1),t;case 1:return t=Zd(t.type,!0),t;default:return""}}function Xf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case wo:return"Fragment";case _o:return"Portal";case Kf:return"Profiler";case Xp:return"StrictMode";case Yf:return"Suspense";case Qf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Qw:return(t.displayName||"Context")+".Consumer";case Yw:return(t._context.displayName||"Context")+".Provider";case Zp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case eg:return e=t.displayName||null,e!==null?e:Xf(t.type)||"Memo";case Ur:e=t._payload,t=t._init;try{return Xf(t(e))}catch{}}return null}function Rk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xf(e);case 8:return e===Xp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function si(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Zw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ak(t){var e=Zw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Wl(t){t._valueTracker||(t._valueTracker=Ak(t))}function ex(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Zw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Uu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Zf(t,e){var n=e.checked;return Le({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function wv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=si(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function tx(t,e){e=e.checked,e!=null&&Qp(t,"checked",e,!1)}function eh(t,e){tx(t,e);var n=si(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?th(t,e.type,n):e.hasOwnProperty("defaultValue")&&th(t,e.type,si(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function xv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function th(t,e,n){(e!=="number"||Uu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Zs=Array.isArray;function Lo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+si(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function nh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return Le({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ev(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(L(92));if(Zs(n)){if(1<n.length)throw Error(L(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:si(n)}}function nx(t,e){var n=si(e.value),r=si(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Cv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ql,ix=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ql=ql||document.createElement("div"),ql.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ql.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ia(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var oa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pk=["Webkit","ms","Moz","O"];Object.keys(oa).forEach(function(t){Pk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),oa[e]=oa[t]})});function ox(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||oa.hasOwnProperty(t)&&oa[t]?(""+e).trim():e+"px"}function sx(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=ox(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Mk=Le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ih(t,e){if(e){if(Mk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function oh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sh=null;function tg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ah=null,Oo=null,Uo=null;function Sv(t){if(t=pl(t)){if(typeof ah!="function")throw Error(L(280));var e=t.stateNode;e&&(e=qc(e),ah(t.stateNode,t.type,e))}}function ax(t){Oo?Uo?Uo.push(t):Uo=[t]:Oo=t}function lx(){if(Oo){var t=Oo,e=Uo;if(Uo=Oo=null,Sv(t),e)for(t=0;t<e.length;t++)Sv(e[t])}}function ux(t,e){return t(e)}function cx(){}var ef=!1;function dx(t,e,n){if(ef)return t(e,n);ef=!0;try{return ux(t,e,n)}finally{ef=!1,(Oo!==null||Uo!==null)&&(cx(),lx())}}function ka(t,e){var n=t.stateNode;if(n===null)return null;var r=qc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(L(231,e,typeof n));return n}var lh=!1;if(gr)try{var Os={};Object.defineProperty(Os,"passive",{get:function(){lh=!0}}),window.addEventListener("test",Os,Os),window.removeEventListener("test",Os,Os)}catch{lh=!1}function Dk(t,e,n,r,i,o,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(f){this.onError(f)}}var sa=!1,Fu=null,Vu=!1,uh=null,Lk={onError:function(t){sa=!0,Fu=t}};function Ok(t,e,n,r,i,o,s,a,l){sa=!1,Fu=null,Dk.apply(Lk,arguments)}function Uk(t,e,n,r,i,o,s,a,l){if(Ok.apply(this,arguments),sa){if(sa){var u=Fu;sa=!1,Fu=null}else throw Error(L(198));Vu||(Vu=!0,uh=u)}}function ro(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function fx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Tv(t){if(ro(t)!==t)throw Error(L(188))}function Fk(t){var e=t.alternate;if(!e){if(e=ro(t),e===null)throw Error(L(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Tv(i),t;if(o===r)return Tv(i),e;o=o.sibling}throw Error(L(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(L(189))}}if(n.alternate!==r)throw Error(L(190))}if(n.tag!==3)throw Error(L(188));return n.stateNode.current===n?t:e}function hx(t){return t=Fk(t),t!==null?px(t):null}function px(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=px(t);if(e!==null)return e;t=t.sibling}return null}var gx=Zt.unstable_scheduleCallback,Iv=Zt.unstable_cancelCallback,Vk=Zt.unstable_shouldYield,Hk=Zt.unstable_requestPaint,Ge=Zt.unstable_now,Bk=Zt.unstable_getCurrentPriorityLevel,ng=Zt.unstable_ImmediatePriority,mx=Zt.unstable_UserBlockingPriority,Hu=Zt.unstable_NormalPriority,Gk=Zt.unstable_LowPriority,vx=Zt.unstable_IdlePriority,Gc=null,Qn=null;function zk(t){if(Qn&&typeof Qn.onCommitFiberRoot=="function")try{Qn.onCommitFiberRoot(Gc,t,void 0,(t.current.flags&128)===128)}catch{}}var Nn=Math.clz32?Math.clz32:qk,$k=Math.log,Wk=Math.LN2;function qk(t){return t>>>=0,t===0?32:31-($k(t)/Wk|0)|0}var Jl=64,jl=4194304;function ea(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Bu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=ea(a):(o&=s,o!==0&&(r=ea(o)))}else s=n&~i,s!==0?r=ea(s):o!==0&&(r=ea(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Nn(e),i=1<<n,r|=t[n],e&=~i;return r}function Jk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jk(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-Nn(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=Jk(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function ch(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function yx(){var t=Jl;return Jl<<=1,!(Jl&4194240)&&(Jl=64),t}function tf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function fl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Nn(e),t[e]=n}function Kk(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Nn(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function rg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Nn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var me=0;function _x(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var wx,ig,xx,Ex,Cx,dh=!1,Kl=[],jr=null,Kr=null,Yr=null,ba=new Map,Na=new Map,Hr=[],Yk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kv(t,e){switch(t){case"focusin":case"focusout":jr=null;break;case"dragenter":case"dragleave":Kr=null;break;case"mouseover":case"mouseout":Yr=null;break;case"pointerover":case"pointerout":ba.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Na.delete(e.pointerId)}}function Us(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=pl(e),e!==null&&ig(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Qk(t,e,n,r,i){switch(e){case"focusin":return jr=Us(jr,t,e,n,r,i),!0;case"dragenter":return Kr=Us(Kr,t,e,n,r,i),!0;case"mouseover":return Yr=Us(Yr,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return ba.set(o,Us(ba.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Na.set(o,Us(Na.get(o)||null,t,e,n,r,i)),!0}return!1}function Sx(t){var e=Mi(t.target);if(e!==null){var n=ro(e);if(n!==null){if(e=n.tag,e===13){if(e=fx(n),e!==null){t.blockedOn=e,Cx(t.priority,function(){xx(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _u(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=fh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);sh=r,n.target.dispatchEvent(r),sh=null}else return e=pl(n),e!==null&&ig(e),t.blockedOn=n,!1;e.shift()}return!0}function bv(t,e,n){_u(t)&&n.delete(e)}function Xk(){dh=!1,jr!==null&&_u(jr)&&(jr=null),Kr!==null&&_u(Kr)&&(Kr=null),Yr!==null&&_u(Yr)&&(Yr=null),ba.forEach(bv),Na.forEach(bv)}function Fs(t,e){t.blockedOn===e&&(t.blockedOn=null,dh||(dh=!0,Zt.unstable_scheduleCallback(Zt.unstable_NormalPriority,Xk)))}function Ra(t){function e(i){return Fs(i,t)}if(0<Kl.length){Fs(Kl[0],t);for(var n=1;n<Kl.length;n++){var r=Kl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(jr!==null&&Fs(jr,t),Kr!==null&&Fs(Kr,t),Yr!==null&&Fs(Yr,t),ba.forEach(e),Na.forEach(e),n=0;n<Hr.length;n++)r=Hr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Hr.length&&(n=Hr[0],n.blockedOn===null);)Sx(n),n.blockedOn===null&&Hr.shift()}var Fo=Sr.ReactCurrentBatchConfig,Gu=!0;function Zk(t,e,n,r){var i=me,o=Fo.transition;Fo.transition=null;try{me=1,og(t,e,n,r)}finally{me=i,Fo.transition=o}}function eb(t,e,n,r){var i=me,o=Fo.transition;Fo.transition=null;try{me=4,og(t,e,n,r)}finally{me=i,Fo.transition=o}}function og(t,e,n,r){if(Gu){var i=fh(t,e,n,r);if(i===null)ff(t,e,r,zu,n),kv(t,r);else if(Qk(i,t,e,n,r))r.stopPropagation();else if(kv(t,r),e&4&&-1<Yk.indexOf(t)){for(;i!==null;){var o=pl(i);if(o!==null&&wx(o),o=fh(t,e,n,r),o===null&&ff(t,e,r,zu,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else ff(t,e,r,null,n)}}var zu=null;function fh(t,e,n,r){if(zu=null,t=tg(r),t=Mi(t),t!==null)if(e=ro(t),e===null)t=null;else if(n=e.tag,n===13){if(t=fx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return zu=t,null}function Tx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bk()){case ng:return 1;case mx:return 4;case Hu:case Gk:return 16;case vx:return 536870912;default:return 16}default:return 16}}var Gr=null,sg=null,wu=null;function Ix(){if(wu)return wu;var t,e=sg,n=e.length,r,i="value"in Gr?Gr.value:Gr.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return wu=i.slice(t,1<r?1-r:void 0)}function xu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Yl(){return!0}function Nv(){return!1}function rn(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Yl:Nv,this.isPropagationStopped=Nv,this}return Le(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Yl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Yl)},persist:function(){},isPersistent:Yl}),e}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ag=rn(hs),hl=Le({},hs,{view:0,detail:0}),tb=rn(hl),nf,rf,Vs,zc=Le({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Vs&&(Vs&&t.type==="mousemove"?(nf=t.screenX-Vs.screenX,rf=t.screenY-Vs.screenY):rf=nf=0,Vs=t),nf)},movementY:function(t){return"movementY"in t?t.movementY:rf}}),Rv=rn(zc),nb=Le({},zc,{dataTransfer:0}),rb=rn(nb),ib=Le({},hl,{relatedTarget:0}),of=rn(ib),ob=Le({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),sb=rn(ob),ab=Le({},hs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),lb=rn(ab),ub=Le({},hs,{data:0}),Av=rn(ub),cb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},db={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=fb[t])?!!e[t]:!1}function lg(){return hb}var pb=Le({},hl,{key:function(t){if(t.key){var e=cb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=xu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?db[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lg,charCode:function(t){return t.type==="keypress"?xu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?xu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),gb=rn(pb),mb=Le({},zc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pv=rn(mb),vb=Le({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lg}),yb=rn(vb),_b=Le({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),wb=rn(_b),xb=Le({},zc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Eb=rn(xb),Cb=[9,13,27,32],ug=gr&&"CompositionEvent"in window,aa=null;gr&&"documentMode"in document&&(aa=document.documentMode);var Sb=gr&&"TextEvent"in window&&!aa,kx=gr&&(!ug||aa&&8<aa&&11>=aa),Mv=" ",Dv=!1;function bx(t,e){switch(t){case"keyup":return Cb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var xo=!1;function Tb(t,e){switch(t){case"compositionend":return Nx(e);case"keypress":return e.which!==32?null:(Dv=!0,Mv);case"textInput":return t=e.data,t===Mv&&Dv?null:t;default:return null}}function Ib(t,e){if(xo)return t==="compositionend"||!ug&&bx(t,e)?(t=Ix(),wu=sg=Gr=null,xo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return kx&&e.locale!=="ko"?null:e.data;default:return null}}var kb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!kb[t.type]:e==="textarea"}function Rx(t,e,n,r){ax(r),e=$u(e,"onChange"),0<e.length&&(n=new ag("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var la=null,Aa=null;function bb(t){Bx(t,0)}function $c(t){var e=So(t);if(ex(e))return t}function Nb(t,e){if(t==="change")return e}var Ax=!1;if(gr){var sf;if(gr){var af="oninput"in document;if(!af){var Ov=document.createElement("div");Ov.setAttribute("oninput","return;"),af=typeof Ov.oninput=="function"}sf=af}else sf=!1;Ax=sf&&(!document.documentMode||9<document.documentMode)}function Uv(){la&&(la.detachEvent("onpropertychange",Px),Aa=la=null)}function Px(t){if(t.propertyName==="value"&&$c(Aa)){var e=[];Rx(e,Aa,t,tg(t)),dx(bb,e)}}function Rb(t,e,n){t==="focusin"?(Uv(),la=e,Aa=n,la.attachEvent("onpropertychange",Px)):t==="focusout"&&Uv()}function Ab(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return $c(Aa)}function Pb(t,e){if(t==="click")return $c(e)}function Mb(t,e){if(t==="input"||t==="change")return $c(e)}function Db(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ln=typeof Object.is=="function"?Object.is:Db;function Pa(t,e){if(Ln(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!jf.call(e,i)||!Ln(t[i],e[i]))return!1}return!0}function Fv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Vv(t,e){var n=Fv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Fv(n)}}function Mx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Mx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Dx(){for(var t=window,e=Uu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Uu(t.document)}return e}function cg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Lb(t){var e=Dx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Mx(n.ownerDocument.documentElement,n)){if(r!==null&&cg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=Vv(n,o);var s=Vv(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Ob=gr&&"documentMode"in document&&11>=document.documentMode,Eo=null,hh=null,ua=null,ph=!1;function Hv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ph||Eo==null||Eo!==Uu(r)||(r=Eo,"selectionStart"in r&&cg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ua&&Pa(ua,r)||(ua=r,r=$u(hh,"onSelect"),0<r.length&&(e=new ag("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Eo)))}function Ql(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Co={animationend:Ql("Animation","AnimationEnd"),animationiteration:Ql("Animation","AnimationIteration"),animationstart:Ql("Animation","AnimationStart"),transitionend:Ql("Transition","TransitionEnd")},lf={},Lx={};gr&&(Lx=document.createElement("div").style,"AnimationEvent"in window||(delete Co.animationend.animation,delete Co.animationiteration.animation,delete Co.animationstart.animation),"TransitionEvent"in window||delete Co.transitionend.transition);function Wc(t){if(lf[t])return lf[t];if(!Co[t])return t;var e=Co[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Lx)return lf[t]=e[n];return t}var Ox=Wc("animationend"),Ux=Wc("animationiteration"),Fx=Wc("animationstart"),Vx=Wc("transitionend"),Hx=new Map,Bv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mi(t,e){Hx.set(t,e),no(e,[t])}for(var uf=0;uf<Bv.length;uf++){var cf=Bv[uf],Ub=cf.toLowerCase(),Fb=cf[0].toUpperCase()+cf.slice(1);mi(Ub,"on"+Fb)}mi(Ox,"onAnimationEnd");mi(Ux,"onAnimationIteration");mi(Fx,"onAnimationStart");mi("dblclick","onDoubleClick");mi("focusin","onFocus");mi("focusout","onBlur");mi(Vx,"onTransitionEnd");Yo("onMouseEnter",["mouseout","mouseover"]);Yo("onMouseLeave",["mouseout","mouseover"]);Yo("onPointerEnter",["pointerout","pointerover"]);Yo("onPointerLeave",["pointerout","pointerover"]);no("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));no("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));no("onBeforeInput",["compositionend","keypress","textInput","paste"]);no("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));no("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));no("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ta="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vb=new Set("cancel close invalid load scroll toggle".split(" ").concat(ta));function Gv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Uk(r,e,void 0,t),t.currentTarget=null}function Bx(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;Gv(i,a,u),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;Gv(i,a,u),o=l}}}if(Vu)throw t=uh,Vu=!1,uh=null,t}function ke(t,e){var n=e[_h];n===void 0&&(n=e[_h]=new Set);var r=t+"__bubble";n.has(r)||(Gx(e,t,2,!1),n.add(r))}function df(t,e,n){var r=0;e&&(r|=4),Gx(n,t,r,e)}var Xl="_reactListening"+Math.random().toString(36).slice(2);function Ma(t){if(!t[Xl]){t[Xl]=!0,Kw.forEach(function(n){n!=="selectionchange"&&(Vb.has(n)||df(n,!1,t),df(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Xl]||(e[Xl]=!0,df("selectionchange",!1,e))}}function Gx(t,e,n,r){switch(Tx(e)){case 1:var i=Zk;break;case 4:i=eb;break;default:i=og}n=i.bind(null,e,n,t),i=void 0,!lh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function ff(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Mi(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}dx(function(){var u=o,f=tg(n),h=[];e:{var p=Hx.get(t);if(p!==void 0){var m=ag,_=t;switch(t){case"keypress":if(xu(n)===0)break e;case"keydown":case"keyup":m=gb;break;case"focusin":_="focus",m=of;break;case"focusout":_="blur",m=of;break;case"beforeblur":case"afterblur":m=of;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Rv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=rb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=yb;break;case Ox:case Ux:case Fx:m=sb;break;case Vx:m=wb;break;case"scroll":m=tb;break;case"wheel":m=Eb;break;case"copy":case"cut":case"paste":m=lb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Pv}var x=(e&4)!==0,C=!x&&t==="scroll",y=x?p!==null?p+"Capture":null:p;x=[];for(var w=u,v;w!==null;){v=w;var E=v.stateNode;if(v.tag===5&&E!==null&&(v=E,y!==null&&(E=ka(w,y),E!=null&&x.push(Da(w,E,v)))),C)break;w=w.return}0<x.length&&(p=new m(p,_,null,n,f),h.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",p&&n!==sh&&(_=n.relatedTarget||n.fromElement)&&(Mi(_)||_[mr]))break e;if((m||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,m?(_=n.relatedTarget||n.toElement,m=u,_=_?Mi(_):null,_!==null&&(C=ro(_),_!==C||_.tag!==5&&_.tag!==6)&&(_=null)):(m=null,_=u),m!==_)){if(x=Rv,E="onMouseLeave",y="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(x=Pv,E="onPointerLeave",y="onPointerEnter",w="pointer"),C=m==null?p:So(m),v=_==null?p:So(_),p=new x(E,w+"leave",m,n,f),p.target=C,p.relatedTarget=v,E=null,Mi(f)===u&&(x=new x(y,w+"enter",_,n,f),x.target=v,x.relatedTarget=C,E=x),C=E,m&&_)t:{for(x=m,y=_,w=0,v=x;v;v=go(v))w++;for(v=0,E=y;E;E=go(E))v++;for(;0<w-v;)x=go(x),w--;for(;0<v-w;)y=go(y),v--;for(;w--;){if(x===y||y!==null&&x===y.alternate)break t;x=go(x),y=go(y)}x=null}else x=null;m!==null&&zv(h,p,m,x,!1),_!==null&&C!==null&&zv(h,C,_,x,!0)}}e:{if(p=u?So(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var I=Nb;else if(Lv(p))if(Ax)I=Mb;else{I=Ab;var k=Rb}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(I=Pb);if(I&&(I=I(t,u))){Rx(h,I,n,f);break e}k&&k(t,p,u),t==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&th(p,"number",p.value)}switch(k=u?So(u):window,t){case"focusin":(Lv(k)||k.contentEditable==="true")&&(Eo=k,hh=u,ua=null);break;case"focusout":ua=hh=Eo=null;break;case"mousedown":ph=!0;break;case"contextmenu":case"mouseup":case"dragend":ph=!1,Hv(h,n,f);break;case"selectionchange":if(Ob)break;case"keydown":case"keyup":Hv(h,n,f)}var b;if(ug)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else xo?bx(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(kx&&n.locale!=="ko"&&(xo||T!=="onCompositionStart"?T==="onCompositionEnd"&&xo&&(b=Ix()):(Gr=f,sg="value"in Gr?Gr.value:Gr.textContent,xo=!0)),k=$u(u,T),0<k.length&&(T=new Av(T,t,null,n,f),h.push({event:T,listeners:k}),b?T.data=b:(b=Nx(n),b!==null&&(T.data=b)))),(b=Sb?Tb(t,n):Ib(t,n))&&(u=$u(u,"onBeforeInput"),0<u.length&&(f=new Av("onBeforeInput","beforeinput",null,n,f),h.push({event:f,listeners:u}),f.data=b))}Bx(h,e)})}function Da(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $u(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=ka(t,n),o!=null&&r.unshift(Da(t,o,i)),o=ka(t,e),o!=null&&r.push(Da(t,o,i))),t=t.return}return r}function go(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function zv(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=ka(n,o),l!=null&&s.unshift(Da(n,l,a))):i||(l=ka(n,o),l!=null&&s.push(Da(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var Hb=/\r\n?/g,Bb=/\u0000|\uFFFD/g;function $v(t){return(typeof t=="string"?t:""+t).replace(Hb,`
`).replace(Bb,"")}function Zl(t,e,n){if(e=$v(e),$v(t)!==e&&n)throw Error(L(425))}function Wu(){}var gh=null,mh=null;function vh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var yh=typeof setTimeout=="function"?setTimeout:void 0,Gb=typeof clearTimeout=="function"?clearTimeout:void 0,Wv=typeof Promise=="function"?Promise:void 0,zb=typeof queueMicrotask=="function"?queueMicrotask:typeof Wv<"u"?function(t){return Wv.resolve(null).then(t).catch($b)}:yh;function $b(t){setTimeout(function(){throw t})}function hf(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ra(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ra(e)}function Qr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function qv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ps=Math.random().toString(36).slice(2),Wn="__reactFiber$"+ps,La="__reactProps$"+ps,mr="__reactContainer$"+ps,_h="__reactEvents$"+ps,Wb="__reactListeners$"+ps,qb="__reactHandles$"+ps;function Mi(t){var e=t[Wn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[mr]||n[Wn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=qv(t);t!==null;){if(n=t[Wn])return n;t=qv(t)}return e}t=n,n=t.parentNode}return null}function pl(t){return t=t[Wn]||t[mr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function So(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function qc(t){return t[La]||null}var wh=[],To=-1;function vi(t){return{current:t}}function be(t){0>To||(t.current=wh[To],wh[To]=null,To--)}function Te(t,e){To++,wh[To]=t.current,t.current=e}var ai={},xt=vi(ai),Vt=vi(!1),zi=ai;function Qo(t,e){var n=t.type.contextTypes;if(!n)return ai;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ht(t){return t=t.childContextTypes,t!=null}function qu(){be(Vt),be(xt)}function Jv(t,e,n){if(xt.current!==ai)throw Error(L(168));Te(xt,e),Te(Vt,n)}function zx(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(L(108,Rk(t)||"Unknown",i));return Le({},n,r)}function Ju(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ai,zi=xt.current,Te(xt,t),Te(Vt,Vt.current),!0}function jv(t,e,n){var r=t.stateNode;if(!r)throw Error(L(169));n?(t=zx(t,e,zi),r.__reactInternalMemoizedMergedChildContext=t,be(Vt),be(xt),Te(xt,t)):be(Vt),Te(Vt,n)}var or=null,Jc=!1,pf=!1;function $x(t){or===null?or=[t]:or.push(t)}function Jb(t){Jc=!0,$x(t)}function yi(){if(!pf&&or!==null){pf=!0;var t=0,e=me;try{var n=or;for(me=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}or=null,Jc=!1}catch(i){throw or!==null&&(or=or.slice(t+1)),gx(ng,yi),i}finally{me=e,pf=!1}}return null}var Io=[],ko=0,ju=null,Ku=0,an=[],ln=0,$i=null,sr=1,ar="";function bi(t,e){Io[ko++]=Ku,Io[ko++]=ju,ju=t,Ku=e}function Wx(t,e,n){an[ln++]=sr,an[ln++]=ar,an[ln++]=$i,$i=t;var r=sr;t=ar;var i=32-Nn(r)-1;r&=~(1<<i),n+=1;var o=32-Nn(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,sr=1<<32-Nn(e)+i|n<<i|r,ar=o+t}else sr=1<<o|n<<i|r,ar=t}function dg(t){t.return!==null&&(bi(t,1),Wx(t,1,0))}function fg(t){for(;t===ju;)ju=Io[--ko],Io[ko]=null,Ku=Io[--ko],Io[ko]=null;for(;t===$i;)$i=an[--ln],an[ln]=null,ar=an[--ln],an[ln]=null,sr=an[--ln],an[ln]=null}var Qt=null,Kt=null,Ne=!1,kn=null;function qx(t,e){var n=cn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Kv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Qt=t,Kt=Qr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Qt=t,Kt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=$i!==null?{id:sr,overflow:ar}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=cn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Qt=t,Kt=null,!0):!1;default:return!1}}function xh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Eh(t){if(Ne){var e=Kt;if(e){var n=e;if(!Kv(t,e)){if(xh(t))throw Error(L(418));e=Qr(n.nextSibling);var r=Qt;e&&Kv(t,e)?qx(r,n):(t.flags=t.flags&-4097|2,Ne=!1,Qt=t)}}else{if(xh(t))throw Error(L(418));t.flags=t.flags&-4097|2,Ne=!1,Qt=t}}}function Yv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qt=t}function eu(t){if(t!==Qt)return!1;if(!Ne)return Yv(t),Ne=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!vh(t.type,t.memoizedProps)),e&&(e=Kt)){if(xh(t))throw Jx(),Error(L(418));for(;e;)qx(t,e),e=Qr(e.nextSibling)}if(Yv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Kt=Qr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Kt=null}}else Kt=Qt?Qr(t.stateNode.nextSibling):null;return!0}function Jx(){for(var t=Kt;t;)t=Qr(t.nextSibling)}function Xo(){Kt=Qt=null,Ne=!1}function hg(t){kn===null?kn=[t]:kn.push(t)}var jb=Sr.ReactCurrentBatchConfig;function Hs(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(L(309));var r=n.stateNode}if(!r)throw Error(L(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(L(284));if(!n._owner)throw Error(L(290,t))}return t}function tu(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Qv(t){var e=t._init;return e(t._payload)}function jx(t){function e(y,w){if(t){var v=y.deletions;v===null?(y.deletions=[w],y.flags|=16):v.push(w)}}function n(y,w){if(!t)return null;for(;w!==null;)e(y,w),w=w.sibling;return null}function r(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function i(y,w){return y=ti(y,w),y.index=0,y.sibling=null,y}function o(y,w,v){return y.index=v,t?(v=y.alternate,v!==null?(v=v.index,v<w?(y.flags|=2,w):v):(y.flags|=2,w)):(y.flags|=1048576,w)}function s(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,w,v,E){return w===null||w.tag!==6?(w=xf(v,y.mode,E),w.return=y,w):(w=i(w,v),w.return=y,w)}function l(y,w,v,E){var I=v.type;return I===wo?f(y,w,v.props.children,E,v.key):w!==null&&(w.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Ur&&Qv(I)===w.type)?(E=i(w,v.props),E.ref=Hs(y,w,v),E.return=y,E):(E=bu(v.type,v.key,v.props,null,y.mode,E),E.ref=Hs(y,w,v),E.return=y,E)}function u(y,w,v,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==v.containerInfo||w.stateNode.implementation!==v.implementation?(w=Ef(v,y.mode,E),w.return=y,w):(w=i(w,v.children||[]),w.return=y,w)}function f(y,w,v,E,I){return w===null||w.tag!==7?(w=Vi(v,y.mode,E,I),w.return=y,w):(w=i(w,v),w.return=y,w)}function h(y,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return w=xf(""+w,y.mode,v),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case $l:return v=bu(w.type,w.key,w.props,null,y.mode,v),v.ref=Hs(y,null,w),v.return=y,v;case _o:return w=Ef(w,y.mode,v),w.return=y,w;case Ur:var E=w._init;return h(y,E(w._payload),v)}if(Zs(w)||Ls(w))return w=Vi(w,y.mode,v,null),w.return=y,w;tu(y,w)}return null}function p(y,w,v,E){var I=w!==null?w.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return I!==null?null:a(y,w,""+v,E);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case $l:return v.key===I?l(y,w,v,E):null;case _o:return v.key===I?u(y,w,v,E):null;case Ur:return I=v._init,p(y,w,I(v._payload),E)}if(Zs(v)||Ls(v))return I!==null?null:f(y,w,v,E,null);tu(y,v)}return null}function m(y,w,v,E,I){if(typeof E=="string"&&E!==""||typeof E=="number")return y=y.get(v)||null,a(w,y,""+E,I);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case $l:return y=y.get(E.key===null?v:E.key)||null,l(w,y,E,I);case _o:return y=y.get(E.key===null?v:E.key)||null,u(w,y,E,I);case Ur:var k=E._init;return m(y,w,v,k(E._payload),I)}if(Zs(E)||Ls(E))return y=y.get(v)||null,f(w,y,E,I,null);tu(w,E)}return null}function _(y,w,v,E){for(var I=null,k=null,b=w,T=w=0,R=null;b!==null&&T<v.length;T++){b.index>T?(R=b,b=null):R=b.sibling;var N=p(y,b,v[T],E);if(N===null){b===null&&(b=R);break}t&&b&&N.alternate===null&&e(y,b),w=o(N,w,T),k===null?I=N:k.sibling=N,k=N,b=R}if(T===v.length)return n(y,b),Ne&&bi(y,T),I;if(b===null){for(;T<v.length;T++)b=h(y,v[T],E),b!==null&&(w=o(b,w,T),k===null?I=b:k.sibling=b,k=b);return Ne&&bi(y,T),I}for(b=r(y,b);T<v.length;T++)R=m(b,y,T,v[T],E),R!==null&&(t&&R.alternate!==null&&b.delete(R.key===null?T:R.key),w=o(R,w,T),k===null?I=R:k.sibling=R,k=R);return t&&b.forEach(function(D){return e(y,D)}),Ne&&bi(y,T),I}function x(y,w,v,E){var I=Ls(v);if(typeof I!="function")throw Error(L(150));if(v=I.call(v),v==null)throw Error(L(151));for(var k=I=null,b=w,T=w=0,R=null,N=v.next();b!==null&&!N.done;T++,N=v.next()){b.index>T?(R=b,b=null):R=b.sibling;var D=p(y,b,N.value,E);if(D===null){b===null&&(b=R);break}t&&b&&D.alternate===null&&e(y,b),w=o(D,w,T),k===null?I=D:k.sibling=D,k=D,b=R}if(N.done)return n(y,b),Ne&&bi(y,T),I;if(b===null){for(;!N.done;T++,N=v.next())N=h(y,N.value,E),N!==null&&(w=o(N,w,T),k===null?I=N:k.sibling=N,k=N);return Ne&&bi(y,T),I}for(b=r(y,b);!N.done;T++,N=v.next())N=m(b,y,T,N.value,E),N!==null&&(t&&N.alternate!==null&&b.delete(N.key===null?T:N.key),w=o(N,w,T),k===null?I=N:k.sibling=N,k=N);return t&&b.forEach(function(G){return e(y,G)}),Ne&&bi(y,T),I}function C(y,w,v,E){if(typeof v=="object"&&v!==null&&v.type===wo&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case $l:e:{for(var I=v.key,k=w;k!==null;){if(k.key===I){if(I=v.type,I===wo){if(k.tag===7){n(y,k.sibling),w=i(k,v.props.children),w.return=y,y=w;break e}}else if(k.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Ur&&Qv(I)===k.type){n(y,k.sibling),w=i(k,v.props),w.ref=Hs(y,k,v),w.return=y,y=w;break e}n(y,k);break}else e(y,k);k=k.sibling}v.type===wo?(w=Vi(v.props.children,y.mode,E,v.key),w.return=y,y=w):(E=bu(v.type,v.key,v.props,null,y.mode,E),E.ref=Hs(y,w,v),E.return=y,y=E)}return s(y);case _o:e:{for(k=v.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===v.containerInfo&&w.stateNode.implementation===v.implementation){n(y,w.sibling),w=i(w,v.children||[]),w.return=y,y=w;break e}else{n(y,w);break}else e(y,w);w=w.sibling}w=Ef(v,y.mode,E),w.return=y,y=w}return s(y);case Ur:return k=v._init,C(y,w,k(v._payload),E)}if(Zs(v))return _(y,w,v,E);if(Ls(v))return x(y,w,v,E);tu(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,w!==null&&w.tag===6?(n(y,w.sibling),w=i(w,v),w.return=y,y=w):(n(y,w),w=xf(v,y.mode,E),w.return=y,y=w),s(y)):n(y,w)}return C}var Zo=jx(!0),Kx=jx(!1),Yu=vi(null),Qu=null,bo=null,pg=null;function gg(){pg=bo=Qu=null}function mg(t){var e=Yu.current;be(Yu),t._currentValue=e}function Ch(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Vo(t,e){Qu=t,pg=bo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ut=!0),t.firstContext=null)}function mn(t){var e=t._currentValue;if(pg!==t)if(t={context:t,memoizedValue:e,next:null},bo===null){if(Qu===null)throw Error(L(308));bo=t,Qu.dependencies={lanes:0,firstContext:t}}else bo=bo.next=t;return e}var Di=null;function vg(t){Di===null?Di=[t]:Di.push(t)}function Yx(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,vg(e)):(n.next=i.next,i.next=n),e.interleaved=n,vr(t,r)}function vr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fr=!1;function yg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function fr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Xr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,le&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,vr(t,n)}return i=r.interleaved,i===null?(e.next=e,vg(r)):(e.next=i.next,i.next=e),r.interleaved=e,vr(t,n)}function Eu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rg(t,n)}}function Xv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Xu(t,e,n,r){var i=t.updateQueue;Fr=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,s===null?o=u:s.next=u,s=l;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==s&&(a===null?f.firstBaseUpdate=u:a.next=u,f.lastBaseUpdate=l))}if(o!==null){var h=i.baseState;s=0,f=u=l=null,a=o;do{var p=a.lane,m=a.eventTime;if((r&p)===p){f!==null&&(f=f.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var _=t,x=a;switch(p=e,m=n,x.tag){case 1:if(_=x.payload,typeof _=="function"){h=_.call(m,h,p);break e}h=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=x.payload,p=typeof _=="function"?_.call(m,h,p):_,p==null)break e;h=Le({},h,p);break e;case 2:Fr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(u=f=m,l=h):f=f.next=m,s|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(f===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);qi|=s,t.lanes=s,t.memoizedState=h}}function Zv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(L(191,i));i.call(r)}}}var gl={},Xn=vi(gl),Oa=vi(gl),Ua=vi(gl);function Li(t){if(t===gl)throw Error(L(174));return t}function _g(t,e){switch(Te(Ua,e),Te(Oa,t),Te(Xn,gl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:rh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=rh(e,t)}be(Xn),Te(Xn,e)}function es(){be(Xn),be(Oa),be(Ua)}function Xx(t){Li(Ua.current);var e=Li(Xn.current),n=rh(e,t.type);e!==n&&(Te(Oa,t),Te(Xn,n))}function wg(t){Oa.current===t&&(be(Xn),be(Oa))}var Pe=vi(0);function Zu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var gf=[];function xg(){for(var t=0;t<gf.length;t++)gf[t]._workInProgressVersionPrimary=null;gf.length=0}var Cu=Sr.ReactCurrentDispatcher,mf=Sr.ReactCurrentBatchConfig,Wi=0,De=null,qe=null,et=null,ec=!1,ca=!1,Fa=0,Kb=0;function mt(){throw Error(L(321))}function Eg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ln(t[n],e[n]))return!1;return!0}function Cg(t,e,n,r,i,o){if(Wi=o,De=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Cu.current=t===null||t.memoizedState===null?Zb:eN,t=n(r,i),ca){o=0;do{if(ca=!1,Fa=0,25<=o)throw Error(L(301));o+=1,et=qe=null,e.updateQueue=null,Cu.current=tN,t=n(r,i)}while(ca)}if(Cu.current=tc,e=qe!==null&&qe.next!==null,Wi=0,et=qe=De=null,ec=!1,e)throw Error(L(300));return t}function Sg(){var t=Fa!==0;return Fa=0,t}function $n(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return et===null?De.memoizedState=et=t:et=et.next=t,et}function vn(){if(qe===null){var t=De.alternate;t=t!==null?t.memoizedState:null}else t=qe.next;var e=et===null?De.memoizedState:et.next;if(e!==null)et=e,qe=t;else{if(t===null)throw Error(L(310));qe=t,t={memoizedState:qe.memoizedState,baseState:qe.baseState,baseQueue:qe.baseQueue,queue:qe.queue,next:null},et===null?De.memoizedState=et=t:et=et.next=t}return et}function Va(t,e){return typeof e=="function"?e(t):e}function vf(t){var e=vn(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=qe,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,u=o;do{var f=u.lane;if((Wi&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,s=r):l=l.next=h,De.lanes|=f,qi|=f}u=u.next}while(u!==null&&u!==o);l===null?s=r:l.next=a,Ln(r,e.memoizedState)||(Ut=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,De.lanes|=o,qi|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function yf(t){var e=vn(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);Ln(o,e.memoizedState)||(Ut=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Zx(){}function eE(t,e){var n=De,r=vn(),i=e(),o=!Ln(r.memoizedState,i);if(o&&(r.memoizedState=i,Ut=!0),r=r.queue,Tg(rE.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||et!==null&&et.memoizedState.tag&1){if(n.flags|=2048,Ha(9,nE.bind(null,n,r,i,e),void 0,null),ot===null)throw Error(L(349));Wi&30||tE(n,e,i)}return i}function tE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function nE(t,e,n,r){e.value=n,e.getSnapshot=r,iE(e)&&oE(t)}function rE(t,e,n){return n(function(){iE(e)&&oE(t)})}function iE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ln(t,n)}catch{return!0}}function oE(t){var e=vr(t,1);e!==null&&Rn(e,t,1,-1)}function ey(t){var e=$n();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Va,lastRenderedState:t},e.queue=t,t=t.dispatch=Xb.bind(null,De,t),[e.memoizedState,t]}function Ha(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function sE(){return vn().memoizedState}function Su(t,e,n,r){var i=$n();De.flags|=t,i.memoizedState=Ha(1|e,n,void 0,r===void 0?null:r)}function jc(t,e,n,r){var i=vn();r=r===void 0?null:r;var o=void 0;if(qe!==null){var s=qe.memoizedState;if(o=s.destroy,r!==null&&Eg(r,s.deps)){i.memoizedState=Ha(e,n,o,r);return}}De.flags|=t,i.memoizedState=Ha(1|e,n,o,r)}function ty(t,e){return Su(8390656,8,t,e)}function Tg(t,e){return jc(2048,8,t,e)}function aE(t,e){return jc(4,2,t,e)}function lE(t,e){return jc(4,4,t,e)}function uE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function cE(t,e,n){return n=n!=null?n.concat([t]):null,jc(4,4,uE.bind(null,e,t),n)}function Ig(){}function dE(t,e){var n=vn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Eg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function fE(t,e){var n=vn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Eg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function hE(t,e,n){return Wi&21?(Ln(n,e)||(n=yx(),De.lanes|=n,qi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ut=!0),t.memoizedState=n)}function Yb(t,e){var n=me;me=n!==0&&4>n?n:4,t(!0);var r=mf.transition;mf.transition={};try{t(!1),e()}finally{me=n,mf.transition=r}}function pE(){return vn().memoizedState}function Qb(t,e,n){var r=ei(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},gE(t))mE(e,n);else if(n=Yx(t,e,n,r),n!==null){var i=Nt();Rn(n,t,r,i),vE(n,e,r)}}function Xb(t,e,n){var r=ei(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(gE(t))mE(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Ln(a,s)){var l=e.interleaved;l===null?(i.next=i,vg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=Yx(t,e,i,r),n!==null&&(i=Nt(),Rn(n,t,r,i),vE(n,e,r))}}function gE(t){var e=t.alternate;return t===De||e!==null&&e===De}function mE(t,e){ca=ec=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function vE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rg(t,n)}}var tc={readContext:mn,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useInsertionEffect:mt,useLayoutEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useMutableSource:mt,useSyncExternalStore:mt,useId:mt,unstable_isNewReconciler:!1},Zb={readContext:mn,useCallback:function(t,e){return $n().memoizedState=[t,e===void 0?null:e],t},useContext:mn,useEffect:ty,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Su(4194308,4,uE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Su(4194308,4,t,e)},useInsertionEffect:function(t,e){return Su(4,2,t,e)},useMemo:function(t,e){var n=$n();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=$n();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Qb.bind(null,De,t),[r.memoizedState,t]},useRef:function(t){var e=$n();return t={current:t},e.memoizedState=t},useState:ey,useDebugValue:Ig,useDeferredValue:function(t){return $n().memoizedState=t},useTransition:function(){var t=ey(!1),e=t[0];return t=Yb.bind(null,t[1]),$n().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=De,i=$n();if(Ne){if(n===void 0)throw Error(L(407));n=n()}else{if(n=e(),ot===null)throw Error(L(349));Wi&30||tE(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,ty(rE.bind(null,r,o,t),[t]),r.flags|=2048,Ha(9,nE.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=$n(),e=ot.identifierPrefix;if(Ne){var n=ar,r=sr;n=(r&~(1<<32-Nn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Fa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Kb++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},eN={readContext:mn,useCallback:dE,useContext:mn,useEffect:Tg,useImperativeHandle:cE,useInsertionEffect:aE,useLayoutEffect:lE,useMemo:fE,useReducer:vf,useRef:sE,useState:function(){return vf(Va)},useDebugValue:Ig,useDeferredValue:function(t){var e=vn();return hE(e,qe.memoizedState,t)},useTransition:function(){var t=vf(Va)[0],e=vn().memoizedState;return[t,e]},useMutableSource:Zx,useSyncExternalStore:eE,useId:pE,unstable_isNewReconciler:!1},tN={readContext:mn,useCallback:dE,useContext:mn,useEffect:Tg,useImperativeHandle:cE,useInsertionEffect:aE,useLayoutEffect:lE,useMemo:fE,useReducer:yf,useRef:sE,useState:function(){return yf(Va)},useDebugValue:Ig,useDeferredValue:function(t){var e=vn();return qe===null?e.memoizedState=t:hE(e,qe.memoizedState,t)},useTransition:function(){var t=yf(Va)[0],e=vn().memoizedState;return[t,e]},useMutableSource:Zx,useSyncExternalStore:eE,useId:pE,unstable_isNewReconciler:!1};function Tn(t,e){if(t&&t.defaultProps){e=Le({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Sh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Le({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Kc={isMounted:function(t){return(t=t._reactInternals)?ro(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Nt(),i=ei(t),o=fr(r,i);o.payload=e,n!=null&&(o.callback=n),e=Xr(t,o,i),e!==null&&(Rn(e,t,i,r),Eu(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Nt(),i=ei(t),o=fr(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Xr(t,o,i),e!==null&&(Rn(e,t,i,r),Eu(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Nt(),r=ei(t),i=fr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Xr(t,i,r),e!==null&&(Rn(e,t,r,n),Eu(e,t,r))}};function ny(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Pa(n,r)||!Pa(i,o):!0}function yE(t,e,n){var r=!1,i=ai,o=e.contextType;return typeof o=="object"&&o!==null?o=mn(o):(i=Ht(e)?zi:xt.current,r=e.contextTypes,o=(r=r!=null)?Qo(t,i):ai),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Kc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function ry(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Kc.enqueueReplaceState(e,e.state,null)}function Th(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},yg(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=mn(o):(o=Ht(e)?zi:xt.current,i.context=Qo(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Sh(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Kc.enqueueReplaceState(i,i.state,null),Xu(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ts(t,e){try{var n="",r=e;do n+=Nk(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function _f(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ih(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var nN=typeof WeakMap=="function"?WeakMap:Map;function _E(t,e,n){n=fr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){rc||(rc=!0,Oh=r),Ih(t,e)},n}function wE(t,e,n){n=fr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Ih(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Ih(t,e),typeof r!="function"&&(Zr===null?Zr=new Set([this]):Zr.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function iy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new nN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=mN.bind(null,t,e,n),e.then(t,t))}function oy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function sy(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=fr(-1,1),e.tag=2,Xr(n,e,1))),n.lanes|=1),t)}var rN=Sr.ReactCurrentOwner,Ut=!1;function It(t,e,n,r){e.child=t===null?Kx(e,null,n,r):Zo(e,t.child,n,r)}function ay(t,e,n,r,i){n=n.render;var o=e.ref;return Vo(e,i),r=Cg(t,e,n,r,o,i),n=Sg(),t!==null&&!Ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,yr(t,e,i)):(Ne&&n&&dg(e),e.flags|=1,It(t,e,r,i),e.child)}function ly(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!Dg(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,xE(t,e,o,r,i)):(t=bu(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Pa,n(s,r)&&t.ref===e.ref)return yr(t,e,i)}return e.flags|=1,t=ti(o,r),t.ref=e.ref,t.return=e,e.child=t}function xE(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Pa(o,r)&&t.ref===e.ref)if(Ut=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Ut=!0);else return e.lanes=t.lanes,yr(t,e,i)}return kh(t,e,n,r,i)}function EE(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Te(Ro,qt),qt|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Te(Ro,qt),qt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Te(Ro,qt),qt|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,Te(Ro,qt),qt|=r;return It(t,e,i,n),e.child}function CE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function kh(t,e,n,r,i){var o=Ht(n)?zi:xt.current;return o=Qo(e,o),Vo(e,i),n=Cg(t,e,n,r,o,i),r=Sg(),t!==null&&!Ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,yr(t,e,i)):(Ne&&r&&dg(e),e.flags|=1,It(t,e,n,i),e.child)}function uy(t,e,n,r,i){if(Ht(n)){var o=!0;Ju(e)}else o=!1;if(Vo(e,i),e.stateNode===null)Tu(t,e),yE(e,n,r),Th(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=mn(u):(u=Ht(n)?zi:xt.current,u=Qo(e,u));var f=n.getDerivedStateFromProps,h=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==u)&&ry(e,s,r,u),Fr=!1;var p=e.memoizedState;s.state=p,Xu(e,r,s,i),l=e.memoizedState,a!==r||p!==l||Vt.current||Fr?(typeof f=="function"&&(Sh(e,n,f,r),l=e.memoizedState),(a=Fr||ny(e,n,a,r,p,l,u))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=u,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,Qx(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Tn(e.type,a),s.props=u,h=e.pendingProps,p=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=mn(l):(l=Ht(n)?zi:xt.current,l=Qo(e,l));var m=n.getDerivedStateFromProps;(f=typeof m=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==h||p!==l)&&ry(e,s,r,l),Fr=!1,p=e.memoizedState,s.state=p,Xu(e,r,s,i);var _=e.memoizedState;a!==h||p!==_||Vt.current||Fr?(typeof m=="function"&&(Sh(e,n,m,r),_=e.memoizedState),(u=Fr||ny(e,n,u,r,p,_,l)||!1)?(f||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,_,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,_,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=_),s.props=r,s.state=_,s.context=l,r=u):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return bh(t,e,n,r,o,i)}function bh(t,e,n,r,i,o){CE(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&jv(e,n,!1),yr(t,e,o);r=e.stateNode,rN.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=Zo(e,t.child,null,o),e.child=Zo(e,null,a,o)):It(t,e,a,o),e.memoizedState=r.state,i&&jv(e,n,!0),e.child}function SE(t){var e=t.stateNode;e.pendingContext?Jv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Jv(t,e.context,!1),_g(t,e.containerInfo)}function cy(t,e,n,r,i){return Xo(),hg(i),e.flags|=256,It(t,e,n,r),e.child}var Nh={dehydrated:null,treeContext:null,retryLane:0};function Rh(t){return{baseLanes:t,cachePool:null,transitions:null}}function TE(t,e,n){var r=e.pendingProps,i=Pe.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Te(Pe,i&1),t===null)return Eh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Xc(s,r,0,null),t=Vi(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Rh(n),e.memoizedState=Nh,t):kg(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return iN(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ti(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=ti(a,o):(o=Vi(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?Rh(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Nh,r}return o=t.child,t=o.sibling,r=ti(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function kg(t,e){return e=Xc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function nu(t,e,n,r){return r!==null&&hg(r),Zo(e,t.child,null,n),t=kg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function iN(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=_f(Error(L(422))),nu(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Xc({mode:"visible",children:r.children},i,0,null),o=Vi(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Zo(e,t.child,null,s),e.child.memoizedState=Rh(s),e.memoizedState=Nh,o);if(!(e.mode&1))return nu(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(L(419)),r=_f(o,r,void 0),nu(t,e,s,r)}if(a=(s&t.childLanes)!==0,Ut||a){if(r=ot,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,vr(t,i),Rn(r,t,i,-1))}return Mg(),r=_f(Error(L(421))),nu(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=vN.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Kt=Qr(i.nextSibling),Qt=e,Ne=!0,kn=null,t!==null&&(an[ln++]=sr,an[ln++]=ar,an[ln++]=$i,sr=t.id,ar=t.overflow,$i=e),e=kg(e,r.children),e.flags|=4096,e)}function dy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ch(t.return,e,n)}function wf(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function IE(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(It(t,e,r.children,n),r=Pe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&dy(t,n,e);else if(t.tag===19)dy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Te(Pe,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Zu(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),wf(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Zu(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}wf(e,!0,n,null,o);break;case"together":wf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Tu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function yr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),qi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,n=ti(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ti(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function oN(t,e,n){switch(e.tag){case 3:SE(e),Xo();break;case 5:Xx(e);break;case 1:Ht(e.type)&&Ju(e);break;case 4:_g(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Te(Yu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Te(Pe,Pe.current&1),e.flags|=128,null):n&e.child.childLanes?TE(t,e,n):(Te(Pe,Pe.current&1),t=yr(t,e,n),t!==null?t.sibling:null);Te(Pe,Pe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return IE(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Te(Pe,Pe.current),r)break;return null;case 22:case 23:return e.lanes=0,EE(t,e,n)}return yr(t,e,n)}var kE,Ah,bE,NE;kE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ah=function(){};bE=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Li(Xn.current);var o=null;switch(n){case"input":i=Zf(t,i),r=Zf(t,r),o=[];break;case"select":i=Le({},i,{value:void 0}),r=Le({},r,{value:void 0}),o=[];break;case"textarea":i=nh(t,i),r=nh(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Wu)}ih(n,r);var s;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ta.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ta.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ke("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};NE=function(t,e,n,r){n!==r&&(e.flags|=4)};function Bs(t,e){if(!Ne)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function vt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function sN(t,e,n){var r=e.pendingProps;switch(fg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vt(e),null;case 1:return Ht(e.type)&&qu(),vt(e),null;case 3:return r=e.stateNode,es(),be(Vt),be(xt),xg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(eu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,kn!==null&&(Vh(kn),kn=null))),Ah(t,e),vt(e),null;case 5:wg(e);var i=Li(Ua.current);if(n=e.type,t!==null&&e.stateNode!=null)bE(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(L(166));return vt(e),null}if(t=Li(Xn.current),eu(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Wn]=e,r[La]=o,t=(e.mode&1)!==0,n){case"dialog":ke("cancel",r),ke("close",r);break;case"iframe":case"object":case"embed":ke("load",r);break;case"video":case"audio":for(i=0;i<ta.length;i++)ke(ta[i],r);break;case"source":ke("error",r);break;case"img":case"image":case"link":ke("error",r),ke("load",r);break;case"details":ke("toggle",r);break;case"input":wv(r,o),ke("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},ke("invalid",r);break;case"textarea":Ev(r,o),ke("invalid",r)}ih(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Zl(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Zl(r.textContent,a,t),i=["children",""+a]):Ta.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&ke("scroll",r)}switch(n){case"input":Wl(r),xv(r,o,!0);break;case"textarea":Wl(r),Cv(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Wu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[Wn]=e,t[La]=r,kE(t,e,!1,!1),e.stateNode=t;e:{switch(s=oh(n,r),n){case"dialog":ke("cancel",t),ke("close",t),i=r;break;case"iframe":case"object":case"embed":ke("load",t),i=r;break;case"video":case"audio":for(i=0;i<ta.length;i++)ke(ta[i],t);i=r;break;case"source":ke("error",t),i=r;break;case"img":case"image":case"link":ke("error",t),ke("load",t),i=r;break;case"details":ke("toggle",t),i=r;break;case"input":wv(t,r),i=Zf(t,r),ke("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Le({},r,{value:void 0}),ke("invalid",t);break;case"textarea":Ev(t,r),i=nh(t,r),ke("invalid",t);break;default:i=r}ih(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?sx(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ix(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ia(t,l):typeof l=="number"&&Ia(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Ta.hasOwnProperty(o)?l!=null&&o==="onScroll"&&ke("scroll",t):l!=null&&Qp(t,o,l,s))}switch(n){case"input":Wl(t),xv(t,r,!1);break;case"textarea":Wl(t),Cv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+si(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Lo(t,!!r.multiple,o,!1):r.defaultValue!=null&&Lo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Wu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return vt(e),null;case 6:if(t&&e.stateNode!=null)NE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(L(166));if(n=Li(Ua.current),Li(Xn.current),eu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Wn]=e,(o=r.nodeValue!==n)&&(t=Qt,t!==null))switch(t.tag){case 3:Zl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Zl(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Wn]=e,e.stateNode=r}return vt(e),null;case 13:if(be(Pe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ne&&Kt!==null&&e.mode&1&&!(e.flags&128))Jx(),Xo(),e.flags|=98560,o=!1;else if(o=eu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(L(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(L(317));o[Wn]=e}else Xo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;vt(e),o=!1}else kn!==null&&(Vh(kn),kn=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Pe.current&1?Ke===0&&(Ke=3):Mg())),e.updateQueue!==null&&(e.flags|=4),vt(e),null);case 4:return es(),Ah(t,e),t===null&&Ma(e.stateNode.containerInfo),vt(e),null;case 10:return mg(e.type._context),vt(e),null;case 17:return Ht(e.type)&&qu(),vt(e),null;case 19:if(be(Pe),o=e.memoizedState,o===null)return vt(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Bs(o,!1);else{if(Ke!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Zu(t),s!==null){for(e.flags|=128,Bs(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Te(Pe,Pe.current&1|2),e.child}t=t.sibling}o.tail!==null&&Ge()>ns&&(e.flags|=128,r=!0,Bs(o,!1),e.lanes=4194304)}else{if(!r)if(t=Zu(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Bs(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Ne)return vt(e),null}else 2*Ge()-o.renderingStartTime>ns&&n!==1073741824&&(e.flags|=128,r=!0,Bs(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Ge(),e.sibling=null,n=Pe.current,Te(Pe,r?n&1|2:n&1),e):(vt(e),null);case 22:case 23:return Pg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?qt&1073741824&&(vt(e),e.subtreeFlags&6&&(e.flags|=8192)):vt(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function aN(t,e){switch(fg(e),e.tag){case 1:return Ht(e.type)&&qu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return es(),be(Vt),be(xt),xg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return wg(e),null;case 13:if(be(Pe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));Xo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return be(Pe),null;case 4:return es(),null;case 10:return mg(e.type._context),null;case 22:case 23:return Pg(),null;case 24:return null;default:return null}}var ru=!1,yt=!1,lN=typeof WeakSet=="function"?WeakSet:Set,z=null;function No(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(t,e,r)}else n.current=null}function Ph(t,e,n){try{n()}catch(r){Ue(t,e,r)}}var fy=!1;function uN(t,e){if(gh=Gu,t=Dx(),cg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,u=0,f=0,h=t,p=null;t:for(;;){for(var m;h!==n||i!==0&&h.nodeType!==3||(a=s+i),h!==o||r!==0&&h.nodeType!==3||(l=s+r),h.nodeType===3&&(s+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===t)break t;if(p===n&&++u===i&&(a=s),p===o&&++f===r&&(l=s),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(mh={focusedElem:t,selectionRange:n},Gu=!1,z=e;z!==null;)if(e=z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,z=t;else for(;z!==null;){e=z;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var x=_.memoizedProps,C=_.memoizedState,y=e.stateNode,w=y.getSnapshotBeforeUpdate(e.elementType===e.type?x:Tn(e.type,x),C);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(E){Ue(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,z=t;break}z=e.return}return _=fy,fy=!1,_}function da(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Ph(e,n,o)}i=i.next}while(i!==r)}}function Yc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Mh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function RE(t){var e=t.alternate;e!==null&&(t.alternate=null,RE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Wn],delete e[La],delete e[_h],delete e[Wb],delete e[qb])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function AE(t){return t.tag===5||t.tag===3||t.tag===4}function hy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||AE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Dh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Wu));else if(r!==4&&(t=t.child,t!==null))for(Dh(t,e,n),t=t.sibling;t!==null;)Dh(t,e,n),t=t.sibling}function Lh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Lh(t,e,n),t=t.sibling;t!==null;)Lh(t,e,n),t=t.sibling}var ct=null,In=!1;function Lr(t,e,n){for(n=n.child;n!==null;)PE(t,e,n),n=n.sibling}function PE(t,e,n){if(Qn&&typeof Qn.onCommitFiberUnmount=="function")try{Qn.onCommitFiberUnmount(Gc,n)}catch{}switch(n.tag){case 5:yt||No(n,e);case 6:var r=ct,i=In;ct=null,Lr(t,e,n),ct=r,In=i,ct!==null&&(In?(t=ct,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ct.removeChild(n.stateNode));break;case 18:ct!==null&&(In?(t=ct,n=n.stateNode,t.nodeType===8?hf(t.parentNode,n):t.nodeType===1&&hf(t,n),Ra(t)):hf(ct,n.stateNode));break;case 4:r=ct,i=In,ct=n.stateNode.containerInfo,In=!0,Lr(t,e,n),ct=r,In=i;break;case 0:case 11:case 14:case 15:if(!yt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Ph(n,e,s),i=i.next}while(i!==r)}Lr(t,e,n);break;case 1:if(!yt&&(No(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ue(n,e,a)}Lr(t,e,n);break;case 21:Lr(t,e,n);break;case 22:n.mode&1?(yt=(r=yt)||n.memoizedState!==null,Lr(t,e,n),yt=r):Lr(t,e,n);break;default:Lr(t,e,n)}}function py(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new lN),e.forEach(function(r){var i=yN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Cn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:ct=a.stateNode,In=!1;break e;case 3:ct=a.stateNode.containerInfo,In=!0;break e;case 4:ct=a.stateNode.containerInfo,In=!0;break e}a=a.return}if(ct===null)throw Error(L(160));PE(o,s,i),ct=null,In=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Ue(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ME(e,t),e=e.sibling}function ME(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Cn(e,t),zn(t),r&4){try{da(3,t,t.return),Yc(3,t)}catch(x){Ue(t,t.return,x)}try{da(5,t,t.return)}catch(x){Ue(t,t.return,x)}}break;case 1:Cn(e,t),zn(t),r&512&&n!==null&&No(n,n.return);break;case 5:if(Cn(e,t),zn(t),r&512&&n!==null&&No(n,n.return),t.flags&32){var i=t.stateNode;try{Ia(i,"")}catch(x){Ue(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&tx(i,o),oh(a,s);var u=oh(a,o);for(s=0;s<l.length;s+=2){var f=l[s],h=l[s+1];f==="style"?sx(i,h):f==="dangerouslySetInnerHTML"?ix(i,h):f==="children"?Ia(i,h):Qp(i,f,h,u)}switch(a){case"input":eh(i,o);break;case"textarea":nx(i,o);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var m=o.value;m!=null?Lo(i,!!o.multiple,m,!1):p!==!!o.multiple&&(o.defaultValue!=null?Lo(i,!!o.multiple,o.defaultValue,!0):Lo(i,!!o.multiple,o.multiple?[]:"",!1))}i[La]=o}catch(x){Ue(t,t.return,x)}}break;case 6:if(Cn(e,t),zn(t),r&4){if(t.stateNode===null)throw Error(L(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(x){Ue(t,t.return,x)}}break;case 3:if(Cn(e,t),zn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ra(e.containerInfo)}catch(x){Ue(t,t.return,x)}break;case 4:Cn(e,t),zn(t);break;case 13:Cn(e,t),zn(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Rg=Ge())),r&4&&py(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(yt=(u=yt)||f,Cn(e,t),yt=u):Cn(e,t),zn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(z=t,f=t.child;f!==null;){for(h=z=f;z!==null;){switch(p=z,m=p.child,p.tag){case 0:case 11:case 14:case 15:da(4,p,p.return);break;case 1:No(p,p.return);var _=p.stateNode;if(typeof _.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(x){Ue(r,n,x)}}break;case 5:No(p,p.return);break;case 22:if(p.memoizedState!==null){my(h);continue}}m!==null?(m.return=p,z=m):my(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{i=h.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=ox("display",s))}catch(x){Ue(t,t.return,x)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Ue(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Cn(e,t),zn(t),r&4&&py(t);break;case 21:break;default:Cn(e,t),zn(t)}}function zn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(AE(n)){var r=n;break e}n=n.return}throw Error(L(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ia(i,""),r.flags&=-33);var o=hy(t);Lh(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=hy(t);Dh(t,a,s);break;default:throw Error(L(161))}}catch(l){Ue(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function cN(t,e,n){z=t,DE(t)}function DE(t,e,n){for(var r=(t.mode&1)!==0;z!==null;){var i=z,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||ru;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||yt;a=ru;var u=yt;if(ru=s,(yt=l)&&!u)for(z=i;z!==null;)s=z,l=s.child,s.tag===22&&s.memoizedState!==null?vy(i):l!==null?(l.return=s,z=l):vy(i);for(;o!==null;)z=o,DE(o),o=o.sibling;z=i,ru=a,yt=u}gy(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,z=o):gy(t)}}function gy(t){for(;z!==null;){var e=z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:yt||Yc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!yt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Tn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Zv(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Zv(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Ra(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}yt||e.flags&512&&Mh(e)}catch(p){Ue(e,e.return,p)}}if(e===t){z=null;break}if(n=e.sibling,n!==null){n.return=e.return,z=n;break}z=e.return}}function my(t){for(;z!==null;){var e=z;if(e===t){z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,z=n;break}z=e.return}}function vy(t){for(;z!==null;){var e=z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Yc(4,e)}catch(l){Ue(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Ue(e,i,l)}}var o=e.return;try{Mh(e)}catch(l){Ue(e,o,l)}break;case 5:var s=e.return;try{Mh(e)}catch(l){Ue(e,s,l)}}}catch(l){Ue(e,e.return,l)}if(e===t){z=null;break}var a=e.sibling;if(a!==null){a.return=e.return,z=a;break}z=e.return}}var dN=Math.ceil,nc=Sr.ReactCurrentDispatcher,bg=Sr.ReactCurrentOwner,hn=Sr.ReactCurrentBatchConfig,le=0,ot=null,$e=null,dt=0,qt=0,Ro=vi(0),Ke=0,Ba=null,qi=0,Qc=0,Ng=0,fa=null,Lt=null,Rg=0,ns=1/0,ir=null,rc=!1,Oh=null,Zr=null,iu=!1,zr=null,ic=0,ha=0,Uh=null,Iu=-1,ku=0;function Nt(){return le&6?Ge():Iu!==-1?Iu:Iu=Ge()}function ei(t){return t.mode&1?le&2&&dt!==0?dt&-dt:jb.transition!==null?(ku===0&&(ku=yx()),ku):(t=me,t!==0||(t=window.event,t=t===void 0?16:Tx(t.type)),t):1}function Rn(t,e,n,r){if(50<ha)throw ha=0,Uh=null,Error(L(185));fl(t,n,r),(!(le&2)||t!==ot)&&(t===ot&&(!(le&2)&&(Qc|=n),Ke===4&&Br(t,dt)),Bt(t,r),n===1&&le===0&&!(e.mode&1)&&(ns=Ge()+500,Jc&&yi()))}function Bt(t,e){var n=t.callbackNode;jk(t,e);var r=Bu(t,t===ot?dt:0);if(r===0)n!==null&&Iv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Iv(n),e===1)t.tag===0?Jb(yy.bind(null,t)):$x(yy.bind(null,t)),zb(function(){!(le&6)&&yi()}),n=null;else{switch(_x(r)){case 1:n=ng;break;case 4:n=mx;break;case 16:n=Hu;break;case 536870912:n=vx;break;default:n=Hu}n=GE(n,LE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function LE(t,e){if(Iu=-1,ku=0,le&6)throw Error(L(327));var n=t.callbackNode;if(Ho()&&t.callbackNode!==n)return null;var r=Bu(t,t===ot?dt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=oc(t,r);else{e=r;var i=le;le|=2;var o=UE();(ot!==t||dt!==e)&&(ir=null,ns=Ge()+500,Fi(t,e));do try{pN();break}catch(a){OE(t,a)}while(!0);gg(),nc.current=o,le=i,$e!==null?e=0:(ot=null,dt=0,e=Ke)}if(e!==0){if(e===2&&(i=ch(t),i!==0&&(r=i,e=Fh(t,i))),e===1)throw n=Ba,Fi(t,0),Br(t,r),Bt(t,Ge()),n;if(e===6)Br(t,r);else{if(i=t.current.alternate,!(r&30)&&!fN(i)&&(e=oc(t,r),e===2&&(o=ch(t),o!==0&&(r=o,e=Fh(t,o))),e===1))throw n=Ba,Fi(t,0),Br(t,r),Bt(t,Ge()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(L(345));case 2:Ni(t,Lt,ir);break;case 3:if(Br(t,r),(r&130023424)===r&&(e=Rg+500-Ge(),10<e)){if(Bu(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Nt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=yh(Ni.bind(null,t,Lt,ir),e);break}Ni(t,Lt,ir);break;case 4:if(Br(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-Nn(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*dN(r/1960))-r,10<r){t.timeoutHandle=yh(Ni.bind(null,t,Lt,ir),r);break}Ni(t,Lt,ir);break;case 5:Ni(t,Lt,ir);break;default:throw Error(L(329))}}}return Bt(t,Ge()),t.callbackNode===n?LE.bind(null,t):null}function Fh(t,e){var n=fa;return t.current.memoizedState.isDehydrated&&(Fi(t,e).flags|=256),t=oc(t,e),t!==2&&(e=Lt,Lt=n,e!==null&&Vh(e)),t}function Vh(t){Lt===null?Lt=t:Lt.push.apply(Lt,t)}function fN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Ln(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Br(t,e){for(e&=~Ng,e&=~Qc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Nn(e),r=1<<n;t[n]=-1,e&=~r}}function yy(t){if(le&6)throw Error(L(327));Ho();var e=Bu(t,0);if(!(e&1))return Bt(t,Ge()),null;var n=oc(t,e);if(t.tag!==0&&n===2){var r=ch(t);r!==0&&(e=r,n=Fh(t,r))}if(n===1)throw n=Ba,Fi(t,0),Br(t,e),Bt(t,Ge()),n;if(n===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ni(t,Lt,ir),Bt(t,Ge()),null}function Ag(t,e){var n=le;le|=1;try{return t(e)}finally{le=n,le===0&&(ns=Ge()+500,Jc&&yi())}}function Ji(t){zr!==null&&zr.tag===0&&!(le&6)&&Ho();var e=le;le|=1;var n=hn.transition,r=me;try{if(hn.transition=null,me=1,t)return t()}finally{me=r,hn.transition=n,le=e,!(le&6)&&yi()}}function Pg(){qt=Ro.current,be(Ro)}function Fi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Gb(n)),$e!==null)for(n=$e.return;n!==null;){var r=n;switch(fg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qu();break;case 3:es(),be(Vt),be(xt),xg();break;case 5:wg(r);break;case 4:es();break;case 13:be(Pe);break;case 19:be(Pe);break;case 10:mg(r.type._context);break;case 22:case 23:Pg()}n=n.return}if(ot=t,$e=t=ti(t.current,null),dt=qt=e,Ke=0,Ba=null,Ng=Qc=qi=0,Lt=fa=null,Di!==null){for(e=0;e<Di.length;e++)if(n=Di[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Di=null}return t}function OE(t,e){do{var n=$e;try{if(gg(),Cu.current=tc,ec){for(var r=De.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ec=!1}if(Wi=0,et=qe=De=null,ca=!1,Fa=0,bg.current=null,n===null||n.return===null){Ke=1,Ba=e,$e=null;break}e:{var o=t,s=n.return,a=n,l=e;if(e=dt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=a,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=oy(s);if(m!==null){m.flags&=-257,sy(m,s,a,o,e),m.mode&1&&iy(o,u,e),e=m,l=u;var _=e.updateQueue;if(_===null){var x=new Set;x.add(l),e.updateQueue=x}else _.add(l);break e}else{if(!(e&1)){iy(o,u,e),Mg();break e}l=Error(L(426))}}else if(Ne&&a.mode&1){var C=oy(s);if(C!==null){!(C.flags&65536)&&(C.flags|=256),sy(C,s,a,o,e),hg(ts(l,a));break e}}o=l=ts(l,a),Ke!==4&&(Ke=2),fa===null?fa=[o]:fa.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var y=_E(o,l,e);Xv(o,y);break e;case 1:a=l;var w=o.type,v=o.stateNode;if(!(o.flags&128)&&(typeof w.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Zr===null||!Zr.has(v)))){o.flags|=65536,e&=-e,o.lanes|=e;var E=wE(o,a,e);Xv(o,E);break e}}o=o.return}while(o!==null)}VE(n)}catch(I){e=I,$e===n&&n!==null&&($e=n=n.return);continue}break}while(!0)}function UE(){var t=nc.current;return nc.current=tc,t===null?tc:t}function Mg(){(Ke===0||Ke===3||Ke===2)&&(Ke=4),ot===null||!(qi&268435455)&&!(Qc&268435455)||Br(ot,dt)}function oc(t,e){var n=le;le|=2;var r=UE();(ot!==t||dt!==e)&&(ir=null,Fi(t,e));do try{hN();break}catch(i){OE(t,i)}while(!0);if(gg(),le=n,nc.current=r,$e!==null)throw Error(L(261));return ot=null,dt=0,Ke}function hN(){for(;$e!==null;)FE($e)}function pN(){for(;$e!==null&&!Vk();)FE($e)}function FE(t){var e=BE(t.alternate,t,qt);t.memoizedProps=t.pendingProps,e===null?VE(t):$e=e,bg.current=null}function VE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=aN(n,e),n!==null){n.flags&=32767,$e=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ke=6,$e=null;return}}else if(n=sN(n,e,qt),n!==null){$e=n;return}if(e=e.sibling,e!==null){$e=e;return}$e=e=t}while(e!==null);Ke===0&&(Ke=5)}function Ni(t,e,n){var r=me,i=hn.transition;try{hn.transition=null,me=1,gN(t,e,n,r)}finally{hn.transition=i,me=r}return null}function gN(t,e,n,r){do Ho();while(zr!==null);if(le&6)throw Error(L(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(Kk(t,o),t===ot&&($e=ot=null,dt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||iu||(iu=!0,GE(Hu,function(){return Ho(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=hn.transition,hn.transition=null;var s=me;me=1;var a=le;le|=4,bg.current=null,uN(t,n),ME(n,t),Lb(mh),Gu=!!gh,mh=gh=null,t.current=n,cN(n),Hk(),le=a,me=s,hn.transition=o}else t.current=n;if(iu&&(iu=!1,zr=t,ic=i),o=t.pendingLanes,o===0&&(Zr=null),zk(n.stateNode),Bt(t,Ge()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(rc)throw rc=!1,t=Oh,Oh=null,t;return ic&1&&t.tag!==0&&Ho(),o=t.pendingLanes,o&1?t===Uh?ha++:(ha=0,Uh=t):ha=0,yi(),null}function Ho(){if(zr!==null){var t=_x(ic),e=hn.transition,n=me;try{if(hn.transition=null,me=16>t?16:t,zr===null)var r=!1;else{if(t=zr,zr=null,ic=0,le&6)throw Error(L(331));var i=le;for(le|=4,z=t.current;z!==null;){var o=z,s=o.child;if(z.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(z=u;z!==null;){var f=z;switch(f.tag){case 0:case 11:case 15:da(8,f,o)}var h=f.child;if(h!==null)h.return=f,z=h;else for(;z!==null;){f=z;var p=f.sibling,m=f.return;if(RE(f),f===u){z=null;break}if(p!==null){p.return=m,z=p;break}z=m}}}var _=o.alternate;if(_!==null){var x=_.child;if(x!==null){_.child=null;do{var C=x.sibling;x.sibling=null,x=C}while(x!==null)}}z=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,z=s;else e:for(;z!==null;){if(o=z,o.flags&2048)switch(o.tag){case 0:case 11:case 15:da(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,z=y;break e}z=o.return}}var w=t.current;for(z=w;z!==null;){s=z;var v=s.child;if(s.subtreeFlags&2064&&v!==null)v.return=s,z=v;else e:for(s=w;z!==null;){if(a=z,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Yc(9,a)}}catch(I){Ue(a,a.return,I)}if(a===s){z=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,z=E;break e}z=a.return}}if(le=i,yi(),Qn&&typeof Qn.onPostCommitFiberRoot=="function")try{Qn.onPostCommitFiberRoot(Gc,t)}catch{}r=!0}return r}finally{me=n,hn.transition=e}}return!1}function _y(t,e,n){e=ts(n,e),e=_E(t,e,1),t=Xr(t,e,1),e=Nt(),t!==null&&(fl(t,1,e),Bt(t,e))}function Ue(t,e,n){if(t.tag===3)_y(t,t,n);else for(;e!==null;){if(e.tag===3){_y(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Zr===null||!Zr.has(r))){t=ts(n,t),t=wE(e,t,1),e=Xr(e,t,1),t=Nt(),e!==null&&(fl(e,1,t),Bt(e,t));break}}e=e.return}}function mN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Nt(),t.pingedLanes|=t.suspendedLanes&n,ot===t&&(dt&n)===n&&(Ke===4||Ke===3&&(dt&130023424)===dt&&500>Ge()-Rg?Fi(t,0):Ng|=n),Bt(t,e)}function HE(t,e){e===0&&(t.mode&1?(e=jl,jl<<=1,!(jl&130023424)&&(jl=4194304)):e=1);var n=Nt();t=vr(t,e),t!==null&&(fl(t,e,n),Bt(t,n))}function vN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),HE(t,n)}function yN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(L(314))}r!==null&&r.delete(e),HE(t,n)}var BE;BE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Vt.current)Ut=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ut=!1,oN(t,e,n);Ut=!!(t.flags&131072)}else Ut=!1,Ne&&e.flags&1048576&&Wx(e,Ku,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Tu(t,e),t=e.pendingProps;var i=Qo(e,xt.current);Vo(e,n),i=Cg(null,e,r,t,i,n);var o=Sg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ht(r)?(o=!0,Ju(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,yg(e),i.updater=Kc,e.stateNode=i,i._reactInternals=e,Th(e,r,t,n),e=bh(null,e,r,!0,o,n)):(e.tag=0,Ne&&o&&dg(e),It(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Tu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=wN(r),t=Tn(r,t),i){case 0:e=kh(null,e,r,t,n);break e;case 1:e=uy(null,e,r,t,n);break e;case 11:e=ay(null,e,r,t,n);break e;case 14:e=ly(null,e,r,Tn(r.type,t),n);break e}throw Error(L(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Tn(r,i),kh(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Tn(r,i),uy(t,e,r,i,n);case 3:e:{if(SE(e),t===null)throw Error(L(387));r=e.pendingProps,o=e.memoizedState,i=o.element,Qx(t,e),Xu(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=ts(Error(L(423)),e),e=cy(t,e,r,n,i);break e}else if(r!==i){i=ts(Error(L(424)),e),e=cy(t,e,r,n,i);break e}else for(Kt=Qr(e.stateNode.containerInfo.firstChild),Qt=e,Ne=!0,kn=null,n=Kx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xo(),r===i){e=yr(t,e,n);break e}It(t,e,r,n)}e=e.child}return e;case 5:return Xx(e),t===null&&Eh(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,vh(r,i)?s=null:o!==null&&vh(r,o)&&(e.flags|=32),CE(t,e),It(t,e,s,n),e.child;case 6:return t===null&&Eh(e),null;case 13:return TE(t,e,n);case 4:return _g(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Zo(e,null,r,n):It(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Tn(r,i),ay(t,e,r,i,n);case 7:return It(t,e,e.pendingProps,n),e.child;case 8:return It(t,e,e.pendingProps.children,n),e.child;case 12:return It(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,Te(Yu,r._currentValue),r._currentValue=s,o!==null)if(Ln(o.value,s)){if(o.children===i.children&&!Vt.current){e=yr(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=fr(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Ch(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(L(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Ch(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}It(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Vo(e,n),i=mn(i),r=r(i),e.flags|=1,It(t,e,r,n),e.child;case 14:return r=e.type,i=Tn(r,e.pendingProps),i=Tn(r.type,i),ly(t,e,r,i,n);case 15:return xE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Tn(r,i),Tu(t,e),e.tag=1,Ht(r)?(t=!0,Ju(e)):t=!1,Vo(e,n),yE(e,r,i),Th(e,r,i,n),bh(null,e,r,!0,t,n);case 19:return IE(t,e,n);case 22:return EE(t,e,n)}throw Error(L(156,e.tag))};function GE(t,e){return gx(t,e)}function _N(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cn(t,e,n,r){return new _N(t,e,n,r)}function Dg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wN(t){if(typeof t=="function")return Dg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zp)return 11;if(t===eg)return 14}return 2}function ti(t,e){var n=t.alternate;return n===null?(n=cn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function bu(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")Dg(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case wo:return Vi(n.children,i,o,e);case Xp:s=8,i|=8;break;case Kf:return t=cn(12,n,e,i|2),t.elementType=Kf,t.lanes=o,t;case Yf:return t=cn(13,n,e,i),t.elementType=Yf,t.lanes=o,t;case Qf:return t=cn(19,n,e,i),t.elementType=Qf,t.lanes=o,t;case Xw:return Xc(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Yw:s=10;break e;case Qw:s=9;break e;case Zp:s=11;break e;case eg:s=14;break e;case Ur:s=16,r=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=cn(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function Vi(t,e,n,r){return t=cn(7,t,r,e),t.lanes=n,t}function Xc(t,e,n,r){return t=cn(22,t,r,e),t.elementType=Xw,t.lanes=n,t.stateNode={isHidden:!1},t}function xf(t,e,n){return t=cn(6,t,null,e),t.lanes=n,t}function Ef(t,e,n){return e=cn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function xN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tf(0),this.expirationTimes=tf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Lg(t,e,n,r,i,o,s,a,l){return t=new xN(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=cn(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},yg(o),t}function EN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_o,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function zE(t){if(!t)return ai;t=t._reactInternals;e:{if(ro(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ht(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var n=t.type;if(Ht(n))return zx(t,n,e)}return e}function $E(t,e,n,r,i,o,s,a,l){return t=Lg(n,r,!0,t,i,o,s,a,l),t.context=zE(null),n=t.current,r=Nt(),i=ei(n),o=fr(r,i),o.callback=e??null,Xr(n,o,i),t.current.lanes=i,fl(t,i,r),Bt(t,r),t}function Zc(t,e,n,r){var i=e.current,o=Nt(),s=ei(i);return n=zE(n),e.context===null?e.context=n:e.pendingContext=n,e=fr(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Xr(i,e,s),t!==null&&(Rn(t,i,s,o),Eu(t,i,s)),s}function sc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Og(t,e){wy(t,e),(t=t.alternate)&&wy(t,e)}function CN(){return null}var WE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ug(t){this._internalRoot=t}ed.prototype.render=Ug.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));Zc(t,e,null,null)};ed.prototype.unmount=Ug.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ji(function(){Zc(null,t,null,null)}),e[mr]=null}};function ed(t){this._internalRoot=t}ed.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ex();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Hr.length&&e!==0&&e<Hr[n].priority;n++);Hr.splice(n,0,t),n===0&&Sx(t)}};function Fg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function td(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function xy(){}function SN(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=sc(s);o.call(u)}}var s=$E(e,r,t,0,null,!1,!1,"",xy);return t._reactRootContainer=s,t[mr]=s.current,Ma(t.nodeType===8?t.parentNode:t),Ji(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=sc(l);a.call(u)}}var l=Lg(t,0,!1,null,null,!1,!1,"",xy);return t._reactRootContainer=l,t[mr]=l.current,Ma(t.nodeType===8?t.parentNode:t),Ji(function(){Zc(e,l,n,r)}),l}function nd(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=sc(s);a.call(l)}}Zc(e,s,t,i)}else s=SN(n,e,t,i,r);return sc(s)}wx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ea(e.pendingLanes);n!==0&&(rg(e,n|1),Bt(e,Ge()),!(le&6)&&(ns=Ge()+500,yi()))}break;case 13:Ji(function(){var r=vr(t,1);if(r!==null){var i=Nt();Rn(r,t,1,i)}}),Og(t,1)}};ig=function(t){if(t.tag===13){var e=vr(t,134217728);if(e!==null){var n=Nt();Rn(e,t,134217728,n)}Og(t,134217728)}};xx=function(t){if(t.tag===13){var e=ei(t),n=vr(t,e);if(n!==null){var r=Nt();Rn(n,t,e,r)}Og(t,e)}};Ex=function(){return me};Cx=function(t,e){var n=me;try{return me=t,e()}finally{me=n}};ah=function(t,e,n){switch(e){case"input":if(eh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=qc(r);if(!i)throw Error(L(90));ex(r),eh(r,i)}}}break;case"textarea":nx(t,n);break;case"select":e=n.value,e!=null&&Lo(t,!!n.multiple,e,!1)}};ux=Ag;cx=Ji;var TN={usingClientEntryPoint:!1,Events:[pl,So,qc,ax,lx,Ag]},Gs={findFiberByHostInstance:Mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},IN={bundleType:Gs.bundleType,version:Gs.version,rendererPackageName:Gs.rendererPackageName,rendererConfig:Gs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=hx(t),t===null?null:t.stateNode},findFiberByHostInstance:Gs.findFiberByHostInstance||CN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ou.isDisabled&&ou.supportsFiber)try{Gc=ou.inject(IN),Qn=ou}catch{}}nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TN;nn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fg(e))throw Error(L(200));return EN(t,e,null,n)};nn.createRoot=function(t,e){if(!Fg(t))throw Error(L(299));var n=!1,r="",i=WE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Lg(t,1,!1,null,null,n,!1,r,i),t[mr]=e.current,Ma(t.nodeType===8?t.parentNode:t),new Ug(e)};nn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=hx(e),t=t===null?null:t.stateNode,t};nn.flushSync=function(t){return Ji(t)};nn.hydrate=function(t,e,n){if(!td(e))throw Error(L(200));return nd(null,t,e,!0,n)};nn.hydrateRoot=function(t,e,n){if(!Fg(t))throw Error(L(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=WE;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=$E(e,null,t,1,n??null,i,!1,o,s),t[mr]=e.current,Ma(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new ed(e)};nn.render=function(t,e,n){if(!td(e))throw Error(L(200));return nd(null,t,e,!1,n)};nn.unmountComponentAtNode=function(t){if(!td(t))throw Error(L(40));return t._reactRootContainer?(Ji(function(){nd(null,null,t,!1,function(){t._reactRootContainer=null,t[mr]=null})}),!0):!1};nn.unstable_batchedUpdates=Ag;nn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!td(n))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return nd(t,e,n,!1,r)};nn.version="18.3.1-next-f1338f8080-20240426";function qE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qE)}catch(t){console.error(t)}}qE(),qw.exports=nn;var Ao=qw.exports,Ey=Ao;Jf.createRoot=Ey.createRoot,Jf.hydrateRoot=Ey.hydrateRoot;var Ce=(t=>(t.HOME="HOME",t.CHAT="CHAT",t.TRANSLATOR="TRANSLATOR",t.EDITOR="EDITOR",t.ADMIN="ADMIN",t))(Ce||{});const Cy=["N/A"],kN=`
OFFICIAL SELLER SUPPORT SOP (GENERAL GUIDELINES)

1. LOGISTICS & DELIVERY
- Standard Delivery: 3-7 business days for local orders, 14-25 days for international shipping.
- Delayed Orders: Apologize sincerely. Check tracking status. If lost, offer full refund or replacement.
- Address Changes: Allowed only before the order status is "Processed" or "Shipped".
- Delivered but Not Received: Ask customer to check with neighbors/family/reception. If not found, initiate investigation.

2. CANCELLATIONS
- Unpaid Orders: Automatically cancel after set timeframe (e.g., 24h).
- Paid/Unshipped: Customer can request cancellation. Seller approval required if packing has started.
- Shipped: Cancellation is not possible. Customer must refuse delivery or return upon receipt.

3. PRODUCT ISSUES (DAMAGED, WRONG, MISSING)
- Low Value Items: Consider offering a refund or voucher without requiring return to save shipping costs.
- High Value Items: Request clear photo/video evidence. Require return for full refund.
- Wrong Item Sent: Apologize and arrange for exchange or refund.

4. RETURNS & REFUNDS
- Change of Mind: Generally allowed if item is sealed and within return window (e.g., 7 days).
- Refund Processing: 
  - E-wallets: 1-3 business days.
  - Credit Cards: 7-14 business days.
  - Bank Transfer: Up to 30 days.

5. CUSTOMER INTERACTION
- Tone: Professional, Empathetic, Helpful, using "We/Us" to represent the brand.
- Response Time: Aim to reply within 12-24 hours.
- Service Recovery: Use vouchers or discounts for valid complaints to retain customer loyalty.
`,bN=({users:t,max:e=4})=>{const n=[...t].sort((l,u)=>l.photoURL?-1:1),r=n.slice(0,e),i=n.slice(e),o=i.length,s=l=>l?l.charAt(0).toUpperCase():"?",a=l=>{let u=0;for(let h=0;h<l.length;h++)u=l.charCodeAt(h)+((u<<5)-u);const f=(u&16777215).toString(16).toUpperCase();return"#"+"00000".substring(0,6-f.length)+f};return g.jsxs("div",{className:"flex items-center -space-x-2 hover:space-x-1 transition-all duration-300",children:[r.map((l,u)=>g.jsxs("div",{className:"relative group cursor-pointer transition-transform hover:-translate-y-1",style:{zIndex:r.length-u},children:[g.jsx("div",{className:`
            w-8 h-8 md:w-9 md:h-9 rounded-full border-2 border-white dark:border-[#202124] 
            flex items-center justify-center text-xs font-bold text-white shadow-sm overflow-hidden
            bg-gray-300 dark:bg-gray-700
          `,style:{backgroundColor:l.photoURL?"transparent":a(l.displayName||"A")},children:l.photoURL?g.jsx("img",{src:l.photoURL,alt:l.displayName||"",className:"w-full h-full object-cover"}):g.jsx("span",{children:s(l.displayName)})}),g.jsx("span",{className:"absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 border-2 border-white dark:border-[#202124] rounded-full"}),g.jsx("div",{className:"absolute top-full mt-2 left-1/2 -translate-x-1/2 bg-gray-900 text-white text-[10px] py-1 px-2 rounded opacity-0 group-hover:opacity-100 whitespace-nowrap pointer-events-none transition-opacity shadow-lg z-50",children:l.displayName})]},l.uid)),o>0&&g.jsxs("div",{className:"relative group z-0 hover:z-30 ml-1",children:[g.jsxs("div",{className:"w-8 h-8 md:w-9 md:h-9 rounded-full border-2 border-white dark:border-[#202124] bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 flex items-center justify-center text-xs font-bold shadow-sm hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors cursor-pointer",children:["+",o]}),g.jsxs("div",{className:"absolute top-full right-0 mt-2 bg-white dark:bg-[#1e1e1e] border border-gray-200 dark:border-gray-700 rounded-xl shadow-xl w-48 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-[100] transform origin-top-right",children:[g.jsxs("div",{className:"px-3 py-2 text-[10px] font-bold text-gray-400 uppercase tracking-wider border-b border-gray-100 dark:border-gray-800",children:[o," More"]}),g.jsx("div",{className:"max-h-64 overflow-y-auto custom-scrollbar p-1",children:i.map(l=>g.jsxs("div",{className:"px-2 py-2 hover:bg-gray-50 dark:hover:bg-white/5 rounded-lg flex items-center gap-3 transition-colors cursor-pointer",children:[g.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-[10px] text-white font-bold flex-shrink-0 overflow-hidden shadow-sm",style:{backgroundColor:a(l.displayName||"A")},children:l.photoURL?g.jsx("img",{src:l.photoURL,className:"w-full h-full object-cover",alt:""}):s(l.displayName)}),g.jsx("span",{className:"truncate text-xs font-medium text-gray-700 dark:text-gray-200",children:l.displayName||"Anonymous"})]},l.uid))})]})]})]})};/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),JE=(...t)=>t.filter((e,n,r)=>!!e&&r.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var RN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=S.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:o,iconNode:s,...a},l)=>S.createElement("svg",{ref:l,...RN,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:JE("lucide",i),...a},[...s.map(([u,f])=>S.createElement(u,f)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=(t,e)=>{const n=S.forwardRef(({className:r,...i},o)=>S.createElement(AN,{ref:o,iconNode:e,className:JE(`lucide-${NN(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sy=Q("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=Q("ArchiveRestore",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MN=Q("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DN=Q("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LN=Q("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jE=Q("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=Q("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ON=Q("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UN=Q("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ji=Q("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=Q("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VN=Q("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=Q("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=Q("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GN=Q("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=Q("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zN=Q("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vg=Q("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=Q("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $N=Q("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=Q("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=Q("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=Q("MousePointer2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=Q("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jN=Q("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hh=Q("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=Q("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=Q("Redo2",[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XE=Q("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=Q("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=Q("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=Q("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=Q("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rd=Q("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bh=Q("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=Q("Sparkle",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cf=Q("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=Q("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=Q("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=Q("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=Q("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=Q("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=Q("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=Q("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=Q("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=Q("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),sR=({isAdmin:t,activeUsers:e,currentUser:n,onLogin:r,onLogout:i,syncStatus:o,isSyncing:s,isDarkMode:a,toggleDarkMode:l,onToggleSidebar:u,onLogoClick:f})=>{var p;const h=()=>o==="cloud"?g.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-blue-700 dark:text-blue-300 bg-blue-50 dark:bg-blue-900/40 px-3 py-1.5 rounded-full",children:[g.jsx("i",{className:"fa-solid fa-cloud text-[10px]"}),g.jsx("span",{className:"hidden sm:inline",children:"Live"})]}):o==="error"?g.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/40 px-3 py-1.5 rounded-full",children:[g.jsx("i",{className:"fa-solid fa-circle-exclamation text-[10px]"}),g.jsx("span",{className:"hidden sm:inline",children:"Error"})]}):g.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-3 py-1.5 rounded-full",children:[g.jsx("i",{className:"fa-solid fa-database text-[10px]"}),g.jsx("span",{className:"hidden sm:inline",children:"Local"})]});return g.jsxs("header",{className:"sticky top-0 z-30 bg-white/80 dark:bg-[#202124]/80 backdrop-blur-sm transition-colors duration-300 px-4 h-16 flex items-center justify-between border-b border-gray-100 dark:border-gray-800",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[u&&g.jsx("button",{onClick:u,className:"w-10 h-10 flex items-center justify-center text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800 rounded-full transition-colors",children:g.jsx(WN,{size:20})}),g.jsxs("div",{className:`flex items-center gap-3 ${f?"cursor-pointer hover:opacity-80 transition-opacity":""}`,onClick:f,children:[g.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-orange-500 to-red-500 rounded-xl shadow-md flex items-center justify-center text-white",children:g.jsx("i",{className:"fa-solid fa-layer-group text-lg"})}),g.jsx("div",{children:g.jsx("h1",{className:"text-xl font-medium text-gray-800 dark:text-gray-100 tracking-tight hidden md:block",children:"Spiel Master"})})]})]}),g.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.length>0&&g.jsx("div",{className:"hidden sm:block",children:g.jsx(bN,{users:e})}),g.jsx("div",{className:"h-6 w-px bg-gray-200 dark:bg-gray-700 mx-1 hidden sm:block"}),g.jsx("div",{className:"hidden sm:block",children:h()}),g.jsx("button",{onClick:l,className:"w-10 h-10 rounded-full flex items-center justify-center text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:"Toggle Dark Mode",children:g.jsx("i",{className:`fa-solid ${a?"fa-sun":"fa-moon"} text-lg`})}),n?g.jsx("div",{className:"flex items-center gap-2 pl-2",children:g.jsxs("button",{onClick:i,className:"group relative w-10 h-10 rounded-full overflow-hidden border-2 border-transparent hover:border-red-200 dark:hover:border-red-900 transition-all",title:"Logout",children:[n.photoURL?g.jsx("img",{src:n.photoURL,alt:"Profile",className:"w-full h-full object-cover"}):g.jsx("div",{className:"w-full h-full bg-blue-500 text-white flex items-center justify-center font-bold",children:((p=n.displayName)==null?void 0:p.charAt(0))||"U"}),g.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:g.jsx("i",{className:"fa-solid fa-right-from-bracket text-white text-xs"})})]})}):g.jsxs("button",{onClick:r,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-full text-sm font-medium transition-colors shadow-lg shadow-blue-500/30",children:[g.jsx("i",{className:"fa-brands fa-google"}),g.jsx("span",{className:"hidden sm:inline",children:"Sign in"})]})]})]})},aR=({value:t,onChange:e})=>g.jsxs("div",{className:"relative group w-full max-w-2xl",children:[g.jsx("div",{className:"absolute inset-y-0 left-0 pl-5 flex items-center pointer-events-none",children:g.jsx("i",{className:"fa-solid fa-magnifying-glass text-gray-400 dark:text-gray-500 group-focus-within:text-blue-600 transition-colors text-lg"})}),g.jsx("input",{type:"text",className:"block w-full pl-12 pr-10 py-3.5 bg-white dark:bg-[#303134] rounded-full shadow-sm hover:shadow-md focus:shadow-md border border-transparent hover:border-transparent focus:border-transparent focus:ring-0 transition-all text-gray-700 dark:text-gray-200 placeholder:text-gray-400 dark:placeholder:text-gray-500 text-base",placeholder:"Search for spiels...",value:t,onChange:n=>e(n.target.value)}),t&&g.jsx("button",{onClick:()=>e(""),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",children:g.jsx("i",{className:"fa-solid fa-xmark text-lg"})})]});function lR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return S.useMemo(()=>r=>{e.forEach(i=>i(r))},e)}const id=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function gs(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function Hg(t){return"nodeType"in t}function $t(t){var e,n;return t?gs(t)?t:Hg(t)&&(e=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?e:window:window}function Bg(t){const{Document:e}=$t(t);return t instanceof e}function ml(t){return gs(t)?!1:t instanceof $t(t).HTMLElement}function eC(t){return t instanceof $t(t).SVGElement}function ms(t){return t?gs(t)?t.document:Hg(t)?Bg(t)?t:ml(t)||eC(t)?t.ownerDocument:document:document:document}const er=id?S.useLayoutEffect:S.useEffect;function Gg(t){const e=S.useRef(t);return er(()=>{e.current=t}),S.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.current==null?void 0:e.current(...r)},[])}function uR(){const t=S.useRef(null),e=S.useCallback((r,i)=>{t.current=setInterval(r,i)},[]),n=S.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,n]}function za(t,e){e===void 0&&(e=[t]);const n=S.useRef(t);return er(()=>{n.current!==t&&(n.current=t)},e),n}function vl(t,e){const n=S.useRef();return S.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...e])}function ac(t){const e=Gg(t),n=S.useRef(null),r=S.useCallback(i=>{i!==n.current&&(e==null||e(i,n.current)),n.current=i},[]);return[n,r]}function Gh(t){const e=S.useRef();return S.useEffect(()=>{e.current=t},[t]),e.current}let Sf={};function yl(t,e){return S.useMemo(()=>{if(e)return e;const n=Sf[t]==null?0:Sf[t]+1;return Sf[t]=n,t+"-"+n},[t,e])}function tC(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((o,s)=>{const a=Object.entries(s);for(const[l,u]of a){const f=o[l];f!=null&&(o[l]=f+t*u)}return o},{...e})}}const Bo=tC(1),lc=tC(-1);function cR(t){return"clientX"in t&&"clientY"in t}function zg(t){if(!t)return!1;const{KeyboardEvent:e}=$t(t.target);return e&&t instanceof e}function dR(t){if(!t)return!1;const{TouchEvent:e}=$t(t.target);return e&&t instanceof e}function zh(t){if(dR(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return cR(t)?{x:t.clientX,y:t.clientY}:null}const $a=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[$a.Translate.toString(t),$a.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:r}=t;return e+" "+n+"ms "+r}}}),Ty="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function fR(t){return t.matches(Ty)?t:t.querySelector(Ty)}const hR={display:"none"};function pR(t){let{id:e,value:n}=t;return kt.createElement("div",{id:e,style:hR},n)}function gR(t){let{id:e,announcement:n,ariaLiveType:r="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return kt.createElement("div",{id:e,style:i,role:"status","aria-live":r,"aria-atomic":!0},n)}function mR(){const[t,e]=S.useState("");return{announce:S.useCallback(r=>{r!=null&&e(r)},[]),announcement:t}}const nC=S.createContext(null);function vR(t){const e=S.useContext(nC);S.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function yR(){const[t]=S.useState(()=>new Set),e=S.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[S.useCallback(r=>{let{type:i,event:o}=r;t.forEach(s=>{var a;return(a=s[i])==null?void 0:a.call(s,o)})},[t]),e]}const _R={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},wR={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function xR(t){let{announcements:e=wR,container:n,hiddenTextDescribedById:r,screenReaderInstructions:i=_R}=t;const{announce:o,announcement:s}=mR(),a=yl("DndLiveRegion"),[l,u]=S.useState(!1);if(S.useEffect(()=>{u(!0)},[]),vR(S.useMemo(()=>({onDragStart(h){let{active:p}=h;o(e.onDragStart({active:p}))},onDragMove(h){let{active:p,over:m}=h;e.onDragMove&&o(e.onDragMove({active:p,over:m}))},onDragOver(h){let{active:p,over:m}=h;o(e.onDragOver({active:p,over:m}))},onDragEnd(h){let{active:p,over:m}=h;o(e.onDragEnd({active:p,over:m}))},onDragCancel(h){let{active:p,over:m}=h;o(e.onDragCancel({active:p,over:m}))}}),[o,e])),!l)return null;const f=kt.createElement(kt.Fragment,null,kt.createElement(pR,{id:r,value:i.draggable}),kt.createElement(gR,{id:a,announcement:s}));return n?Ao.createPortal(f,n):f}var Je;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Je||(Je={}));function uc(){}function ER(t,e){return S.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function CR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return S.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const On=Object.freeze({x:0,y:0});function SR(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function TR(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return n-r}function IR(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return r-n}function kR(t,e){if(!t||t.length===0)return null;const[n]=t;return n[e]}function Iy(t,e,n){return e===void 0&&(e=t.left),n===void 0&&(n=t.top),{x:e+t.width*.5,y:n+t.height*.5}}const bR=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const i=Iy(e,e.left,e.top),o=[];for(const s of r){const{id:a}=s,l=n.get(a);if(l){const u=SR(Iy(l),i);o.push({id:a,data:{droppableContainer:s,value:u}})}}return o.sort(TR)};function NR(t,e){const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),o=Math.min(e.top+e.height,t.top+t.height),s=i-r,a=o-n;if(r<i&&n<o){const l=e.width*e.height,u=t.width*t.height,f=s*a,h=f/(l+u-f);return Number(h.toFixed(4))}return 0}const RR=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const i=[];for(const o of r){const{id:s}=o,a=n.get(s);if(a){const l=NR(a,e);l>0&&i.push({id:s,data:{droppableContainer:o,value:l}})}}return i.sort(IR)};function AR(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}function rC(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:On}function PR(t){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return i.reduce((s,a)=>({...s,top:s.top+t*a.y,bottom:s.bottom+t*a.y,left:s.left+t*a.x,right:s.right+t*a.x}),{...n})}}const MR=PR(1);function DR(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function LR(t,e,n){const r=DR(e);if(!r)return t;const{scaleX:i,scaleY:o,x:s,y:a}=r,l=t.left-s-(1-i)*parseFloat(n),u=t.top-a-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),f=i?t.width/i:t.width,h=o?t.height/o:t.height;return{width:f,height:h,top:u,right:l+f,bottom:u+h,left:l}}const OR={ignoreTransform:!1};function vs(t,e){e===void 0&&(e=OR);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:u,transformOrigin:f}=$t(t).getComputedStyle(t);u&&(n=LR(n,u,f))}const{top:r,left:i,width:o,height:s,bottom:a,right:l}=n;return{top:r,left:i,width:o,height:s,bottom:a,right:l}}function ky(t){return vs(t,{ignoreTransform:!0})}function UR(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function FR(t,e){return e===void 0&&(e=$t(t).getComputedStyle(t)),e.position==="fixed"}function VR(t,e){e===void 0&&(e=$t(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=e[i];return typeof o=="string"?n.test(o):!1})}function $g(t,e){const n=[];function r(i){if(e!=null&&n.length>=e||!i)return n;if(Bg(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!ml(i)||eC(i)||n.includes(i))return n;const o=$t(t).getComputedStyle(i);return i!==t&&VR(i,o)&&n.push(i),FR(i,o)?n:r(i.parentNode)}return t?r(t):n}function iC(t){const[e]=$g(t,1);return e??null}function Tf(t){return!id||!t?null:gs(t)?t:Hg(t)?Bg(t)||t===ms(t).scrollingElement?window:ml(t)?t:null:null}function oC(t){return gs(t)?t.scrollX:t.scrollLeft}function sC(t){return gs(t)?t.scrollY:t.scrollTop}function $h(t){return{x:oC(t),y:sC(t)}}var tt;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(tt||(tt={}));function aC(t){return!id||!t?!1:t===document.scrollingElement}function lC(t){const e={x:0,y:0},n=aC(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},i=t.scrollTop<=e.y,o=t.scrollLeft<=e.x,s=t.scrollTop>=r.y,a=t.scrollLeft>=r.x;return{isTop:i,isLeft:o,isBottom:s,isRight:a,maxScroll:r,minScroll:e}}const HR={x:.2,y:.2};function BR(t,e,n,r,i){let{top:o,left:s,right:a,bottom:l}=n;r===void 0&&(r=10),i===void 0&&(i=HR);const{isTop:u,isBottom:f,isLeft:h,isRight:p}=lC(t),m={x:0,y:0},_={x:0,y:0},x={height:e.height*i.y,width:e.width*i.x};return!u&&o<=e.top+x.height?(m.y=tt.Backward,_.y=r*Math.abs((e.top+x.height-o)/x.height)):!f&&l>=e.bottom-x.height&&(m.y=tt.Forward,_.y=r*Math.abs((e.bottom-x.height-l)/x.height)),!p&&a>=e.right-x.width?(m.x=tt.Forward,_.x=r*Math.abs((e.right-x.width-a)/x.width)):!h&&s<=e.left+x.width&&(m.x=tt.Backward,_.x=r*Math.abs((e.left+x.width-s)/x.width)),{direction:m,speed:_}}function GR(t){if(t===document.scrollingElement){const{innerWidth:o,innerHeight:s}=window;return{top:0,left:0,right:o,bottom:s,width:o,height:s}}const{top:e,left:n,right:r,bottom:i}=t.getBoundingClientRect();return{top:e,left:n,right:r,bottom:i,width:t.clientWidth,height:t.clientHeight}}function uC(t){return t.reduce((e,n)=>Bo(e,$h(n)),On)}function zR(t){return t.reduce((e,n)=>e+oC(n),0)}function $R(t){return t.reduce((e,n)=>e+sC(n),0)}function WR(t,e){if(e===void 0&&(e=vs),!t)return;const{top:n,left:r,bottom:i,right:o}=e(t);iC(t)&&(i<=0||o<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const qR=[["x",["left","right"],zR],["y",["top","bottom"],$R]];class Wg{constructor(e,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=$g(n),i=uC(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[o,s,a]of qR)for(const l of s)Object.defineProperty(this,l,{get:()=>{const u=a(r),f=i[o]-u;return this.rect[l]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ga{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=e}add(e,n,r){var i;(i=this.target)==null||i.addEventListener(e,n,r),this.listeners.push([e,n,r])}}function JR(t){const{EventTarget:e}=$t(t);return t instanceof e?t:ms(t)}function If(t,e){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof e=="number"?Math.sqrt(n**2+r**2)>e:"x"in e&&"y"in e?n>e.x&&r>e.y:"x"in e?n>e.x:"y"in e?r>e.y:!1}var sn;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(sn||(sn={}));function by(t){t.preventDefault()}function jR(t){t.stopPropagation()}var fe;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(fe||(fe={}));const cC={start:[fe.Space,fe.Enter],cancel:[fe.Esc],end:[fe.Space,fe.Enter,fe.Tab]},KR=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case fe.Right:return{...n,x:n.x+25};case fe.Left:return{...n,x:n.x-25};case fe.Down:return{...n,y:n.y+25};case fe.Up:return{...n,y:n.y-25}}};class dC{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:n}}=e;this.props=e,this.listeners=new ga(ms(n)),this.windowListeners=new ga($t(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(sn.Resize,this.handleCancel),this.windowListeners.add(sn.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(sn.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:n}=this.props,r=e.node.current;r&&WR(r),n(On)}handleKeyDown(e){if(zg(e)){const{active:n,context:r,options:i}=this.props,{keyboardCodes:o=cC,coordinateGetter:s=KR,scrollBehavior:a="smooth"}=i,{code:l}=e;if(o.end.includes(l)){this.handleEnd(e);return}if(o.cancel.includes(l)){this.handleCancel(e);return}const{collisionRect:u}=r.current,f=u?{x:u.left,y:u.top}:On;this.referenceCoordinates||(this.referenceCoordinates=f);const h=s(e,{active:n,context:r.current,currentCoordinates:f});if(h){const p=lc(h,f),m={x:0,y:0},{scrollableAncestors:_}=r.current;for(const x of _){const C=e.code,{isTop:y,isRight:w,isLeft:v,isBottom:E,maxScroll:I,minScroll:k}=lC(x),b=GR(x),T={x:Math.min(C===fe.Right?b.right-b.width/2:b.right,Math.max(C===fe.Right?b.left:b.left+b.width/2,h.x)),y:Math.min(C===fe.Down?b.bottom-b.height/2:b.bottom,Math.max(C===fe.Down?b.top:b.top+b.height/2,h.y))},R=C===fe.Right&&!w||C===fe.Left&&!v,N=C===fe.Down&&!E||C===fe.Up&&!y;if(R&&T.x!==h.x){const D=x.scrollLeft+p.x,G=C===fe.Right&&D<=I.x||C===fe.Left&&D>=k.x;if(G&&!p.y){x.scrollTo({left:D,behavior:a});return}G?m.x=x.scrollLeft-D:m.x=C===fe.Right?x.scrollLeft-I.x:x.scrollLeft-k.x,m.x&&x.scrollBy({left:-m.x,behavior:a});break}else if(N&&T.y!==h.y){const D=x.scrollTop+p.y,G=C===fe.Down&&D<=I.y||C===fe.Up&&D>=k.y;if(G&&!p.x){x.scrollTo({top:D,behavior:a});return}G?m.y=x.scrollTop-D:m.y=C===fe.Down?x.scrollTop-I.y:x.scrollTop-k.y,m.y&&x.scrollBy({top:-m.y,behavior:a});break}}this.handleMove(e,Bo(lc(h,this.referenceCoordinates),m))}}}handleMove(e,n){const{onMove:r}=this.props;e.preventDefault(),r(n)}handleEnd(e){const{onEnd:n}=this.props;e.preventDefault(),this.detach(),n()}handleCancel(e){const{onCancel:n}=this.props;e.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}dC.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:r=cC,onActivation:i}=e,{active:o}=n;const{code:s}=t.nativeEvent;if(r.start.includes(s)){const a=o.activatorNode.current;return a&&t.target!==a?!1:(t.preventDefault(),i==null||i({event:t.nativeEvent}),!0)}return!1}}];function Ny(t){return!!(t&&"distance"in t)}function Ry(t){return!!(t&&"delay"in t)}class qg{constructor(e,n,r){var i;r===void 0&&(r=JR(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=n;const{event:o}=e,{target:s}=o;this.props=e,this.events=n,this.document=ms(s),this.documentListeners=new ga(this.document),this.listeners=new ga(r),this.windowListeners=new ga($t(s)),this.initialCoordinates=(i=zh(o))!=null?i:On,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(sn.Resize,this.handleCancel),this.windowListeners.add(sn.DragStart,by),this.windowListeners.add(sn.VisibilityChange,this.handleCancel),this.windowListeners.add(sn.ContextMenu,by),this.documentListeners.add(sn.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Ry(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Ny(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,n){const{active:r,onPending:i}=this.props;i(r,e,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:e}=this,{onStart:n}=this.props;e&&(this.activated=!0,this.documentListeners.add(sn.Click,jR,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(sn.SelectionChange,this.removeTextSelection),n(e))}handleMove(e){var n;const{activated:r,initialCoordinates:i,props:o}=this,{onMove:s,options:{activationConstraint:a}}=o;if(!i)return;const l=(n=zh(e))!=null?n:On,u=lc(i,l);if(!r&&a){if(Ny(a)){if(a.tolerance!=null&&If(u,a.tolerance))return this.handleCancel();if(If(u,a.distance))return this.handleStart()}if(Ry(a)&&If(u,a.tolerance))return this.handleCancel();this.handlePending(a,u);return}e.cancelable&&e.preventDefault(),s(l)}handleEnd(){const{onAbort:e,onEnd:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleCancel(){const{onAbort:e,onCancel:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleKeydown(e){e.code===fe.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const YR={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Jg extends qg{constructor(e){const{event:n}=e,r=ms(n.target);super(e,YR,r)}}Jg.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const QR={move:{name:"mousemove"},end:{name:"mouseup"}};var Wh;(function(t){t[t.RightClick=2]="RightClick"})(Wh||(Wh={}));class XR extends qg{constructor(e){super(e,QR,ms(e.event.target))}}XR.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return n.button===Wh.RightClick?!1:(r==null||r({event:n}),!0)}}];const kf={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class ZR extends qg{constructor(e){super(e,kf)}static setup(){return window.addEventListener(kf.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(kf.move.name,e)};function e(){}}}ZR.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;const{touches:i}=n;return i.length>1?!1:(r==null||r({event:n}),!0)}}];var ma;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(ma||(ma={}));var cc;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(cc||(cc={}));function eA(t){let{acceleration:e,activator:n=ma.Pointer,canScroll:r,draggingRect:i,enabled:o,interval:s=5,order:a=cc.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:f,delta:h,threshold:p}=t;const m=nA({delta:h,disabled:!o}),[_,x]=uR(),C=S.useRef({x:0,y:0}),y=S.useRef({x:0,y:0}),w=S.useMemo(()=>{switch(n){case ma.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case ma.DraggableRect:return i}},[n,i,l]),v=S.useRef(null),E=S.useCallback(()=>{const k=v.current;if(!k)return;const b=C.current.x*y.current.x,T=C.current.y*y.current.y;k.scrollBy(b,T)},[]),I=S.useMemo(()=>a===cc.TreeOrder?[...u].reverse():u,[a,u]);S.useEffect(()=>{if(!o||!u.length||!w){x();return}for(const k of I){if((r==null?void 0:r(k))===!1)continue;const b=u.indexOf(k),T=f[b];if(!T)continue;const{direction:R,speed:N}=BR(k,T,w,e,p);for(const D of["x","y"])m[D][R[D]]||(N[D]=0,R[D]=0);if(N.x>0||N.y>0){x(),v.current=k,_(E,s),C.current=N,y.current=R;return}}C.current={x:0,y:0},y.current={x:0,y:0},x()},[e,E,r,x,o,s,JSON.stringify(w),JSON.stringify(m),_,u,I,f,JSON.stringify(p)])}const tA={x:{[tt.Backward]:!1,[tt.Forward]:!1},y:{[tt.Backward]:!1,[tt.Forward]:!1}};function nA(t){let{delta:e,disabled:n}=t;const r=Gh(e);return vl(i=>{if(n||!r||!i)return tA;const o={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[tt.Backward]:i.x[tt.Backward]||o.x===-1,[tt.Forward]:i.x[tt.Forward]||o.x===1},y:{[tt.Backward]:i.y[tt.Backward]||o.y===-1,[tt.Forward]:i.y[tt.Forward]||o.y===1}}},[n,e,r])}function rA(t,e){const n=e!=null?t.get(e):void 0,r=n?n.node.current:null;return vl(i=>{var o;return e==null?null:(o=r??i)!=null?o:null},[r,e])}function iA(t,e){return S.useMemo(()=>t.reduce((n,r)=>{const{sensor:i}=r,o=i.activators.map(s=>({eventName:s.eventName,handler:e(s.handler,r)}));return[...n,...o]},[]),[t,e])}var Wa;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Wa||(Wa={}));var qh;(function(t){t.Optimized="optimized"})(qh||(qh={}));const Ay=new Map;function oA(t,e){let{dragging:n,dependencies:r,config:i}=e;const[o,s]=S.useState(null),{frequency:a,measure:l,strategy:u}=i,f=S.useRef(t),h=C(),p=za(h),m=S.useCallback(function(y){y===void 0&&(y=[]),!p.current&&s(w=>w===null?y:w.concat(y.filter(v=>!w.includes(v))))},[p]),_=S.useRef(null),x=vl(y=>{if(h&&!n)return Ay;if(!y||y===Ay||f.current!==t||o!=null){const w=new Map;for(let v of t){if(!v)continue;if(o&&o.length>0&&!o.includes(v.id)&&v.rect.current){w.set(v.id,v.rect.current);continue}const E=v.node.current,I=E?new Wg(l(E),E):null;v.rect.current=I,I&&w.set(v.id,I)}return w}return y},[t,o,n,h,l]);return S.useEffect(()=>{f.current=t},[t]),S.useEffect(()=>{h||m()},[n,h]),S.useEffect(()=>{o&&o.length>0&&s(null)},[JSON.stringify(o)]),S.useEffect(()=>{h||typeof a!="number"||_.current!==null||(_.current=setTimeout(()=>{m(),_.current=null},a))},[a,h,m,...r]),{droppableRects:x,measureDroppableContainers:m,measuringScheduled:o!=null};function C(){switch(u){case Wa.Always:return!1;case Wa.BeforeDragging:return n;default:return!n}}}function fC(t,e){return vl(n=>t?n||(typeof e=="function"?e(t):t):null,[e,t])}function sA(t,e){return fC(t,e)}function aA(t){let{callback:e,disabled:n}=t;const r=Gg(e),i=S.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,n]);return S.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function od(t){let{callback:e,disabled:n}=t;const r=Gg(e),i=S.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[n]);return S.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function lA(t){return new Wg(vs(t),t)}function Py(t,e,n){e===void 0&&(e=lA);const[r,i]=S.useState(null);function o(){i(l=>{if(!t)return null;if(t.isConnected===!1){var u;return(u=l??n)!=null?u:null}const f=e(t);return JSON.stringify(l)===JSON.stringify(f)?l:f})}const s=aA({callback(l){if(t)for(const u of l){const{type:f,target:h}=u;if(f==="childList"&&h instanceof HTMLElement&&h.contains(t)){o();break}}}}),a=od({callback:o});return er(()=>{o(),t?(a==null||a.observe(t),s==null||s.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),s==null||s.disconnect())},[t]),r}function uA(t){const e=fC(t);return rC(t,e)}const My=[];function cA(t){const e=S.useRef(t),n=vl(r=>t?r&&r!==My&&t&&e.current&&t.parentNode===e.current.parentNode?r:$g(t):My,[t]);return S.useEffect(()=>{e.current=t},[t]),n}function dA(t){const[e,n]=S.useState(null),r=S.useRef(t),i=S.useCallback(o=>{const s=Tf(o.target);s&&n(a=>a?(a.set(s,$h(s)),new Map(a)):null)},[]);return S.useEffect(()=>{const o=r.current;if(t!==o){s(o);const a=t.map(l=>{const u=Tf(l);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,$h(u)]):null}).filter(l=>l!=null);n(a.length?new Map(a):null),r.current=t}return()=>{s(t),s(o)};function s(a){a.forEach(l=>{const u=Tf(l);u==null||u.removeEventListener("scroll",i)})}},[i,t]),S.useMemo(()=>t.length?e?Array.from(e.values()).reduce((o,s)=>Bo(o,s),On):uC(t):On,[t,e])}function Dy(t,e){e===void 0&&(e=[]);const n=S.useRef(null);return S.useEffect(()=>{n.current=null},e),S.useEffect(()=>{const r=t!==On;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?lc(t,n.current):On}function fA(t){S.useEffect(()=>{if(!id)return;const e=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of e)n==null||n()}},t.map(e=>{let{sensor:n}=e;return n}))}function hA(t,e){return S.useMemo(()=>t.reduce((n,r)=>{let{eventName:i,handler:o}=r;return n[i]=s=>{o(s,e)},n},{}),[t,e])}function hC(t){return S.useMemo(()=>t?UR(t):null,[t])}const Ly=[];function pA(t,e){e===void 0&&(e=vs);const[n]=t,r=hC(n?$t(n):null),[i,o]=S.useState(Ly);function s(){o(()=>t.length?t.map(l=>aC(l)?r:new Wg(e(l),l)):Ly)}const a=od({callback:s});return er(()=>{a==null||a.disconnect(),s(),t.forEach(l=>a==null?void 0:a.observe(l))},[t]),i}function gA(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return ml(e)?e:t}function mA(t){let{measure:e}=t;const[n,r]=S.useState(null),i=S.useCallback(u=>{for(const{target:f}of u)if(ml(f)){r(h=>{const p=e(f);return h?{...h,width:p.width,height:p.height}:p});break}},[e]),o=od({callback:i}),s=S.useCallback(u=>{const f=gA(u);o==null||o.disconnect(),f&&(o==null||o.observe(f)),r(f?e(f):null)},[e,o]),[a,l]=ac(s);return S.useMemo(()=>({nodeRef:a,rect:n,setRef:l}),[n,a,l])}const vA=[{sensor:Jg,options:{}},{sensor:dC,options:{}}],yA={current:{}},Ru={draggable:{measure:ky},droppable:{measure:ky,strategy:Wa.WhileDragging,frequency:qh.Optimized},dragOverlay:{measure:vs}};class va extends Map{get(e){var n;return e!=null&&(n=super.get(e))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:n}=e;return!n})}getNodeFor(e){var n,r;return(n=(r=this.get(e))==null?void 0:r.node.current)!=null?n:void 0}}const _A={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new va,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:uc},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ru,measureDroppableContainers:uc,windowRect:null,measuringScheduled:!1},wA={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:uc,draggableNodes:new Map,over:null,measureDroppableContainers:uc},sd=S.createContext(wA),pC=S.createContext(_A);function xA(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new va}}}function EA(t,e){switch(e.type){case Je.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Je.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Je.DragEnd:case Je.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Je.RegisterDroppable:{const{element:n}=e,{id:r}=n,i=new va(t.droppable.containers);return i.set(r,n),{...t,droppable:{...t.droppable,containers:i}}}case Je.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=e,o=t.droppable.containers.get(n);if(!o||r!==o.key)return t;const s=new va(t.droppable.containers);return s.set(n,{...o,disabled:i}),{...t,droppable:{...t.droppable,containers:s}}}case Je.UnregisterDroppable:{const{id:n,key:r}=e,i=t.droppable.containers.get(n);if(!i||r!==i.key)return t;const o=new va(t.droppable.containers);return o.delete(n),{...t,droppable:{...t.droppable,containers:o}}}default:return t}}function CA(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:i}=S.useContext(sd),o=Gh(r),s=Gh(n==null?void 0:n.id);return S.useEffect(()=>{if(!e&&!r&&o&&s!=null){if(!zg(o)||document.activeElement===o.target)return;const a=i.get(s);if(!a)return;const{activatorNode:l,node:u}=a;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const f of[l.current,u.current]){if(!f)continue;const h=fR(f);if(h){h.focus();break}}})}},[r,e,i,s,o]),null}function SA(t,e){let{transform:n,...r}=e;return t!=null&&t.length?t.reduce((i,o)=>o({transform:i,...r}),n):n}function TA(t){return S.useMemo(()=>({draggable:{...Ru.draggable,...t==null?void 0:t.draggable},droppable:{...Ru.droppable,...t==null?void 0:t.droppable},dragOverlay:{...Ru.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function IA(t){let{activeNode:e,measure:n,initialRect:r,config:i=!0}=t;const o=S.useRef(!1),{x:s,y:a}=typeof i=="boolean"?{x:i,y:i}:i;er(()=>{if(!s&&!a||!e){o.current=!1;return}if(o.current||!r)return;const u=e==null?void 0:e.node.current;if(!u||u.isConnected===!1)return;const f=n(u),h=rC(f,r);if(s||(h.x=0),a||(h.y=0),o.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const p=iC(u);p&&p.scrollBy({top:h.y,left:h.x})}},[e,s,a,r,n])}const gC=S.createContext({...On,scaleX:1,scaleY:1});var Vr;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Vr||(Vr={}));const kA=S.memo(function(e){var n,r,i,o;let{id:s,accessibility:a,autoScroll:l=!0,children:u,sensors:f=vA,collisionDetection:h=RR,measuring:p,modifiers:m,..._}=e;const x=S.useReducer(EA,void 0,xA),[C,y]=x,[w,v]=yR(),[E,I]=S.useState(Vr.Uninitialized),k=E===Vr.Initialized,{draggable:{active:b,nodes:T,translate:R},droppable:{containers:N}}=C,D=b!=null?T.get(b):null,G=S.useRef({initial:null,translated:null}),F=S.useMemo(()=>{var We;return b!=null?{id:b,data:(We=D==null?void 0:D.data)!=null?We:yA,rect:G}:null},[b,D]),J=S.useRef(null),[re,Oe]=S.useState(null),[ee,V]=S.useState(null),P=za(_,Object.values(_)),A=yl("DndDescribedBy",s),B=S.useMemo(()=>N.getEnabled(),[N]),$=TA(p),{droppableRects:q,measureDroppableContainers:ue,measuringScheduled:ve}=oA(B,{dragging:k,dependencies:[R.x,R.y],config:$.droppable}),ae=rA(T,b),Ae=S.useMemo(()=>ee?zh(ee):null,[ee]),Mt=jd(),Et=sA(ae,$.draggable.measure);IA({activeNode:b!=null?T.get(b):null,config:Mt.layoutShiftCompensation,initialRect:Et,measure:$.draggable.measure});const he=Py(ae,$.draggable.measure,Et),Ci=Py(ae?ae.parentElement:null),Ct=S.useRef({activatorEvent:null,active:null,activeNode:ae,collisionRect:null,collisions:null,droppableRects:q,draggableNodes:T,draggingNode:null,draggingNodeRect:null,droppableContainers:N,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Nr=N.getNodeFor((n=Ct.current.over)==null?void 0:n.id),on=mA({measure:$.dragOverlay.measure}),Rr=(r=on.nodeRef.current)!=null?r:ae,Ar=k?(i=on.rect)!=null?i:he:null,Si=!!(on.nodeRef.current&&on.rect),Wd=uA(Si?null:he),Ns=hC(Rr?$t(Rr):null),Hn=cA(k?Nr??ae:null),Ti=pA(Hn),Ii=SA(m,{transform:{x:R.x-Wd.x,y:R.y-Wd.y,scaleX:1,scaleY:1},activatorEvent:ee,active:F,activeNodeRect:he,containerNodeRect:Ci,draggingNodeRect:Ar,over:Ct.current.over,overlayNodeRect:on.rect,scrollableAncestors:Hn,scrollableAncestorRects:Ti,windowRect:Ns}),Ul=Ae?Bo(Ae,R):null,Ee=dA(Hn),ho=Dy(Ee),ki=Dy(Ee,[he]),Pr=Bo(Ii,ho),Bn=Ar?MR(Ar,Ii):null,Mr=F&&Bn?h({active:F,collisionRect:Bn,droppableRects:q,droppableContainers:B,pointerCoordinates:Ul}):null,Fl=kR(Mr,"id"),[Gn,Vl]=S.useState(null),po=Si?Ii:Bo(Ii,ki),qd=AR(po,(o=Gn==null?void 0:Gn.rect)!=null?o:null,he),Rs=S.useRef(null),Hl=S.useCallback((We,pt)=>{let{sensor:gt,options:En}=pt;if(J.current==null)return;const M=T.get(J.current);if(!M)return;const W=We.nativeEvent,Y=new gt({active:J.current,activeNode:M,event:W,options:En,context:Ct,onAbort(ie){if(!T.get(ie))return;const{onDragAbort:_e}=P.current,St={id:ie};_e==null||_e(St),w({type:"onDragAbort",event:St})},onPending(ie,Xe,_e,St){if(!T.get(ie))return;const{onDragPending:Ms}=P.current,Dr={id:ie,constraint:Xe,initialCoordinates:_e,offset:St};Ms==null||Ms(Dr),w({type:"onDragPending",event:Dr})},onStart(ie){const Xe=J.current;if(Xe==null)return;const _e=T.get(Xe);if(!_e)return;const{onDragStart:St}=P.current,Ps={activatorEvent:W,active:{id:Xe,data:_e.data,rect:G}};Ao.unstable_batchedUpdates(()=>{St==null||St(Ps),I(Vr.Initializing),y({type:Je.DragStart,initialCoordinates:ie,active:Xe}),w({type:"onDragStart",event:Ps}),Oe(Rs.current),V(W)})},onMove(ie){y({type:Je.DragMove,coordinates:ie})},onEnd:ye(Je.DragEnd),onCancel:ye(Je.DragCancel)});Rs.current=Y;function ye(ie){return async function(){const{active:_e,collisions:St,over:Ps,scrollAdjustedTranslate:Ms}=Ct.current;let Dr=null;if(_e&&Ms){const{cancelDrop:Ds}=P.current;Dr={activatorEvent:W,active:_e,collisions:St,delta:Ms,over:Ps},ie===Je.DragEnd&&typeof Ds=="function"&&await Promise.resolve(Ds(Dr))&&(ie=Je.DragCancel)}J.current=null,Ao.unstable_batchedUpdates(()=>{y({type:ie}),I(Vr.Uninitialized),Vl(null),Oe(null),V(null),Rs.current=null;const Ds=ie===Je.DragEnd?"onDragEnd":"onDragCancel";if(Dr){const Kd=P.current[Ds];Kd==null||Kd(Dr),w({type:Ds,event:Dr})}})}}},[T]),Jd=S.useCallback((We,pt)=>(gt,En)=>{const M=gt.nativeEvent,W=T.get(En);if(J.current!==null||!W||M.dndKit||M.defaultPrevented)return;const Y={active:W};We(gt,pt.options,Y)===!0&&(M.dndKit={capturedBy:pt.sensor},J.current=En,Hl(gt,pt))},[T,Hl]),Bl=iA(f,Jd);fA(f),er(()=>{he&&E===Vr.Initializing&&I(Vr.Initialized)},[he,E]),S.useEffect(()=>{const{onDragMove:We}=P.current,{active:pt,activatorEvent:gt,collisions:En,over:M}=Ct.current;if(!pt||!gt)return;const W={active:pt,activatorEvent:gt,collisions:En,delta:{x:Pr.x,y:Pr.y},over:M};Ao.unstable_batchedUpdates(()=>{We==null||We(W),w({type:"onDragMove",event:W})})},[Pr.x,Pr.y]),S.useEffect(()=>{const{active:We,activatorEvent:pt,collisions:gt,droppableContainers:En,scrollAdjustedTranslate:M}=Ct.current;if(!We||J.current==null||!pt||!M)return;const{onDragOver:W}=P.current,Y=En.get(Fl),ye=Y&&Y.rect.current?{id:Y.id,rect:Y.rect.current,data:Y.data,disabled:Y.disabled}:null,ie={active:We,activatorEvent:pt,collisions:gt,delta:{x:M.x,y:M.y},over:ye};Ao.unstable_batchedUpdates(()=>{Vl(ye),W==null||W(ie),w({type:"onDragOver",event:ie})})},[Fl]),er(()=>{Ct.current={activatorEvent:ee,active:F,activeNode:ae,collisionRect:Bn,collisions:Mr,droppableRects:q,draggableNodes:T,draggingNode:Rr,draggingNodeRect:Ar,droppableContainers:N,over:Gn,scrollableAncestors:Hn,scrollAdjustedTranslate:Pr},G.current={initial:Ar,translated:Bn}},[F,ae,Mr,Bn,T,Rr,Ar,q,N,Gn,Hn,Pr]),eA({...Mt,delta:R,draggingRect:Bn,pointerCoordinates:Ul,scrollableAncestors:Hn,scrollableAncestorRects:Ti});const Gl=S.useMemo(()=>({active:F,activeNode:ae,activeNodeRect:he,activatorEvent:ee,collisions:Mr,containerNodeRect:Ci,dragOverlay:on,draggableNodes:T,droppableContainers:N,droppableRects:q,over:Gn,measureDroppableContainers:ue,scrollableAncestors:Hn,scrollableAncestorRects:Ti,measuringConfiguration:$,measuringScheduled:ve,windowRect:Ns}),[F,ae,he,ee,Mr,Ci,on,T,N,q,Gn,ue,Hn,Ti,$,ve,Ns]),As=S.useMemo(()=>({activatorEvent:ee,activators:Bl,active:F,activeNodeRect:he,ariaDescribedById:{draggable:A},dispatch:y,draggableNodes:T,over:Gn,measureDroppableContainers:ue}),[ee,Bl,F,he,y,A,T,Gn,ue]);return kt.createElement(nC.Provider,{value:v},kt.createElement(sd.Provider,{value:As},kt.createElement(pC.Provider,{value:Gl},kt.createElement(gC.Provider,{value:qd},u)),kt.createElement(CA,{disabled:(a==null?void 0:a.restoreFocus)===!1})),kt.createElement(xR,{...a,hiddenTextDescribedById:A}));function jd(){const We=(re==null?void 0:re.autoScrollEnabled)===!1,pt=typeof l=="object"?l.enabled===!1:l===!1,gt=k&&!We&&!pt;return typeof l=="object"?{...l,enabled:gt}:{enabled:gt}}}),bA=S.createContext(null),Oy="button",NA="Draggable";function RA(t){let{id:e,data:n,disabled:r=!1,attributes:i}=t;const o=yl(NA),{activators:s,activatorEvent:a,active:l,activeNodeRect:u,ariaDescribedById:f,draggableNodes:h,over:p}=S.useContext(sd),{role:m=Oy,roleDescription:_="draggable",tabIndex:x=0}=i??{},C=(l==null?void 0:l.id)===e,y=S.useContext(C?gC:bA),[w,v]=ac(),[E,I]=ac(),k=hA(s,e),b=za(n);er(()=>(h.set(e,{id:e,key:o,node:w,activatorNode:E,data:b}),()=>{const R=h.get(e);R&&R.key===o&&h.delete(e)}),[h,e]);const T=S.useMemo(()=>({role:m,tabIndex:x,"aria-disabled":r,"aria-pressed":C&&m===Oy?!0:void 0,"aria-roledescription":_,"aria-describedby":f.draggable}),[r,m,x,C,_,f.draggable]);return{active:l,activatorEvent:a,activeNodeRect:u,attributes:T,isDragging:C,listeners:r?void 0:k,node:w,over:p,setNodeRef:v,setActivatorNodeRef:I,transform:y}}function AA(){return S.useContext(pC)}const PA="Droppable",MA={timeout:25};function DA(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:i}=t;const o=yl(PA),{active:s,dispatch:a,over:l,measureDroppableContainers:u}=S.useContext(sd),f=S.useRef({disabled:n}),h=S.useRef(!1),p=S.useRef(null),m=S.useRef(null),{disabled:_,updateMeasurementsFor:x,timeout:C}={...MA,...i},y=za(x??r),w=S.useCallback(()=>{if(!h.current){h.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{u(Array.isArray(y.current)?y.current:[y.current]),m.current=null},C)},[C]),v=od({callback:w,disabled:_||!s}),E=S.useCallback((T,R)=>{v&&(R&&(v.unobserve(R),h.current=!1),T&&v.observe(T))},[v]),[I,k]=ac(E),b=za(e);return S.useEffect(()=>{!v||!I.current||(v.disconnect(),h.current=!1,v.observe(I.current))},[I,v]),S.useEffect(()=>(a({type:Je.RegisterDroppable,element:{id:r,key:o,disabled:n,node:I,rect:p,data:b}}),()=>a({type:Je.UnregisterDroppable,key:o,id:r})),[r]),S.useEffect(()=>{n!==f.current.disabled&&(a({type:Je.SetDroppableDisabled,id:r,key:o,disabled:n}),f.current.disabled=n)},[r,o,n,a]),{active:s,rect:p,isOver:(l==null?void 0:l.id)===r,node:I,over:l,setNodeRef:k}}function mC(t,e,n){const r=t.slice();return r.splice(n<0?r.length+n:n,0,r.splice(e,1)[0]),r}function LA(t,e){return t.reduce((n,r,i)=>{const o=e.get(r);return o&&(n[i]=o),n},Array(t.length))}function su(t){return t!==null&&t>=0}function OA(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function UA(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const au={scaleX:1,scaleY:1},FA=t=>{var e;let{rects:n,activeNodeRect:r,activeIndex:i,overIndex:o,index:s}=t;const a=(e=n[i])!=null?e:r;if(!a)return null;const l=VA(n,s,i);if(s===i){const u=n[o];return u?{x:i<o?u.left+u.width-(a.left+a.width):u.left-a.left,y:0,...au}:null}return s>i&&s<=o?{x:-a.width-l,y:0,...au}:s<i&&s>=o?{x:a.width+l,y:0,...au}:{x:0,y:0,...au}};function VA(t,e,n){const r=t[e],i=t[e-1],o=t[e+1];return!r||!i&&!o?0:n<e?i?r.left-(i.left+i.width):o.left-(r.left+r.width):o?o.left-(r.left+r.width):r.left-(i.left+i.width)}const vC=t=>{let{rects:e,activeIndex:n,overIndex:r,index:i}=t;const o=mC(e,r,n),s=e[i],a=o[i];return!a||!s?null:{x:a.left-s.left,y:a.top-s.top,scaleX:a.width/s.width,scaleY:a.height/s.height}},yC="Sortable",_C=kt.createContext({activeIndex:-1,containerId:yC,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:vC,disabled:{draggable:!1,droppable:!1}});function HA(t){let{children:e,id:n,items:r,strategy:i=vC,disabled:o=!1}=t;const{active:s,dragOverlay:a,droppableRects:l,over:u,measureDroppableContainers:f}=AA(),h=yl(yC,n),p=a.rect!==null,m=S.useMemo(()=>r.map(k=>typeof k=="object"&&"id"in k?k.id:k),[r]),_=s!=null,x=s?m.indexOf(s.id):-1,C=u?m.indexOf(u.id):-1,y=S.useRef(m),w=!OA(m,y.current),v=C!==-1&&x===-1||w,E=UA(o);er(()=>{w&&_&&f(m)},[w,m,_,f]),S.useEffect(()=>{y.current=m},[m]);const I=S.useMemo(()=>({activeIndex:x,containerId:h,disabled:E,disableTransforms:v,items:m,overIndex:C,useDragOverlay:p,sortedRects:LA(m,l),strategy:i}),[x,h,E.draggable,E.droppable,v,m,C,l,p,i]);return kt.createElement(_C.Provider,{value:I},e)}const BA=t=>{let{id:e,items:n,activeIndex:r,overIndex:i}=t;return mC(n,r,i).indexOf(e)},GA=t=>{let{containerId:e,isSorting:n,wasDragging:r,index:i,items:o,newIndex:s,previousItems:a,previousContainerId:l,transition:u}=t;return!u||!r||a!==o&&i===s?!1:n?!0:s!==i&&e===l},zA={duration:200,easing:"ease"},wC="transform",$A=$a.Transition.toString({property:wC,duration:0,easing:"linear"}),WA={roleDescription:"sortable"};function qA(t){let{disabled:e,index:n,node:r,rect:i}=t;const[o,s]=S.useState(null),a=S.useRef(n);return er(()=>{if(!e&&n!==a.current&&r.current){const l=i.current;if(l){const u=vs(r.current,{ignoreTransform:!0}),f={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(f.x||f.y)&&s(f)}}n!==a.current&&(a.current=n)},[e,n,r,i]),S.useEffect(()=>{o&&s(null)},[o]),o}function JA(t){let{animateLayoutChanges:e=GA,attributes:n,disabled:r,data:i,getNewIndex:o=BA,id:s,strategy:a,resizeObserverConfig:l,transition:u=zA}=t;const{items:f,containerId:h,activeIndex:p,disabled:m,disableTransforms:_,sortedRects:x,overIndex:C,useDragOverlay:y,strategy:w}=S.useContext(_C),v=jA(r,m),E=f.indexOf(s),I=S.useMemo(()=>({sortable:{containerId:h,index:E,items:f},...i}),[h,i,E,f]),k=S.useMemo(()=>f.slice(f.indexOf(s)),[f,s]),{rect:b,node:T,isOver:R,setNodeRef:N}=DA({id:s,data:I,disabled:v.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...l}}),{active:D,activatorEvent:G,activeNodeRect:F,attributes:J,setNodeRef:re,listeners:Oe,isDragging:ee,over:V,setActivatorNodeRef:P,transform:A}=RA({id:s,data:I,attributes:{...WA,...n},disabled:v.draggable}),B=lR(N,re),$=!!D,q=$&&!_&&su(p)&&su(C),ue=!y&&ee,ve=ue&&q?A:null,Ae=q?ve??(a??w)({rects:x,activeNodeRect:F,activeIndex:p,overIndex:C,index:E}):null,Mt=su(p)&&su(C)?o({id:s,items:f,activeIndex:p,overIndex:C}):E,Et=D==null?void 0:D.id,he=S.useRef({activeId:Et,items:f,newIndex:Mt,containerId:h}),Ci=f!==he.current.items,Ct=e({active:D,containerId:h,isDragging:ee,isSorting:$,id:s,index:E,items:f,newIndex:he.current.newIndex,previousItems:he.current.items,previousContainerId:he.current.containerId,transition:u,wasDragging:he.current.activeId!=null}),Nr=qA({disabled:!Ct,index:E,node:T,rect:b});return S.useEffect(()=>{$&&he.current.newIndex!==Mt&&(he.current.newIndex=Mt),h!==he.current.containerId&&(he.current.containerId=h),f!==he.current.items&&(he.current.items=f)},[$,Mt,h,f]),S.useEffect(()=>{if(Et===he.current.activeId)return;if(Et!=null&&he.current.activeId==null){he.current.activeId=Et;return}const Rr=setTimeout(()=>{he.current.activeId=Et},50);return()=>clearTimeout(Rr)},[Et]),{active:D,activeIndex:p,attributes:J,data:I,rect:b,index:E,newIndex:Mt,items:f,isOver:R,isSorting:$,isDragging:ee,listeners:Oe,node:T,overIndex:C,over:V,setNodeRef:B,setActivatorNodeRef:P,setDroppableNodeRef:N,setDraggableNodeRef:re,transform:Nr??Ae,transition:on()};function on(){if(Nr||Ci&&he.current.newIndex===E)return $A;if(!(ue&&!zg(G)||!u)&&($||Ct))return $a.Transition.toString({...u,property:wC})}}function jA(t,e){var n,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(n=t==null?void 0:t.draggable)!=null?n:e.draggable,droppable:(r=t==null?void 0:t.droppable)!=null?r:e.droppable}}fe.Down,fe.Right,fe.Up,fe.Left;const KA=({cat:t,selected:e,onSelect:n,isAdmin:r,onEditCategory:i,onDeleteCategory:o,isEditMode:s})=>{const{attributes:a,listeners:l,setNodeRef:u,transform:f,transition:h,isDragging:p}=JA({id:t,disabled:!s}),m={transform:$a.Transform.toString(f),transition:h,zIndex:p?50:1,opacity:p?.5:1};return g.jsxs("div",{ref:u,style:m,className:"relative group flex-shrink-0",children:[g.jsxs("div",{className:`relative px-4 py-2 text-sm font-medium rounded-lg border transition-all whitespace-nowrap select-none flex items-center gap-2 ${e===t?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 border-transparent":"bg-white dark:bg-[#303134] text-gray-600 dark:text-gray-300 border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[s&&g.jsx("span",{...a,...l,className:"cursor-grab text-gray-400 hover:text-gray-600 touch-none",children:g.jsx(HN,{size:12})}),g.jsx("button",{onClick:()=>n(t),className:"focus:outline-none",children:t})]}),r&&s&&t!=="N/A"&&g.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1 z-10 pointer-events-auto animate-in zoom-in duration-200",children:[g.jsx("button",{type:"button",onPointerDown:_=>_.stopPropagation(),onClick:_=>{_.stopPropagation(),i==null||i(t)},className:"w-5 h-5 bg-white dark:bg-gray-700 text-blue-600 border border-gray-200 dark:border-gray-600 rounded-full flex items-center justify-center shadow-sm hover:scale-110 transition-transform cursor-pointer",title:"Edit",children:g.jsx("i",{className:"fa-solid fa-pencil text-[8px]"})}),g.jsx("button",{type:"button",onPointerDown:_=>_.stopPropagation(),onClick:_=>{_.stopPropagation(),o==null||o(t)},className:"w-5 h-5 bg-white dark:bg-gray-700 text-red-500 border border-gray-200 dark:border-gray-600 rounded-full flex items-center justify-center shadow-sm hover:scale-110 transition-transform cursor-pointer",title:"Delete",children:g.jsx("i",{className:"fa-solid fa-trash text-[8px]"})})]})]})},YA=({categories:t,selected:e,onSelect:n,isAdmin:r,onEditCategory:i,onDeleteCategory:o,onAddCategory:s,onReorder:a,isEditMode:l,onToggleEditMode:u})=>{const f=CR(ER(Jg,{activationConstraint:{distance:5}})),h=p=>{const{active:m,over:_}=p;if(_&&m.id!==_.id&&a){const x=t.indexOf(m.id),C=t.indexOf(_.id),y=[...t];y.splice(x,1),y.splice(C,0,m.id),a(y)}};return g.jsxs("div",{className:"w-full flex flex-col",children:[g.jsxs("div",{className:"flex items-center w-full",children:[g.jsxs("div",{className:"flex-1 overflow-x-auto no-scrollbar flex items-center gap-2 py-1 scroll-smooth pr-2",children:[g.jsx("div",{className:"flex-shrink-0",children:g.jsx("button",{onClick:()=>n("All"),className:`px-4 py-2 text-sm font-medium rounded-lg border transition-all whitespace-nowrap ${e==="All"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 border-transparent":"bg-white dark:bg-[#303134] text-gray-600 dark:text-gray-300 border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"All"})}),l?g.jsx(kA,{sensors:f,collisionDetection:bR,onDragEnd:h,children:g.jsx(HA,{items:t,strategy:FA,children:t.map(p=>g.jsx(KA,{cat:p,selected:e,onSelect:n,isAdmin:r,onEditCategory:i,onDeleteCategory:o,isEditMode:!0},p))})}):t.map(p=>g.jsx("button",{onClick:()=>n(p),className:`flex-shrink-0 px-4 py-2 text-sm font-medium rounded-lg border transition-all whitespace-nowrap ${e===p?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 border-transparent":"bg-white dark:bg-[#303134] text-gray-600 dark:text-gray-300 border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:p},p))]}),g.jsxs("div",{className:"flex items-center gap-2 pl-3 border-l border-gray-300 dark:border-gray-700 flex-shrink-0 bg-transparent",children:[l&&g.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),s==null||s()},className:"flex-shrink-0 w-9 h-9 rounded-lg bg-blue-600 text-white flex items-center justify-center hover:bg-blue-700 transition-all shadow-md active:scale-95",title:"Add Category",children:g.jsx(Nu,{size:18})}),g.jsx("button",{type:"button",onClick:u,className:`w-9 h-9 rounded-lg flex items-center justify-center transition-all ${l?"bg-gray-800 text-white dark:bg-white dark:text-black shadow-md":"text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-900 dark:hover:text-white"}`,title:l?"Done Editing":"Manage Categories",children:g.jsx(jN,{size:18})})]})]}),g.jsx("div",{className:"flex justify-start mt-1.5 px-1 opacity-70",children:g.jsxs("span",{className:"text-[10px] font-medium text-gray-400 dark:text-gray-500 flex items-center gap-1.5",children:[g.jsx("i",{className:"fa-solid fa-arrows-left-right text-[8px]"}),"Hold ",g.jsx("kbd",{className:"font-sans bg-gray-200 dark:bg-gray-700 px-1 py-0.5 rounded text-[9px] border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300",children:"Shift"})," + Scroll to slide"]})})]})},Jh=({spiel:t,onCopy:e,isAdmin:n,onClick:r,onEdit:i,onDelete:o,onRestore:s,onPin:a,onExpand:l,isTrashView:u=!1,onViewImage:f,isEditMode:h=!1})=>{const p=async(T,R)=>{try{await navigator.clipboard.writeText(T),e(`${R} Copied!`)}catch{e("Failed to copy text.")}},m=T=>{if(!T)return null;const R=/(https?:\/\/[^\s]+)/g;return T.split(R).map((D,G)=>D.match(R)?g.jsx("a",{href:D,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline z-20 relative break-all font-bold",onClick:F=>F.stopPropagation(),children:D},G):D)},_=t.category==="Return/Refund"||t.title.toLowerCase().includes("scam")||t.title.toLowerCase().includes("urgent"),C=_&&!u?"bg-[#3f1212] border-red-900/50":t.color?`${t.color} border-transparent`:"bg-white dark:bg-[#1e1e1e] border-gray-200 dark:border-[#333]",y=_&&!u,w=t.color&&!t.color.includes("bg-white"),v=y||w?"text-gray-900 dark:text-white":"text-gray-900 dark:text-gray-100",E=y||w?"text-gray-600 dark:text-white/80":"text-gray-600 dark:text-gray-300",I=y||w?"border-gray-200 dark:border-white/20":"border-gray-200 dark:border-gray-700",k=t.images||[],b=()=>{if(k.length===0)return null;const T=(G,F)=>{G.stopPropagation(),f==null||f(F)},R="w-full bg-black border-b border-gray-200 dark:border-gray-800";if(k.length===1)return g.jsx("div",{className:"w-full h-40 bg-gray-100 dark:bg-gray-800 relative group/image",children:g.jsx("img",{src:k[0],alt:"attachment",className:"w-full h-full object-cover transition-opacity hover:opacity-90 cursor-zoom-in",onClick:G=>T(G,k[0]),loading:"lazy"})});if(k.length===2)return g.jsx("div",{className:`${R} h-40 grid grid-cols-2 gap-[1px]`,children:k.map((G,F)=>g.jsx("div",{className:"relative w-full h-full overflow-hidden bg-white dark:bg-gray-800",children:g.jsx("img",{src:G,alt:`attachment ${F}`,className:"w-full h-full object-cover hover:opacity-90 cursor-zoom-in",onClick:J=>T(J,G),loading:"lazy"})},F))});if(k.length===3)return g.jsxs("div",{className:`${R} h-52 flex flex-col gap-[1px]`,children:[g.jsx("div",{className:"w-full h-[60%] overflow-hidden relative bg-white dark:bg-gray-800",children:g.jsx("img",{src:k[0],alt:"attachment 0",className:"w-full h-full object-cover hover:opacity-90 cursor-zoom-in",onClick:G=>T(G,k[0]),loading:"lazy"})}),g.jsx("div",{className:"w-full h-[40%] grid grid-cols-2 gap-[1px]",children:k.slice(1).map((G,F)=>g.jsx("div",{className:"relative w-full h-full overflow-hidden bg-white dark:bg-gray-800",children:g.jsx("img",{src:G,alt:`attachment ${F+1}`,className:"w-full h-full object-cover hover:opacity-90 cursor-zoom-in",onClick:J=>T(J,G),loading:"lazy"})},F))})]});const N=k.slice(0,4),D=k.length-4;return g.jsx("div",{className:`${R} h-52 grid grid-cols-2 grid-rows-2 gap-[1px]`,children:N.map((G,F)=>g.jsxs("div",{className:"relative w-full h-full overflow-hidden group/item bg-white dark:bg-gray-800",children:[g.jsx("img",{src:G,alt:`attachment ${F}`,className:"w-full h-full object-cover hover:opacity-90 cursor-zoom-in",onClick:J=>T(J,G),loading:"lazy"}),F===3&&D>0&&g.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center cursor-pointer hover:bg-black/40 transition-colors",onClick:J=>{J.stopPropagation(),l==null||l()},children:g.jsxs("span",{className:"text-white font-bold text-lg",children:["+",D]})})]},F))})};return g.jsxs("div",{id:t.id,className:`
        relative flex flex-col break-inside-avoid h-full rounded-xl overflow-hidden transition-all duration-200 border shadow-sm
        ${C}
        ${u?"":"cursor-pointer hover:shadow-md"}
      `,onClick:u?void 0:r||l,children:[b(),g.jsxs("div",{className:"p-4 flex flex-col gap-2 flex-grow",children:[g.jsxs("div",{className:"flex justify-between items-start gap-2 relative",children:[g.jsx("h3",{className:`font-bold text-sm leading-tight pr-4 ${v}`,children:t.title}),g.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t.isDefault&&g.jsx(rd,{size:12,className:"text-orange-500 flex-shrink-0"}),t.isPinned&&!u&&g.jsx("div",{className:"absolute top-0 right-0 -mt-1 -mr-1",children:g.jsx(Hh,{size:12,className:w?"text-gray-900 dark:text-white fill-current":"text-gray-900 dark:text-gray-100 fill-current"})})]})]}),g.jsxs("div",{className:`space-y-2 text-xs leading-relaxed ${E}`,children:[t.english&&g.jsx("div",{className:"line-clamp-6 transition-all select-none",children:m(t.english)}),t.english&&t.brazil&&g.jsx("div",{className:`border-t border-dashed ${I}`}),t.brazil&&g.jsx("div",{className:"line-clamp-6 transition-all select-none",children:m(t.brazil)})]}),g.jsxs("div",{className:"flex items-center justify-between pt-3 mt-auto",children:[g.jsxs("div",{className:"flex gap-1.5",children:[t.english&&g.jsx("button",{onClick:T=>{T.stopPropagation(),p(t.english,"EN")},className:`px-2 py-0.5 rounded text-[9px] font-black border opacity-80 hover:opacity-100 transition-opacity ${w?"border-gray-300 text-gray-500 dark:border-white/40 dark:text-white":"border-gray-300 text-gray-500 dark:border-gray-600 dark:text-gray-400"}`,children:"EN"}),t.brazil&&g.jsx("button",{onClick:T=>{T.stopPropagation(),p(t.brazil,"BR")},className:`px-2 py-0.5 rounded text-[9px] font-black border opacity-80 hover:opacity-100 transition-opacity ${w?"border-gray-300 text-gray-500 dark:border-white/40 dark:text-white":"border-gray-300 text-gray-500 dark:border-gray-600 dark:text-gray-400"}`,children:"BZ"})]}),g.jsx("div",{className:"flex gap-1",children:u?g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:T=>{T.stopPropagation(),s==null||s()},className:"p-1 text-green-500",children:g.jsx(XE,{size:14})}),g.jsx("button",{onClick:T=>{T.stopPropagation(),o==null||o()},className:"p-1 text-red-500",children:g.jsx(_r,{size:14})})]}):g.jsxs(g.Fragment,{children:[a&&g.jsx("button",{onClick:T=>{T.stopPropagation(),a()},className:`p-1.5 rounded-full hover:bg-black/10 dark:hover:bg-white/10 ${t.isPinned?w?"text-gray-900 dark:text-white":"text-gray-900 dark:text-gray-100":"text-gray-400"}`,children:g.jsx(Hh,{size:14,className:t.isPinned?"fill-current":""})}),n&&!t.isDefault&&g.jsx("button",{onClick:T=>{T.stopPropagation(),o==null||o()},className:"p-1.5 rounded-full hover:bg-black/10 dark:hover:bg-white/10 text-gray-400 hover:text-red-500",children:g.jsx(_r,{size:14})})]})})]})]})]})},xC=async t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=i=>{var s;const o=new Image;o.src=(s=i.target)==null?void 0:s.result,o.onload=()=>{const a=document.createElement("canvas");let l=o.width,u=o.height;const f=800,h=800;l>u?l>f&&(u*=f/l,l=f):u>h&&(l*=h/u,u=h),a.width=l,a.height=u;const p=a.getContext("2d");if(!p){n(new Error("Could not get canvas context"));return}p.drawImage(o,0,0,l,u),e(a.toDataURL("image/jpeg",.6))},o.onerror=a=>n(a)},r.onerror=i=>n(i)}),QA=[{label:"Default",value:"bg-white dark:bg-[#202124]"},{label:"Red",value:"bg-red-50 dark:bg-[#450a0a]"},{label:"Orange",value:"bg-orange-50 dark:bg-[#431407]"},{label:"Yellow",value:"bg-yellow-50 dark:bg-[#422006]"},{label:"Green",value:"bg-green-50 dark:bg-[#052e16]"},{label:"Teal",value:"bg-teal-50 dark:bg-[#042f2e]"},{label:"Blue",value:"bg-blue-50 dark:bg-[#172554]"},{label:"Purple",value:"bg-purple-50 dark:bg-[#3b0764]"},{label:"Pink",value:"bg-pink-50 dark:bg-[#500724]"},{label:"Gray",value:"bg-gray-50 dark:bg-[#1f2937]"}],XA=({categories:t,onClose:e,onSubmit:n,initialData:r,onPushInitialData:i,onRepairDatabase:o,currentSpiels:s=[],isAdmin:a=!1})=>{const[l,u]=S.useState("content"),[f,h]=S.useState(!1),[p,m]=S.useState({category:t[0]||"N/A",title:"",english:"",brazil:"",tags:[],images:[],color:"bg-white dark:bg-[#202124]"}),_=S.useMemo(()=>{const v=JSON.stringify(s),E=new TextEncoder().encode(v).length,I=(E/1024).toFixed(2),k=(E/(1024*1024*1024)*100).toFixed(6);return{kb:I,percentage:k,count:s.length}},[s]);S.useEffect(()=>{r&&m({category:r.category,title:r.title,english:r.english,brazil:r.brazil,tags:r.tags||[],images:r.images||[],color:r.color||"bg-white dark:bg-[#202124]"})},[r]),S.useEffect(()=>{const v=E=>{E.key==="Escape"&&e()};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[e]),S.useEffect(()=>{const v=async E=>{var k;const I=(k=E.clipboardData)==null?void 0:k.items;if(I){for(let b=0;b<I.length;b++)if(I[b].type.indexOf("image")!==-1){const T=I[b].getAsFile();T&&await x(T)}}};return window.addEventListener("paste",v),()=>window.removeEventListener("paste",v)},[p.images]);const x=async v=>{h(!0);try{const E=await xC(v);m(I=>({...I,images:[...I.images||[],E]}))}catch(E){console.error("Image compression failed",E)}finally{h(!1)}},C=async v=>{if(v.preventDefault(),v.dataTransfer.files&&v.dataTransfer.files[0]){const E=v.dataTransfer.files[0];E.type.startsWith("image/")&&await x(E)}},y=v=>{m(E=>{var I;return{...E,images:(I=E.images)==null?void 0:I.filter((k,b)=>b!==v)}})},w=v=>{if(v.preventDefault(),l==="settings"){e();return}n(p)};return g.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:g.jsxs("div",{className:`
        ${p.color?p.color.split(" ")[0]:"bg-white"} dark:bg-[#1e1e1e]
        rounded-3xl w-full max-w-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] transition-colors duration-300
      `,children:[g.jsxs("div",{className:"px-8 pt-8 border-b border-black/5 dark:border-white/10",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsxs("div",{className:"flex items-center gap-3 flex-1 mr-8",children:[g.jsx(FN,{className:"text-orange-500 flex-shrink-0",size:24}),g.jsx("input",{type:"text",value:p.title,onChange:v=>m({...p,title:v.target.value}),placeholder:"ENTER TITLE",className:"w-full bg-transparent border-none text-xl font-black text-gray-900 dark:text-white uppercase tracking-tighter placeholder-gray-300 dark:placeholder-gray-700 focus:ring-0 p-0",required:!0,autoFocus:!r})]}),g.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:g.jsx("i",{className:"fa-solid fa-circle-xmark text-2xl"})})]}),g.jsxs("div",{className:"flex gap-6",children:[g.jsx("button",{onClick:()=>u("content"),className:`pb-4 text-[10px] font-black uppercase tracking-widest border-b-4 transition-all ${l==="content"?"border-orange-500 text-orange-600 dark:text-orange-400":"border-transparent text-gray-400 dark:text-slate-500"}`,children:"Content & Media"}),a&&g.jsx("button",{onClick:()=>u("settings"),className:`pb-4 text-[10px] font-black uppercase tracking-widest border-b-4 transition-all ${l==="settings"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-400 dark:text-slate-500"}`,children:"System & Storage"})]})]}),g.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:g.jsx("form",{id:"admin-form",onSubmit:w,className:"p-8 space-y-6",children:l==="content"||!a?g.jsxs(g.Fragment,{children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-[10px] font-black text-gray-400 dark:text-slate-500 uppercase mb-2 tracking-widest",children:"Category"}),g.jsx("select",{className:"w-full p-3 bg-white/50 dark:bg-black/20 border border-black/10 dark:border-white/10 rounded-xl font-bold text-sm text-gray-900 dark:text-white outline-none focus:border-orange-500 transition-colors",value:p.category,onChange:v=>m({...p,category:v.target.value}),children:t.map(v=>g.jsx("option",{value:v,children:v},v))})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-[10px] font-black text-red-600 dark:text-red-400 uppercase mb-2 tracking-widest",children:"English Response"}),g.jsx("textarea",{className:"w-full p-4 bg-white/50 dark:bg-black/20 border border-black/10 dark:border-white/10 rounded-2xl h-48 text-sm font-medium text-gray-900 dark:text-white outline-none focus:border-red-500 transition-colors resize-none",value:p.english,onChange:v=>m({...p,english:v.target.value}),required:!0})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-[10px] font-black text-blue-600 dark:text-blue-400 uppercase mb-2 tracking-widest",children:"Brazil (Portuguese)"}),g.jsx("textarea",{className:"w-full p-4 bg-white/50 dark:bg-black/20 border border-black/10 dark:border-white/10 rounded-2xl h-48 text-sm font-medium text-gray-900 dark:text-white outline-none focus:border-blue-500 transition-colors resize-none",value:p.brazil,onChange:v=>m({...p,brazil:v.target.value}),required:!0})]})]}),g.jsxs("div",{children:[g.jsxs("label",{className:"block text-[10px] font-black text-gray-400 dark:text-slate-500 uppercase mb-2 tracking-widest flex items-center gap-2",children:[g.jsx(QE,{size:14}),"Card Background"]}),g.jsx("div",{className:"flex flex-wrap gap-2",children:QA.map(v=>g.jsx("button",{type:"button",onClick:()=>m({...p,color:v.value}),className:`w-8 h-8 rounded-full border-2 transition-all shadow-sm ${v.value.split(" ")[0]} ${p.color===v.value?"border-orange-500 scale-110":"border-gray-200 dark:border-gray-700 hover:scale-105"}`,title:v.label},v.label))})]}),g.jsxs("div",{children:[g.jsxs("label",{className:"block text-[10px] font-black text-gray-400 dark:text-slate-500 uppercase mb-2 tracking-widest flex items-center gap-2",children:[g.jsx(GN,{size:14}),"Visual Aids (Images)"]}),g.jsx("div",{className:"border-2 border-dashed border-gray-200 dark:border-slate-700 rounded-2xl p-6 flex flex-col items-center justify-center text-gray-400 hover:bg-white/40 dark:hover:bg-black/40 hover:border-blue-400 transition-all cursor-pointer bg-white/20 dark:bg-black/20",onDragOver:v=>v.preventDefault(),onDrop:C,children:f?g.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[g.jsx(Sy,{size:24,className:"mb-2 text-blue-500 animate-spin"}),g.jsx("span",{className:"text-xs font-bold",children:"Compressing Image..."})]}):g.jsxs("div",{className:"text-center",children:[g.jsx(nR,{size:24,className:"mx-auto mb-2 opacity-50"}),g.jsxs("p",{className:"text-xs font-bold mb-1",children:["Drag & Drop or ",g.jsx("span",{className:"text-blue-500",children:"Paste (Ctrl+V)"})," images here"]}),g.jsx("p",{className:"text-[10px] opacity-60",children:"Images will be automatically compressed to save storage."})]})}),p.images&&p.images.length>0&&g.jsx("div",{className:"flex gap-3 mt-4 overflow-x-auto pb-2",children:p.images.map((v,E)=>g.jsxs("div",{className:"relative group flex-shrink-0",children:[g.jsx("img",{src:v,alt:"preview",className:"h-20 w-auto rounded-lg border border-gray-200 dark:border-slate-700 object-cover"}),g.jsx("button",{type:"button",onClick:()=>y(E),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center shadow-md opacity-0 group-hover:opacity-100 transition-opacity",children:g.jsx(io,{size:12})})]},E))})]})]}):g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-6 rounded-2xl border border-gray-200 dark:border-slate-700",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsxs("h4",{className:"text-xs font-black text-gray-900 dark:text-white uppercase tracking-widest flex items-center gap-2",children:[g.jsx(BN,{size:14,className:"text-blue-500"}),"Storage Monitor"]}),g.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:"Limit: 1.00 GB"})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[g.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-gray-100 dark:border-slate-800",children:[g.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase mb-1",children:"My Spiels"}),g.jsx("p",{className:"text-xl font-black text-blue-500",children:_.count})]}),g.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-gray-100 dark:border-slate-800",children:[g.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase mb-1",children:"Data Size"}),g.jsxs("p",{className:"text-xl font-black text-orange-500",children:[_.kb," ",g.jsx("span",{className:"text-xs",children:"KB"})]})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase tracking-tighter text-slate-500",children:[g.jsx("span",{children:"Usage Status"}),g.jsxs("span",{className:parseFloat(_.percentage)>80?"text-red-500":"text-green-500",children:[_.percentage,"% Used"]})]}),g.jsx("div",{className:"w-full h-3 bg-gray-200 dark:bg-slate-800 rounded-full overflow-hidden",children:g.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-indigo-500 transition-all duration-1000",style:{width:`${Math.max(parseFloat(_.percentage)*1e3,2)}%`}})}),g.jsx("p",{className:"text-[9px] text-slate-500 italic",children:"Estimating based on template character count. Actual Firebase storage includes metadata."})]})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o&&g.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-xl border border-green-100 dark:border-green-800 flex flex-col gap-3",children:[g.jsxs("div",{children:[g.jsxs("h4",{className:"text-xs font-black text-green-900 dark:text-green-100 uppercase mb-1 flex items-center gap-1.5",children:[g.jsx(Sy,{size:12}),"Repair Database"]}),g.jsx("p",{className:"text-[10px] text-green-700 dark:text-green-300 font-bold leading-relaxed",children:"Clean up cloud paths and fix broken template IDs."})]}),g.jsx("button",{type:"button",onClick:o,className:"bg-green-600 text-white px-4 py-2 rounded-lg text-[10px] font-black uppercase hover:bg-green-700 transition-colors self-start",children:"Sync & Repair"})]}),i&&g.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-100 dark:border-blue-800 flex flex-col gap-3",children:[g.jsxs("div",{children:[g.jsxs("h4",{className:"text-xs font-black text-blue-900 dark:text-blue-100 uppercase mb-1 flex items-center gap-1.5",children:[g.jsx(YE,{size:12}),"Factory Reset"]}),g.jsx("p",{className:"text-[10px] text-blue-700 dark:text-blue-300 font-bold leading-relaxed",children:"Wipe all custom spiels and restore defaults."})]}),g.jsx("button",{type:"button",onClick:i,className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-[10px] font-black uppercase hover:bg-blue-700 transition-colors self-start",children:"Reset to Default"})]})]})]})})}),g.jsxs("div",{className:"p-8 border-t border-black/5 dark:border-white/10 flex justify-end gap-4",children:[g.jsx("button",{type:"button",onClick:e,className:"text-xs font-black text-gray-400 dark:text-slate-500 uppercase tracking-widest hover:text-gray-900 dark:hover:text-white transition-colors",children:"Close"}),(l==="content"||!a)&&g.jsx("button",{form:"admin-form",type:"submit",className:"px-8 py-3 rounded-2xl text-white font-black text-xs uppercase tracking-widest shadow-lg bg-orange-500 hover:bg-orange-600 transition-transform active:scale-95",children:r?"Update Spiel":"Create Spiel"})]})]})})},jh=({message:t})=>g.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 z-50 animate-bounce",children:g.jsxs("div",{className:"bg-gray-900 text-white px-6 py-3 rounded-full shadow-2xl flex items-center gap-3",children:[g.jsx("i",{className:"fa-solid fa-circle-check text-green-400"}),g.jsx("span",{className:"text-sm font-medium",children:t})]})}),ZA=({spiels:t,onSelectSpiel:e,filterText:n="",variant:r})=>{const[i,o]=S.useState("latest"),[s,a]=S.useState(!1),l=S.useMemo(()=>n?t.filter(h=>h.title.toLowerCase().includes(n.toLowerCase())):t,[t,n]),u=S.useMemo(()=>[...l].sort((h,p)=>{switch(i){case"az":return h.title.localeCompare(p.title);case"oldest":return h.createdAt-p.createdAt;case"latest":default:return p.createdAt-h.createdAt}}),[l,i]),f={latest:"Latest",oldest:"Oldest",az:"A-Z"}[i];return g.jsxs("div",{className:"flex flex-col gap-1",children:[g.jsxs("div",{className:"relative px-5 mb-1 group",children:[g.jsxs("button",{onClick:()=>a(!s),className:"flex items-center gap-1 text-[10px] text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 uppercase tracking-wider font-semibold transition-colors",children:[g.jsx("span",{children:f}),g.jsx(ON,{size:10})]}),s&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>a(!1)}),g.jsxs("div",{className:"absolute top-full left-5 mt-1 bg-white dark:bg-[#282a2c] rounded shadow-lg border border-gray-100 dark:border-gray-700 py-1 z-20 min-w-[120px]",children:[g.jsx("button",{onClick:()=>{o("latest"),a(!1)},className:"w-full text-left px-3 py-1.5 text-[11px] hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-300",children:"Latest"}),g.jsx("button",{onClick:()=>{o("oldest"),a(!1)},className:"w-full text-left px-3 py-1.5 text-[11px] hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-300",children:"Oldest"}),g.jsx("button",{onClick:()=>{o("az"),a(!1)},className:"w-full text-left px-3 py-1.5 text-[11px] hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-300",children:"Name (A-Z)"})]})]})]}),g.jsx("div",{className:"flex flex-col",children:u.length===0?g.jsx("div",{className:"px-5 py-4 text-left",children:g.jsx("p",{className:"text-xs text-gray-400 italic",children:"No items found."})}):u.map(h=>g.jsx("button",{onClick:()=>e(h.id),className:`
                group w-full text-left pl-5 pr-2 py-1.5
                text-sm font-medium transition-all duration-150
                text-gray-600 dark:text-gray-400
                hover:text-blue-600 dark:hover:text-blue-400
                hover:bg-blue-50 dark:hover:bg-blue-900/10
                border-l-[3px] border-transparent hover:border-blue-500
                truncate
              `,title:h.title,children:h.title},h.id))})]})},Uy=({title:t,message:e,onConfirm:n,onCancel:r,isDeleting:i})=>g.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm animate-in fade-in duration-200",children:g.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl w-full max-w-sm shadow-2xl overflow-hidden p-6 border border-gray-100 dark:border-slate-800 transform transition-all scale-100",children:[g.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[g.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-full flex items-center justify-center mb-4 shadow-sm",children:g.jsx("i",{className:"fa-solid fa-trash-can text-2xl"})}),g.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:t}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 leading-relaxed px-2",children:e})]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{onClick:r,disabled:i,className:"flex-1 py-3.5 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl font-bold text-xs uppercase tracking-wider hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors disabled:opacity-50",children:"Cancel"}),g.jsx("button",{onClick:n,disabled:i,className:"flex-1 py-3.5 bg-red-600 hover:bg-red-700 text-white rounded-xl font-bold text-xs uppercase tracking-wider shadow-lg hover:shadow-red-500/30 transition-all flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:i?g.jsxs(g.Fragment,{children:[g.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}),g.jsx("span",{children:"Deleting..."})]}):g.jsx("span",{children:"Delete"})})]})]})});var Fy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U=function(t,e){if(!t)throw ys(e)},ys=function(t){return new Error("Firebase Database ("+EC.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},eP=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[n++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[n++],s=t[n++],a=t[n++],l=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const o=t[n++],s=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},jg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const o=t[i],s=i+1<t.length,a=s?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=o>>2,h=(o&3)<<4|a>>4;let p=(a&15)<<2|u>>6,m=u&63;l||(m=64,s||(p=64)),r.push(n[f],n[h],n[p],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(CC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):eP(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,o==null||a==null||u==null||h==null)throw new tP;const p=o<<2|a>>4;if(r.push(p),u!==64){const m=a<<4&240|u>>2;if(r.push(m),h!==64){const _=u<<6&192|h;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class tP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const SC=function(t){const e=CC(t);return jg.encodeByteArray(e,!0)},dc=function(t){return SC(t).replace(/\./g,"")},fc=function(t){try{return jg.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(t){return qa(void 0,t)}function qa(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!rP(n)||(t[n]=qa(t[n],e[n]));return t}function rP(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP=()=>TC().__FIREBASE_DEFAULTS__,oP=()=>{if(typeof process>"u"||typeof Fy>"u")return;const t=Fy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},sP=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&fc(t[1]);return e&&JSON.parse(e)},Kg=()=>{try{return iP()||oP()||sP()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},IC=()=>{var t;return(t=Kg())===null||t===void 0?void 0:t.config},aP=t=>{var e;return(e=Kg())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lP(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[dc(JSON.stringify(n)),dc(JSON.stringify(s)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Yg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Qe())}function kC(){var t;const e=(t=Kg())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uP(){return typeof window<"u"||bC()}function bC(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function cP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function NC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function ad(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function RC(){const t=Qe();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function dP(){return EC.NODE_ADMIN===!0}function hc(){try{return typeof indexedDB=="object"}catch{return!1}}function fP(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP="FirebaseError";class Gt extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=hP,Object.setPrototypeOf(this,Gt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,oo.prototype.create)}}class oo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?pP(o,r):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new Gt(i,a,r)}}function pP(t,e){return t.replace(gP,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const gP=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(t){return JSON.parse(t)}function je(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC=function(t){let e={},n={},r={},i="";try{const o=t.split(".");e=Ja(fc(o[0])||""),n=Ja(fc(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:i}},mP=function(t){const e=AC(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},vP=function(t){const e=AC(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ki(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function pc(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function gc(t,e,n){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function Kh(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const o=t[i],s=e[i];if(Vy(o)&&Vy(s)){if(!Kh(o,s))return!1}else if(o!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Vy(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function so(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Po(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function na(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const p=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(p<<1|p>>>31)&4294967295}let i=this.chain_[0],o=this.chain_[1],s=this.chain_[2],a=this.chain_[3],l=this.chain_[4],u,f;for(let h=0;h<80;h++){h<40?h<20?(u=a^o&(s^a),f=1518500249):(u=o^s^a,f=1859775393):h<60?(u=o&s|a&(o|s),f=2400959708):(u=o^s^a,f=3395469782);const p=(i<<5|i>>>27)+u+l+f+r[h]&4294967295;l=a,a=s,s=(o<<30|o>>>2)&4294967295,o=i,i=p}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+s&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let i=0;const o=this.buf_;let s=this.inbuf_;for(;i<n;){if(s===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(o[s]=e.charCodeAt(i),++s,++i,s===this.blockSize){this.compress_(o),s=0;break}}else for(;i<n;)if(o[s]=e[i],++s,++i,s===this.blockSize){this.compress_(o),s=0;break}}this.inbuf_=s,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let o=24;o>=0;o-=8)e[r]=this.chain_[i]>>o&255,++r;return e}}function PC(t,e){const n=new _P(t,e);return n.subscribe.bind(n)}class _P{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");wP(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=bf),i.error===void 0&&(i.error=bf),i.complete===void 0&&(i.complete=bf);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wP(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function bf(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K=function(t,e,n,r){let i;if(r<e?i="at least "+e:r>n&&(i=n===0?"none":"no more than "+n),i){const o=t+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}};function zt(t,e){return`${t} failed: ${e} argument `}function nt(t,e,n,r){if(!(r&&!n)&&typeof n!="function")throw new Error(zt(t,e)+"must be a valid function.")}function Hy(t,e,n,r){if(n&&(typeof n!="object"||n===null))throw new Error(zt(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const o=i-55296;r++,U(r<t.length,"Surrogate pair missing trail surrogate.");const s=t.charCodeAt(r)-56320;i=65536+(o<<10)+s}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},ld=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z(t){return t&&t._delegate?t._delegate:t}class yn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Ot;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(CP(e))try{this.getOrInitializeService({instanceIdentifier:Ri})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Ri){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ri){return this.instances.has(e)}getOptions(e=Ri){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);r===a&&s.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);const s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:EP(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ri){return this.component?this.component.multipleInstances?e:Ri:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function EP(t){return t===Ri?void 0:t}function CP(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Yh(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg=[];var ge;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ge||(ge={}));const MC={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},SP=ge.INFO,TP={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},IP=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=TP[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _l{constructor(e){this.name=e,this._logLevel=SP,this._logHandler=IP,this._userLogHandler=null,Xg.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?MC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}}function kP(t){Xg.forEach(e=>{e.setLogLevel(t)})}function bP(t,e){for(const n of Xg){let r=null;e&&e.level&&(r=MC[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(i,o,...s)=>{const a=s.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");o>=(r??i.logLevel)&&t({level:ge[o].toLowerCase(),message:a,args:s,type:i.name})}}}const NP=(t,e)=>e.some(n=>t instanceof n);let By,Gy;function RP(){return By||(By=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function AP(){return Gy||(Gy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const DC=new WeakMap,Qh=new WeakMap,LC=new WeakMap,Nf=new WeakMap,Zg=new WeakMap;function PP(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{n(ni(t.result)),i()},s=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return e.then(n=>{n instanceof IDBCursor&&DC.set(n,t)}).catch(()=>{}),Zg.set(e,t),e}function MP(t){if(Qh.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{n(),i()},s=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});Qh.set(t,e)}let Xh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Qh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||LC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ni(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function DP(t){Xh=t(Xh)}function LP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Rf(this),e,...n);return LC.set(r,e.sort?e.sort():[e]),ni(r)}:AP().includes(t)?function(...e){return t.apply(Rf(this),e),ni(DC.get(this))}:function(...e){return ni(t.apply(Rf(this),e))}}function OP(t){return typeof t=="function"?LP(t):(t instanceof IDBTransaction&&MP(t),NP(t,RP())?new Proxy(t,Xh):t)}function ni(t){if(t instanceof IDBRequest)return PP(t);if(Nf.has(t))return Nf.get(t);const e=OP(t);return e!==t&&(Nf.set(t,e),Zg.set(e,t)),e}const Rf=t=>Zg.get(t);function UP(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=ni(s);return r&&s.addEventListener("upgradeneeded",l=>{r(ni(s.result),l.oldVersion,l.newVersion,ni(s.transaction),l)}),n&&s.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const FP=["get","getKey","getAll","getAllKeys","count"],VP=["put","add","delete","clear"],Af=new Map;function zy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Af.get(e))return Af.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=VP.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||FP.includes(n)))return;const o=async function(s,...a){const l=this.transaction(s,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return Af.set(e,o),o}DP(t=>({...t,get:(e,n,r)=>zy(e,n)||t.get(e,n,r),has:(e,n)=>!!zy(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(BP(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function BP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const mc="@firebase/app",Zh="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr=new _l("@firebase/app"),GP="@firebase/app-compat",zP="@firebase/analytics-compat",$P="@firebase/analytics",WP="@firebase/app-check-compat",qP="@firebase/app-check",JP="@firebase/auth",jP="@firebase/auth-compat",KP="@firebase/database",YP="@firebase/data-connect",QP="@firebase/database-compat",XP="@firebase/functions",ZP="@firebase/functions-compat",e1="@firebase/installations",t1="@firebase/installations-compat",n1="@firebase/messaging",r1="@firebase/messaging-compat",i1="@firebase/performance",o1="@firebase/performance-compat",s1="@firebase/remote-config",a1="@firebase/remote-config-compat",l1="@firebase/storage",u1="@firebase/storage-compat",c1="@firebase/firestore",d1="@firebase/vertexai-preview",f1="@firebase/firestore-compat",h1="firebase",p1="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li="[DEFAULT]",g1={[mc]:"fire-core",[GP]:"fire-core-compat",[$P]:"fire-analytics",[zP]:"fire-analytics-compat",[qP]:"fire-app-check",[WP]:"fire-app-check-compat",[JP]:"fire-auth",[jP]:"fire-auth-compat",[KP]:"fire-rtdb",[YP]:"fire-data-connect",[QP]:"fire-rtdb-compat",[XP]:"fire-fn",[ZP]:"fire-fn-compat",[e1]:"fire-iid",[t1]:"fire-iid-compat",[n1]:"fire-fcm",[r1]:"fire-fcm-compat",[i1]:"fire-perf",[o1]:"fire-perf-compat",[s1]:"fire-rc",[a1]:"fire-rc-compat",[l1]:"fire-gcs",[u1]:"fire-gcs-compat",[c1]:"fire-fst",[f1]:"fire-fst-compat",[d1]:"fire-vertex","fire-js":"fire-js",[h1]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui=new Map,rs=new Map,is=new Map;function ja(t,e){try{t.container.addComponent(e)}catch(n){wr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function OC(t,e){t.container.addOrOverwriteComponent(e)}function ci(t){const e=t.name;if(is.has(e))return wr.debug(`There were multiple attempts to register component ${e}.`),!1;is.set(e,t);for(const n of ui.values())ja(n,t);for(const n of rs.values())ja(n,t);return!0}function UC(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function m1(t,e,n=li){UC(t,e).clearInstance(n)}function FC(t){return t.options!==void 0}function Fe(t){return t.settings!==void 0}function v1(){is.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pn=new oo("app","Firebase",y1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VC=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new yn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pn.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1 extends VC{constructor(e,n,r,i){const o=n.automaticDataCollectionEnabled!==void 0?n.automaticDataCollectionEnabled:!1,s={name:r,automaticDataCollectionEnabled:o};if(e.apiKey!==void 0)super(e,s,i);else{const a=e;super(a.options,s,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:o},n),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,n.releaseOnDeref=void 0,An(mc,Zh,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){tm(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw pn.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i=p1;function em(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:li,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw pn.create("bad-app-name",{appName:String(i)});if(n||(n=IC()),!n)throw pn.create("no-options");const o=ui.get(i);if(o){if(Kh(n,o.options)&&Kh(r,o.config))return o;throw pn.create("duplicate-app",{appName:i})}const s=new Qg(i);for(const l of is.values())s.addComponent(l);const a=new VC(n,r,s);return ui.set(i,a),a}function w1(t,e){if(uP()&&!bC())throw pn.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let n;FC(t)?n=t.options:n=t;const r=Object.assign(Object.assign({},e),n);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;const i=u=>[...u].reduce((f,h)=>Math.imul(31,f)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw pn.create("finalization-registry-not-supported",{});const o=""+i(JSON.stringify(r)),s=rs.get(o);if(s)return s.incRefCount(e.releaseOnDeref),s;const a=new Qg(o);for(const u of is.values())a.addComponent(u);const l=new _1(n,e,o,a);return rs.set(o,l),l}function x1(t=li){const e=ui.get(t);if(!e&&t===li&&IC())return em();if(!e)throw pn.create("no-app",{appName:t});return e}function E1(){return Array.from(ui.values())}async function tm(t){let e=!1;const n=t.name;ui.has(n)?(e=!0,ui.delete(n)):rs.has(n)&&t.decRefCount()<=0&&(rs.delete(n),e=!0),e&&(await Promise.all(t.container.getProviders().map(r=>r.delete())),t.isDeleted=!0)}function An(t,e,n){var r;let i=(r=g1[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const a=[`Unable to register library "${i}" with version "${e}":`];o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wr.warn(a.join(" "));return}ci(new yn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function HC(t,e){if(t!==null&&typeof t!="function")throw pn.create("invalid-log-argument");bP(t,e)}function BC(t){kP(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1="firebase-heartbeat-database",S1=1,Ka="firebase-heartbeat-store";let Pf=null;function GC(){return Pf||(Pf=UP(C1,S1,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ka)}catch(n){console.warn(n)}}}}).catch(t=>{throw pn.create("idb-open",{originalErrorMessage:t.message})})),Pf}async function T1(t){try{const n=(await GC()).transaction(Ka),r=await n.objectStore(Ka).get(zC(t));return await n.done,r}catch(e){if(e instanceof Gt)wr.warn(e.message);else{const n=pn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});wr.warn(n.message)}}}async function $y(t,e){try{const r=(await GC()).transaction(Ka,"readwrite");await r.objectStore(Ka).put(e,zC(t)),await r.done}catch(n){if(n instanceof Gt)wr.warn(n.message);else{const r=pn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});wr.warn(r.message)}}}function zC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I1=1024,k1=30*24*60*60*1e3;class b1{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new R1(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Wy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const a=new Date(s.date).valueOf();return Date.now()-a<=k1}),this._storage.overwrite(this._heartbeatsCache))}catch(r){wr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Wy(),{heartbeatsToSend:r,unsentEntries:i}=N1(this._heartbeatsCache.heartbeats),o=dc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return wr.warn(n),""}}}function Wy(){return new Date().toISOString().substring(0,10)}function N1(t,e=I1){const n=[];let r=t.slice();for(const i of t){const o=n.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),qy(n)>e){o.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),qy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class R1{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return hc()?fP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await T1(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return $y(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return $y(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function qy(t){return dc(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A1(t){ci(new yn("platform-logger",e=>new HP(e),"PRIVATE")),ci(new yn("heartbeat",e=>new b1(e),"PRIVATE")),An(mc,Zh,t),An(mc,Zh,"esm2017"),An("fire-js","")}A1("");const P1=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Gt,SDK_VERSION:_i,_DEFAULT_ENTRY_NAME:li,_addComponent:ja,_addOrOverwriteComponent:OC,_apps:ui,_clearComponents:v1,_components:is,_getProvider:UC,_isFirebaseApp:FC,_isFirebaseServerApp:Fe,_registerComponent:ci,_removeServiceInstance:m1,_serverApps:rs,deleteApp:tm,getApp:x1,getApps:E1,initializeApp:em,initializeServerApp:w1,onLog:HC,registerVersion:An,setLogLevel:BC},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(e,n){this._delegate=e,this.firebase=n,ja(e,new yn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),tm(this._delegate)))}_getService(e,n=li){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:n})}_removeServiceInstance(e,n=li){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){ja(this._delegate,e)}_addOrOverwriteComponent(e){OC(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Jy=new oo("app-compat","Firebase",D1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L1(t){const e={},n={__esModule:!0,initializeApp:o,app:i,registerVersion:An,setLogLevel:BC,onLog:HC,apps:null,SDK_VERSION:_i,INTERNAL:{registerComponent:a,removeApp:r,useAsService:l,modularAPIs:P1}};n.default=n,Object.defineProperty(n,"apps",{get:s});function r(u){delete e[u]}function i(u){if(u=u||li,!en(e,u))throw Jy.create("no-app",{appName:u});return e[u]}i.App=t;function o(u,f={}){const h=em(u,f);if(en(e,h.name))return e[h.name];const p=new t(h,n);return e[h.name]=p,p}function s(){return Object.keys(e).map(u=>e[u])}function a(u){const f=u.name,h=f.replace("-compat","");if(ci(u)&&u.type==="PUBLIC"){const p=(m=i())=>{if(typeof m[h]!="function")throw Jy.create("invalid-app-argument",{appName:f});return m[h]()};u.serviceProps!==void 0&&qa(p,u.serviceProps),n[h]=p,t.prototype[h]=function(...m){return this._getService.bind(this,f).apply(this,u.multipleInstances?m:[])}}return u.type==="PUBLIC"?n[h]:null}function l(u,f){return f==="serverAuth"?null:f}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(){const t=L1(M1);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:$C,extendNamespace:e,createSubscribe:PC,ErrorFactory:oo,deepExtend:qa});function e(n){qa(t,n)}return t}const O1=$C();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy=new _l("@firebase/app-compat"),U1="@firebase/app-compat",F1="0.2.43";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(t){An(U1,F1,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const t=TC();if(t.firebase!==void 0){jy.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=t.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&jy.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Xt=O1;V1();var H1="firebase",B1="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xt.registerVersion(H1,B1,"app-compat");function nm(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}const zs={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},mo={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G1(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function WC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const z1=G1,$1=WC,qC=new oo("auth","Firebase",WC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vc=new _l("@firebase/auth");function W1(t,...e){vc.logLevel<=ge.WARN&&vc.warn(`Auth (${_i}): ${t}`,...e)}function Au(t,...e){vc.logLevel<=ge.ERROR&&vc.error(`Auth (${_i}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ht(t,...e){throw im(t,...e)}function Ye(t,...e){return im(t,...e)}function rm(t,e,n){const r=Object.assign(Object.assign({},$1()),{[e]:n});return new oo("auth","Firebase",r).create(e,{appName:t.name})}function st(t){return rm(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _s(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&ht(t,"argument-error"),rm(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function im(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return qC.create(t,...e)}function O(t,e,...n){if(!t)throw im(e,...n)}function Yn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Au(e),new Error(e)}function Un(t,e){t||Yn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ya(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function om(){return Ky()==="http:"||Ky()==="https:"}function Ky(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q1(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(om()||NC()||"connection"in navigator)?navigator.onLine:!0}function J1(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Un(n>e,"Short delay should be less than long delay!"),this.isMobile=Yg()||ad()}get(){return q1()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sm(t,e){Un(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K1=new wl(3e4,6e4);function He(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Be(t,e,n,r,i={}){return jC(t,i,async()=>{let o={},s={};r&&(e==="GET"?s=r:o={body:JSON.stringify(r)});const a=so(Object.assign({key:t.config.apiKey},s)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},o);return cP()||(u.referrerPolicy="no-referrer"),JC.fetch()(KC(t,t.config.apiHost,n,a),u)})}async function jC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},j1),e);try{const i=new Q1(t),o=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw ra(t,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const a=o.ok?s.errorMessage:s.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ra(t,"credential-already-in-use",s);if(l==="EMAIL_EXISTS")throw ra(t,"email-already-in-use",s);if(l==="USER_DISABLED")throw ra(t,"user-disabled",s);const f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw rm(t,f,u);ht(t,f)}}catch(i){if(i instanceof Gt)throw i;ht(t,"network-request-failed",{message:String(i)})}}async function Tr(t,e,n,r,i={}){const o=await Be(t,e,n,r,i);return"mfaPendingCredential"in o&&ht(t,"multi-factor-auth-required",{_serverResponse:o}),o}function KC(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?sm(t.config,i):`${t.config.apiScheme}://${i}`}function Y1(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Q1{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ye(this.auth,"network-request-failed")),K1.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ra(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Ye(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yy(t){return t!==void 0&&t.getResponse!==void 0}function Qy(t){return t!==void 0&&t.enterprise!==void 0}class X1{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Y1(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z1(t){return(await Be(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function eM(t,e){return Be(t,"GET","/v2/recaptchaConfig",He(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tM(t,e){return Be(t,"POST","/v1/accounts:delete",e)}async function nM(t,e){return Be(t,"POST","/v1/accounts:update",e)}async function YC(t,e){return Be(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ya(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function rM(t,e=!1){const n=Z(t),r=await n.getIdToken(e),i=ud(r);O(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:ya(Mf(i.auth_time)),issuedAtTime:ya(Mf(i.iat)),expirationTime:ya(Mf(i.exp)),signInProvider:s||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Mf(t){return Number(t)*1e3}function ud(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Au("JWT malformed, contained fewer than 3 sections"),null;try{const i=fc(n);return i?JSON.parse(i):(Au("Failed to decode base64 JWT payload"),null)}catch(i){return Au("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Xy(t){const e=ud(t);return O(e,"internal-error"),O(typeof e.exp<"u","internal-error"),O(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xr(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Gt&&iM(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function iM({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ya(this.lastLoginAt),this.creationTime=ya(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qa(t){var e;const n=t.auth,r=await t.getIdToken(),i=await xr(t,YC(n,{idToken:r}));O(i==null?void 0:i.users.length,n,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const s=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?QC(o.providerUserInfo):[],a=aM(t.providerData,s),l=t.isAnonymous,u=!(t.email&&o.passwordHash)&&!(a!=null&&a.length),f=l?u:!1,h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new ep(o.createdAt,o.lastLoginAt),isAnonymous:f};Object.assign(t,h)}async function sM(t){const e=Z(t);await Qa(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function aM(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function QC(t){return t.map(e=>{var{providerId:n}=e,r=nm(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lM(t,e){const n=await jC(t,{},async()=>{const r=so({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,s=KC(t,i,"/v1/token",`key=${o}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",JC.fetch()(s,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function uM(t,e){return Be(t,"POST","/v2/accounts:revokeToken",He(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){O(e.idToken,"internal-error"),O(typeof e.idToken<"u","internal-error"),O(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Xy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){O(e.length!==0,"internal-error");const n=Xy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(O(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:o}=await lM(e,n);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:o}=n,s=new Go;return r&&(O(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(O(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(O(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Go,this.toJSON())}_performRefresh(){return Yn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Or(t,e){O(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class lr{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,o=nm(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new oM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new ep(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await xr(this,this.stsTokenManager.getToken(this.auth,e));return O(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return rM(this,e)}reload(){return sM(this)}_assign(e){this!==e&&(O(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new lr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){O(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Qa(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fe(this.auth.app))return Promise.reject(st(this.auth));const e=await this.getIdToken();return await xr(this,tM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,o,s,a,l,u,f;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(i=n.email)!==null&&i!==void 0?i:void 0,m=(o=n.phoneNumber)!==null&&o!==void 0?o:void 0,_=(s=n.photoURL)!==null&&s!==void 0?s:void 0,x=(a=n.tenantId)!==null&&a!==void 0?a:void 0,C=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,y=(u=n.createdAt)!==null&&u!==void 0?u:void 0,w=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:v,emailVerified:E,isAnonymous:I,providerData:k,stsTokenManager:b}=n;O(v&&b,e,"internal-error");const T=Go.fromJSON(this.name,b);O(typeof v=="string",e,"internal-error"),Or(h,e.name),Or(p,e.name),O(typeof E=="boolean",e,"internal-error"),O(typeof I=="boolean",e,"internal-error"),Or(m,e.name),Or(_,e.name),Or(x,e.name),Or(C,e.name),Or(y,e.name),Or(w,e.name);const R=new lr({uid:v,auth:e,email:p,emailVerified:E,displayName:h,isAnonymous:I,photoURL:_,phoneNumber:m,tenantId:x,stsTokenManager:T,createdAt:y,lastLoginAt:w});return k&&Array.isArray(k)&&(R.providerData=k.map(N=>Object.assign({},N))),C&&(R._redirectEventId=C),R}static async _fromIdTokenResponse(e,n,r=!1){const i=new Go;i.updateFromServerResponse(n);const o=new lr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Qa(o),o}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];O(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?QC(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),a=new Go;a.updateFromIdToken(r);const l=new lr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new ep(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zy=new Map;function Yt(t){Un(t instanceof Function,"Expected a class definition");let e=Zy.get(t);return e?(Un(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Zy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}XC.type="NONE";const os=XC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(t,e,n){return`firebase:${t}:${e}:${n}`}class zo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=Hi(this.userKey,i.apiKey,o),this.fullPersistenceKey=Hi("persistence",i.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?lr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new zo(Yt(os),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=i[0]||Yt(os);const s=Hi(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const f=await u._get(s);if(f){const h=lr._fromJSON(e,f);u!==o&&(a=h),o=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new zo(o,e,r):(o=l[0],a&&await o._set(s,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==o)try{await u._remove(s)}catch{}})),new zo(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ZC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(rS(e))return"Blackberry";if(iS(e))return"Webos";if(eS(e))return"Safari";if((e.includes("chrome/")||tS(e))&&!e.includes("edge/"))return"Chrome";if(xl(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function ZC(t=Qe()){return/firefox\//i.test(t)}function eS(t=Qe()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tS(t=Qe()){return/crios\//i.test(t)}function nS(t=Qe()){return/iemobile/i.test(t)}function xl(t=Qe()){return/android/i.test(t)}function rS(t=Qe()){return/blackberry/i.test(t)}function iS(t=Qe()){return/webos/i.test(t)}function El(t=Qe()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function cM(t=Qe()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function dM(t=Qe()){var e;return El(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function fM(){return RC()&&document.documentMode===10}function oS(t=Qe()){return El(t)||xl(t)||iS(t)||rS(t)||/windows phone/i.test(t)||nS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sS(t,e=[]){let n;switch(t){case"Browser":n=e0(Qe());break;case"Worker":n=`${e0(Qe())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${_i}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((s,a)=>{try{const l=e(o);s(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pM(t,e={}){return Be(t,"GET","/v2/passwordPolicy",He(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gM=6;class mM{constructor(e){var n,r,i,o;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=s.minPasswordLength)!==null&&n!==void 0?n:gM,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,o,s,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsUppercaseLetter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(s=l.containsNumericCharacter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new t0(this),this.idTokenSubscription=new t0(this),this.beforeStateQueue=new hM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Yt(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await zo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await YC(this,{idToken:e}),r=await lr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Fe(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!s||s===a)&&(l!=null&&l.user)&&(i=l.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return O(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Qa(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=J1()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fe(this.app))return Promise.reject(st(this));const n=e?Z(e):null;return n&&O(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&O(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fe(this.app)?Promise.reject(st(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fe(this.app)?Promise.reject(st(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Yt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await pM(this),n=new mM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new oo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await uM(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Yt(e)||this._popupRedirectResolver;O(n,this,"argument-error"),this.redirectPersistenceManager=await zo.create(this,[Yt(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(O(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{s=!0,l()}}else{const l=e.addObserver(n);return()=>{s=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return O(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=sS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&W1(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Ve(t){return Z(t)}class t0{constructor(e){this.auth=e,this.observer=null,this.addObserver=PC(n=>this.observer=n)}get next(){return O(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cl={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function yM(t){Cl=t}function am(t){return Cl.loadJS(t)}function _M(){return Cl.recaptchaV2Script}function wM(){return Cl.recaptchaEnterpriseScript}function xM(){return Cl.gapiScript}function aS(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const EM="recaptcha-enterprise",CM="NO_RECAPTCHA";class SM{constructor(e){this.type=EM,this.auth=Ve(e)}async verify(e="verify",n=!1){async function r(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(s,a)=>{eM(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new X1(l);return o.tenantId==null?o._agentRecaptchaConfig=u:o._tenantRecaptchaConfigs[o.tenantId]=u,s(u.siteKey)}}).catch(l=>{a(l)})})}function i(o,s,a){const l=window.grecaptcha;Qy(l)?l.enterprise.ready(()=>{l.enterprise.execute(o,{action:e}).then(u=>{s(u)}).catch(()=>{s(CM)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,s)=>{r(this.auth).then(a=>{if(!n&&Qy(window.grecaptcha))i(a,o,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let l=wM();l.length!==0&&(l+=a),am(l).then(()=>{i(a,o,s)}).catch(u=>{s(u)})}}).catch(a=>{s(a)})})}}async function n0(t,e,n,r=!1){const i=new SM(t);let o;try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const s=Object.assign({},e);return r?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function Xa(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await n0(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await n0(t,e,n,n==="getOobCode");return r(t,s)}else return Promise.reject(o)})}function TM(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Yt);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function IM(t,e,n){const r=Ve(t);O(r._canInitEmulator,r,"emulator-config-failed"),O(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),o=lS(e),{host:s,port:a}=kM(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${o}//${s}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||bM()}function lS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function kM(t){const e=lS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:r0(r.substr(o.length+1))}}else{const[o,s]=r.split(":");return{host:o,port:r0(s)}}}function r0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function bM(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Yn("not implemented")}_getIdTokenResponse(e){return Yn("not implemented")}_linkToIdToken(e,n){return Yn("not implemented")}_getReauthenticationResolver(e){return Yn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uS(t,e){return Be(t,"POST","/v1/accounts:resetPassword",He(t,e))}async function NM(t,e){return Be(t,"POST","/v1/accounts:update",e)}async function RM(t,e){return Be(t,"POST","/v1/accounts:signUp",e)}async function AM(t,e){return Be(t,"POST","/v1/accounts:update",He(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PM(t,e){return Tr(t,"POST","/v1/accounts:signInWithPassword",He(t,e))}async function cd(t,e){return Be(t,"POST","/v1/accounts:sendOobCode",He(t,e))}async function MM(t,e){return cd(t,e)}async function DM(t,e){return cd(t,e)}async function LM(t,e){return cd(t,e)}async function OM(t,e){return cd(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UM(t,e){return Tr(t,"POST","/v1/accounts:signInWithEmailLink",He(t,e))}async function FM(t,e){return Tr(t,"POST","/v1/accounts:signInWithEmailLink",He(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za extends ws{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Za(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Za(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xa(e,n,"signInWithPassword",PM);case"emailLink":return UM(e,{email:this._email,oobCode:this._password});default:ht(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Xa(e,r,"signUpPassword",RM);case"emailLink":return FM(e,{idToken:n,email:this._email,oobCode:this._password});default:ht(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hr(t,e){return Tr(t,"POST","/v1/accounts:signInWithIdp",He(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VM="http://localhost";class tr extends ws{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new tr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ht("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,o=nm(n,["providerId","signInMethod"]);if(!r||!i)return null;const s=new tr(r,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const n=this.buildRequest();return hr(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,hr(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,hr(e,n)}buildRequest(){const e={requestUri:VM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=so(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HM(t,e){return Be(t,"POST","/v1/accounts:sendVerificationCode",He(t,e))}async function BM(t,e){return Tr(t,"POST","/v1/accounts:signInWithPhoneNumber",He(t,e))}async function GM(t,e){const n=await Tr(t,"POST","/v1/accounts:signInWithPhoneNumber",He(t,e));if(n.temporaryProof)throw ra(t,"account-exists-with-different-credential",n);return n}const zM={USER_NOT_FOUND:"user-not-found"};async function $M(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Tr(t,"POST","/v1/accounts:signInWithPhoneNumber",He(t,n),zM)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi extends ws{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Bi({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Bi({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return BM(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return GM(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return $M(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:i}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:o}=e;return!r&&!n&&!i&&!o?null:new Bi({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function qM(t){const e=Po(na(t)).link,n=e?Po(na(e)).deep_link_id:null,r=Po(na(t)).deep_link_id;return(r?Po(na(r)).link:null)||r||n||e||t}class dd{constructor(e){var n,r,i,o,s,a;const l=Po(na(e)),u=(n=l.apiKey)!==null&&n!==void 0?n:null,f=(r=l.oobCode)!==null&&r!==void 0?r:null,h=WM((i=l.mode)!==null&&i!==void 0?i:null);O(u&&f&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=f,this.continueUrl=(o=l.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(s=l.languageCode)!==null&&s!==void 0?s:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=qM(e);try{return new dd(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(){this.providerId=wi.PROVIDER_ID}static credential(e,n){return Za._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=dd.parseLink(n);return O(r,"argument-error"),Za._fromEmailAndCode(e,r.code,r.tenantId)}}wi.PROVIDER_ID="password";wi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";wi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs extends Ir{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class $o extends xs{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return O("providerId"in n&&"signInMethod"in n,"argument-error"),tr._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return O(e.idToken||e.accessToken,"argument-error"),tr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return $o.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return $o.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:o,nonce:s,providerId:a}=e;if(!r&&!i&&!n&&!o||!a)return null;try{return new $o(a)._credential({idToken:n,accessToken:r,nonce:s,pendingToken:o})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn extends xs{constructor(){super("facebook.com")}static credential(e){return tr._fromParams({providerId:qn.PROVIDER_ID,signInMethod:qn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qn.credentialFromTaggedObject(e)}static credentialFromError(e){return qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qn.credential(e.oauthAccessToken)}catch{return null}}}qn.FACEBOOK_SIGN_IN_METHOD="facebook.com";qn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn extends xs{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return tr._fromParams({providerId:Jn.PROVIDER_ID,signInMethod:Jn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Jn.credentialFromTaggedObject(e)}static credentialFromError(e){return Jn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Jn.credential(n,r)}catch{return null}}}Jn.GOOGLE_SIGN_IN_METHOD="google.com";Jn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn extends xs{constructor(){super("github.com")}static credential(e){return tr._fromParams({providerId:jn.PROVIDER_ID,signInMethod:jn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jn.credentialFromTaggedObject(e)}static credentialFromError(e){return jn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jn.credential(e.oauthAccessToken)}catch{return null}}}jn.GITHUB_SIGN_IN_METHOD="github.com";jn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JM="http://localhost";class ss extends ws{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return hr(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,hr(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,hr(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:o}=n;return!r||!i||!o||r!==i?null:new ss(r,o)}static _create(e,n){return new ss(e,n)}buildRequest(){return{requestUri:JM,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jM="saml.";class yc extends Ir{constructor(e){O(e.startsWith(jM),"argument-error"),super(e)}static credentialFromResult(e){return yc.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return yc.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=ss.fromJSON(e);return O(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return ss._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn extends xs{constructor(){super("twitter.com")}static credential(e,n){return tr._fromParams({providerId:Kn.PROVIDER_ID,signInMethod:Kn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Kn.credentialFromTaggedObject(e)}static credentialFromError(e){return Kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Kn.credential(n,r)}catch{return null}}}Kn.TWITTER_SIGN_IN_METHOD="twitter.com";Kn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cS(t,e){return Tr(t,"POST","/v1/accounts:signUp",He(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const o=await lr._fromIdTokenResponse(e,r,i),s=i0(r);return new _n({user:o,providerId:s,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=i0(r);return new _n({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function i0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KM(t){var e;if(Fe(t.app))return Promise.reject(st(t));const n=Ve(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new _n({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await cS(n,{returnSecureToken:!0}),i=await _n._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c extends Gt{constructor(e,n,r,i){var o;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,_c.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new _c(e,n,r,i)}}function dS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?_c._fromErrorAndOperation(t,o,e,r):o})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fS(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YM(t,e){const n=Z(t);await fd(!0,n,e);const{providerUserInfo:r}=await nM(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),i=fS(r||[]);return n.providerData=n.providerData.filter(o=>i.has(o.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function lm(t,e,n=!1){const r=await xr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return _n._forOperation(t,"link",r)}async function fd(t,e,n){await Qa(e);const r=fS(e.providerData),i=t===!1?"provider-already-linked":"no-such-provider";O(r.has(n)===t,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hS(t,e,n=!1){const{auth:r}=t;if(Fe(r.app))return Promise.reject(st(r));const i="reauthenticate";try{const o=await xr(t,dS(r,i,e,t),n);O(o.idToken,r,"internal-error");const s=ud(o.idToken);O(s,r,"internal-error");const{sub:a}=s;return O(t.uid===a,r,"user-mismatch"),_n._forOperation(t,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&ht(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pS(t,e,n=!1){if(Fe(t.app))return Promise.reject(st(t));const r="signIn",i=await dS(t,r,e),o=await _n._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(o.user),o}async function hd(t,e){return pS(Ve(t),e)}async function gS(t,e){const n=Z(t);return await fd(!1,n,e.providerId),lm(n,e)}async function mS(t,e){return hS(Z(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QM(t,e){return Tr(t,"POST","/v1/accounts:signInWithCustomToken",He(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XM(t,e){if(Fe(t.app))return Promise.reject(st(t));const n=Ve(t),r=await QM(n,{token:e,returnSecureToken:!0}),i=await _n._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?um._fromServerResponse(e,n):"totpInfo"in n?cm._fromServerResponse(e,n):ht(e,"internal-error")}}class um extends Sl{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new um(n)}}class cm extends Sl{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new cm(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pd(t,e,n){var r;O(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),O(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(O(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(O(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dm(t){const e=Ve(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function ZM(t,e,n){const r=Ve(t),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&pd(r,i,n),await Xa(r,i,"getOobCode",DM)}async function eD(t,e,n){await uS(Z(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&dm(t),r})}async function tD(t,e){await AM(Z(t),{oobCode:e})}async function vS(t,e){const n=Z(t),r=await uS(n,{oobCode:e}),i=r.requestType;switch(O(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":O(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":O(r.mfaInfo,n,"internal-error");default:O(r.email,n,"internal-error")}let o=null;return r.mfaInfo&&(o=Sl._fromServerResponse(Ve(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:o},operation:i}}async function nD(t,e){const{data:n}=await vS(Z(t),e);return n.email}async function rD(t,e,n){if(Fe(t.app))return Promise.reject(st(t));const r=Ve(t),s=await Xa(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",cS).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&dm(t),l}),a=await _n._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(a.user),a}function iD(t,e,n){return Fe(t.app)?Promise.reject(st(t)):hd(Z(t),wi.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&dm(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oD(t,e,n){const r=Ve(t),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(s,a){O(a.handleCodeInApp,r,"argument-error"),a&&pd(r,s,a)}o(i,n),await Xa(r,i,"getOobCode",LM)}function sD(t,e){const n=dd.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function aD(t,e,n){if(Fe(t.app))return Promise.reject(st(t));const r=Z(t),i=wi.credentialWithLink(e,n||Ya());return O(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),hd(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lD(t,e){return Be(t,"POST","/v1/accounts:createAuthUri",He(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uD(t,e){const n=om()?Ya():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await lD(Z(t),r);return i||[]}async function cD(t,e){const n=Z(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&pd(n.auth,i,e);const{email:o}=await MM(n.auth,i);o!==t.email&&await t.reload()}async function dD(t,e,n){const r=Z(t),o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&pd(r.auth,o,n);const{email:s}=await OM(r.auth,o);s!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fD(t,e){return Be(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hD(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Z(t),o={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},s=await xr(r,fD(r.auth,o));r.displayName=s.displayName||null,r.photoURL=s.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(s)}function pD(t,e){const n=Z(t);return Fe(n.auth.app)?Promise.reject(st(n.auth)):yS(n,e,null)}function gD(t,e){return yS(Z(t),null,e)}async function yS(t,e,n){const{auth:r}=t,o={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(o.email=e),n&&(o.password=n);const s=await xr(t,NM(r,o));await t._updateTokensIfNecessary(s,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mD(t){var e,n;if(!t)return null;const{providerId:r}=t,i=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},o=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t!=null&&t.idToken)){const s=(n=(e=ud(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(s){const a=s!=="anonymous"&&s!=="custom"?s:null;return new Wo(o,a)}}if(!r)return null;switch(r){case"facebook.com":return new vD(o,i);case"github.com":return new yD(o,i);case"google.com":return new _D(o,i);case"twitter.com":return new wD(o,i,t.screenName||null);case"custom":case"anonymous":return new Wo(o,null);default:return new Wo(o,r,i)}}class Wo{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class _S extends Wo{constructor(e,n,r,i){super(e,n,r),this.username=i}}class vD extends Wo{constructor(e,n){super(e,"facebook.com",n)}}class yD extends _S{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class _D extends Wo{constructor(e,n){super(e,"google.com",n)}}class wD extends _S{constructor(e,n,r){super(e,"twitter.com",n,r)}}function xD(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:mD(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new Oi("enroll",e,n)}static _fromMfaPendingCredential(e){return new Oi("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return Oi._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Oi._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=Ve(e),i=n.customData._serverResponse,o=(i.mfaInfo||[]).map(a=>Sl._fromServerResponse(r,a));O(i.mfaPendingCredential,r,"internal-error");const s=Oi._fromMfaPendingCredential(i.mfaPendingCredential);return new fm(s,o,async a=>{const l=await a._process(r,s);delete i.mfaInfo,delete i.mfaPendingCredential;const u=Object.assign(Object.assign({},i),{idToken:l.idToken,refreshToken:l.refreshToken});switch(n.operationType){case"signIn":const f=await _n._fromIdTokenResponse(r,n.operationType,u);return await r._updateCurrentUser(f.user),f;case"reauthenticate":return O(n.user,r,"internal-error"),_n._forOperation(n.user,n.operationType,u);default:ht(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function ED(t,e){var n;const r=Z(t),i=e;return O(e.customData.operationType,r,"argument-error"),O((n=i.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),fm._fromError(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(t,e){return Be(t,"POST","/v2/accounts/mfaEnrollment:start",He(t,e))}function SD(t,e){return Be(t,"POST","/v2/accounts/mfaEnrollment:finalize",He(t,e))}function TD(t,e){return Be(t,"POST","/v2/accounts/mfaEnrollment:withdraw",He(t,e))}class hm{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>Sl._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new hm(e)}async getSession(){return Oi._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,i=await this.getSession(),o=await xr(this.user,r._process(this.user.auth,i,n));return await this.user._updateTokensIfNecessary(o),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await xr(this.user,TD(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==n),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Df=new WeakMap;function ID(t){const e=Z(t);return Df.has(e)||Df.set(e,hm._fromUser(e)),Df.get(e)}const wc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(wc,"1"),this.storage.removeItem(wc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD=1e3,bD=10;class xS extends wS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=oS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((s,a,l)=>{this.notifyListeners(s,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(r);!n&&this.localCache[r]===s||this.notifyListeners(r,s)},o=this.storage.getItem(r);fM()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,bD):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},kD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}xS.type="LOCAL";const pm=xS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES extends wS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}ES.type="SESSION";const Yi=ES;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new gd(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:o}=n.data,s=this.handlersMap[i];if(!(s!=null&&s.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(s).map(async u=>u(n.origin,o)),l=await ND(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}gd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tl(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,l)=>{const u=Tl("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(h){const p=h;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(f),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(p.data.response);break;default:clearTimeout(f),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(){return window}function AD(t){ze().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gm(){return typeof ze().WorkerGlobalScope<"u"&&typeof ze().importScripts=="function"}async function PD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function MD(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function DD(){return gm()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CS="firebaseLocalStorageDb",LD=1,xc="firebaseLocalStorage",SS="fbase_key";class Il{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function md(t,e){return t.transaction([xc],e?"readwrite":"readonly").objectStore(xc)}function OD(){const t=indexedDB.deleteDatabase(CS);return new Il(t).toPromise()}function tp(){const t=indexedDB.open(CS,LD);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(xc,{keyPath:SS})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(xc)?e(r):(r.close(),await OD(),e(await tp()))})})}async function o0(t,e,n){const r=md(t,!0).put({[SS]:e,value:n});return new Il(r).toPromise()}async function UD(t,e){const n=md(t,!1).get(e),r=await new Il(n).toPromise();return r===void 0?null:r.value}function s0(t,e){const n=md(t,!0).delete(e);return new Il(n).toPromise()}const FD=800,VD=3;class TS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await tp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>VD)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return gm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=gd._getInstance(DD()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await PD(),!this.activeServiceWorker)return;this.sender=new RD(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||MD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await tp();return await o0(e,wc,"1"),await s0(e,wc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>o0(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>UD(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>s0(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=md(i,!1).getAll();return new Il(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),FD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}TS.type="LOCAL";const el=TS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HD(t,e){return Be(t,"POST","/v2/accounts/mfaSignIn:start",He(t,e))}function BD(t,e){return Be(t,"POST","/v2/accounts/mfaSignIn:finalize",He(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GD=500,zD=6e4,lu=1e12;class $D{constructor(e){this.auth=e,this.counter=lu,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new WD(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||lu;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||lu;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||lu;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class WD{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;O(i,"argument-error",{appName:n}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=qD(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},zD)},GD))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function qD(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf=aS("rcb"),JD=new wl(3e4,6e4);class jD{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=ze().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return O(KD(n),e,"argument-error"),this.shouldResolveImmediately(n)&&Yy(ze().grecaptcha)?Promise.resolve(ze().grecaptcha):new Promise((r,i)=>{const o=ze().setTimeout(()=>{i(Ye(e,"network-request-failed"))},JD.get());ze()[Lf]=()=>{ze().clearTimeout(o),delete ze()[Lf];const a=ze().grecaptcha;if(!a||!Yy(a)){i(Ye(e,"internal-error"));return}const l=a.render;a.render=(u,f)=>{const h=l(u,f);return this.counter++,h},this.hostLanguage=n,r(a)};const s=`${_M()}?${so({onload:Lf,render:"explicit",hl:n})}`;am(s).catch(()=>{clearTimeout(o),i(Ye(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=ze().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function KD(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class YD{async load(e){return new $D(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS="recaptcha",QD={theme:"light",type:"image"};let XD=class{constructor(e,n,r=Object.assign({},QD)){this.parameters=r,this.type=IS,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ve(e),this.isInvisible=this.parameters.size==="invisible",O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof n=="string"?document.getElementById(n):n;O(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new YD:new jD,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(i=>{const o=s=>{s&&(this.tokenChangeListeners.delete(o),i(s))};this.tokenChangeListeners.add(o),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){O(!this.parameters.sitekey,this.auth,"argument-error"),O(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=ze()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){O(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){O(om()&&!gm(),this.auth,"internal-error"),await ZD(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await Z1(this.auth);O(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return O(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function ZD(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Bi._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function eL(t,e,n){if(Fe(t.app))return Promise.reject(st(t));const r=Ve(t),i=await vd(r,e,Z(n));return new mm(i,o=>hd(r,o))}async function tL(t,e,n){const r=Z(t);await fd(!1,r,"phone");const i=await vd(r.auth,e,Z(n));return new mm(i,o=>gS(r,o))}async function nL(t,e,n){const r=Z(t);if(Fe(r.auth.app))return Promise.reject(st(r.auth));const i=await vd(r.auth,e,Z(n));return new mm(i,o=>mS(r,o))}async function vd(t,e,n){var r;const i=await n.verify();try{O(typeof i=="string",t,"argument-error"),O(n.type===IS,t,"argument-error");let o;if(typeof e=="string"?o={phoneNumber:e}:o=e,"session"in o){const s=o.session;if("phoneNumber"in o)return O(s.type==="enroll",t,"internal-error"),(await CD(t,{idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{O(s.type==="signin",t,"internal-error");const a=((r=o.multiFactorHint)===null||r===void 0?void 0:r.uid)||o.multiFactorUid;return O(a,t,"missing-multi-factor-info"),(await HD(t,{mfaPendingCredential:s.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:s}=await HM(t,{phoneNumber:o.phoneNumber,recaptchaToken:i});return s}}finally{n._reset()}}async function rL(t,e){const n=Z(t);if(Fe(n.auth.app))return Promise.reject(st(n.auth));await lm(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qi=class Pu{constructor(e){this.providerId=Pu.PROVIDER_ID,this.auth=Ve(e)}verifyPhoneNumber(e,n){return vd(this.auth,e,Z(n))}static credential(e,n){return Bi._fromVerification(e,n)}static credentialFromResult(e){const n=e;return Pu.credentialFromTaggedObject(n)}static credentialFromError(e){return Pu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Bi._fromTokenResponse(n,r):null}};Qi.PROVIDER_ID="phone";Qi.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ao(t,e){return e?Yt(e):(O(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm extends ws{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return hr(e,this._buildIdpRequest())}_linkToIdToken(e,n){return hr(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return hr(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function iL(t){return pS(t.auth,new vm(t),t.bypassAuthState)}function oL(t){const{auth:e,user:n}=t;return O(n,e,"internal-error"),hS(n,new vm(t),t.bypassAuthState)}async function sL(t){const{auth:e,user:n}=t;return O(n,e,"internal-error"),lm(n,new vm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,n,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return iL;case"linkViaPopup":case"linkViaRedirect":return sL;case"reauthViaPopup":case"reauthViaRedirect":return oL;default:ht(this.auth,"internal-error")}}resolve(e){Un(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Un(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL=new wl(2e3,1e4);async function lL(t,e,n){if(Fe(t.app))return Promise.reject(Ye(t,"operation-not-supported-in-this-environment"));const r=Ve(t);_s(t,e,Ir);const i=ao(r,n);return new ur(r,"signInViaPopup",e,i).executeNotNull()}async function uL(t,e,n){const r=Z(t);if(Fe(r.auth.app))return Promise.reject(Ye(r.auth,"operation-not-supported-in-this-environment"));_s(r.auth,e,Ir);const i=ao(r.auth,n);return new ur(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function cL(t,e,n){const r=Z(t);_s(r.auth,e,Ir);const i=ao(r.auth,n);return new ur(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class ur extends kS{constructor(e,n,r,i,o){super(e,n,i,o),this.provider=r,this.authWindow=null,this.pollId=null,ur.currentPopupAction&&ur.currentPopupAction.cancel(),ur.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return O(e,this.auth,"internal-error"),e}async onExecution(){Un(this.filter.length===1,"Popup operations only handle one event");const e=Tl();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ye(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ye(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ur.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ye(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,aL.get())};e()}}ur.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL="pendingRedirect",_a=new Map;class fL extends kS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=_a.get(this.auth._key());if(!e){try{const r=await hL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}_a.set(this.auth._key(),e)}return this.bypassAuthState||_a.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function hL(t,e){const n=NS(e),r=bS(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}async function ym(t,e){return bS(t)._set(NS(e),"true")}function pL(){_a.clear()}function _m(t,e){_a.set(t._key(),e)}function bS(t){return Yt(t._redirectPersistence)}function NS(t){return Hi(dL,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gL(t,e,n){return mL(t,e,n)}async function mL(t,e,n){if(Fe(t.app))return Promise.reject(st(t));const r=Ve(t);_s(t,e,Ir),await r._initializationPromise;const i=ao(r,n);return await ym(i,r),i._openRedirect(r,e,"signInViaRedirect")}function vL(t,e,n){return yL(t,e,n)}async function yL(t,e,n){const r=Z(t);if(_s(r.auth,e,Ir),Fe(r.auth.app))return Promise.reject(st(r.auth));await r.auth._initializationPromise;const i=ao(r.auth,n);await ym(i,r.auth);const o=await RS(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",o)}function _L(t,e,n){return wL(t,e,n)}async function wL(t,e,n){const r=Z(t);_s(r.auth,e,Ir),await r.auth._initializationPromise;const i=ao(r.auth,n);await fd(!1,r,e.providerId),await ym(i,r.auth);const o=await RS(r);return i._openRedirect(r.auth,e,"linkViaRedirect",o)}async function xL(t,e){return await Ve(t)._initializationPromise,yd(t,e,!1)}async function yd(t,e,n=!1){if(Fe(t.app))return Promise.reject(st(t));const r=Ve(t),i=ao(r,e),s=await new fL(r,i,n).execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}async function RS(t){const e=Tl(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EL=10*60*1e3;class AS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!CL(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!PS(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Ye(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EL&&this.cachedEventUids.clear(),this.cachedEventUids.has(a0(e))}saveEventToCache(e){this.cachedEventUids.add(a0(e)),this.lastProcessedEventTime=Date.now()}}function a0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function PS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function CL(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MS(t,e={}){return Be(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,TL=/^https?/;async function IL(t){if(t.config.emulator)return;const{authorizedDomains:e}=await MS(t);for(const n of e)try{if(kL(n))return}catch{}ht(t,"unauthorized-domain")}function kL(t){const e=Ya(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&s.hostname===r}if(!TL.test(n))return!1;if(SL.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL=new wl(3e4,6e4);function l0(){const t=ze().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function NL(t){return new Promise((e,n)=>{var r,i,o;function s(){l0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{l0(),n(Ye(t,"network-request-failed"))},timeout:bL.get()})}if(!((i=(r=ze().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=ze().gapi)===null||o===void 0)&&o.load)s();else{const a=aS("iframefcb");return ze()[a]=()=>{gapi.load?s():n(Ye(t,"network-request-failed"))},am(`${xM()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Mu=null,e})}let Mu=null;function RL(t){return Mu=Mu||NL(t),Mu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AL=new wl(5e3,15e3),PL="__/auth/iframe",ML="emulator/auth/iframe",DL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},LL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function OL(t){const e=t.config;O(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?sm(e,ML):`https://${t.config.authDomain}/${PL}`,r={apiKey:e.apiKey,appName:t.name,v:_i},i=LL.get(t.config.apiHost);i&&(r.eid=i);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${so(r).slice(1)}`}async function UL(t){const e=await RL(t),n=ze().gapi;return O(n,t,"internal-error"),e.open({where:document.body,url:OL(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:DL,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const s=Ye(t,"network-request-failed"),a=ze().setTimeout(()=>{o(s)},AL.get());function l(){ze().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},VL=500,HL=600,BL="_blank",GL="http://localhost";class u0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zL(t,e,n,r=VL,i=HL){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},FL),{width:r.toString(),height:i.toString(),top:o,left:s}),u=Qe().toLowerCase();n&&(a=tS(u)?BL:n),ZC(u)&&(e=e||GL,l.scrollbars="yes");const f=Object.entries(l).reduce((p,[m,_])=>`${p}${m}=${_},`,"");if(dM(u)&&a!=="_self")return $L(e||"",a),new u0(null);const h=window.open(e||"",a,f);O(h,t,"popup-blocked");try{h.focus()}catch{}return new u0(h)}function $L(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL="__/auth/handler",qL="emulator/auth/handler",JL=encodeURIComponent("fac");async function np(t,e,n,r,i,o){O(t.config.authDomain,t,"auth-domain-config-required"),O(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:_i,eventId:i};if(e instanceof Ir){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",pc(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries(o||{}))s[f]=h}if(e instanceof xs){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(s.scopes=f.join(","))}t.tenantId&&(s.tid=t.tenantId);const a=s;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const l=await t._getAppCheckToken(),u=l?`#${JL}=${encodeURIComponent(l)}`:"";return`${jL(t)}?${so(a).slice(1)}${u}`}function jL({config:t}){return t.emulator?sm(t,qL):`https://${t.authDomain}/${WL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Of="webStorageSupport";class KL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Yi,this._completeRedirectFn=yd,this._overrideRedirectResult=_m}async _openPopup(e,n,r,i){var o;Un((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await np(e,n,r,Ya(),i);return zL(e,s,Tl())}async _openRedirect(e,n,r,i){await this._originValidation(e);const o=await np(e,n,r,Ya(),i);return AD(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:o}=this.eventManagers[n];return i?Promise.resolve(i):(Un(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await UL(e),r=new AS(e);return n.register("authEvent",i=>(O(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Of,{type:Of},i=>{var o;const s=(o=i==null?void 0:i[0])===null||o===void 0?void 0:o[Of];s!==void 0&&n(!!s),ht(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=IL(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return oS()||eS()||El()}}const YL=KL;class QL{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return Yn("unexpected MultiFactorSessionType")}}}class wm extends QL{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new wm(e)}_finalizeEnroll(e,n,r){return SD(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return BD(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class DS{constructor(){}static assertion(e){return wm._fromCredential(e)}}DS.FACTOR_ID="phone";var c0="@firebase/auth",d0="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){O(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZL(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function e2(t){ci(new yn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;O(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:s,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:sS(t)},u=new vM(r,i,o,l);return TM(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ci(new yn("auth-internal",e=>{const n=Ve(e.getProvider("auth").getImmediate());return(r=>new XL(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),An(c0,d0,ZL(t)),An(c0,d0,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2=5*60;aP("authIdTokenMaxAge");function n2(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}yM({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const o=Ye("internal-error");o.customData=i,n(o)},r.type="text/javascript",r.charset="UTF-8",n2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});e2("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r2=2e3;async function i2(t,e,n){var r;const{BuildInfo:i}=Xi();Un(e.sessionId,"AuthEvent did not contain a session ID");const o=await u2(e.sessionId),s={};return El()?s.ibi=i.packageName:xl()?s.apn=i.packageName:ht(t,"operation-not-supported-in-this-environment"),i.displayName&&(s.appDisplayName=i.displayName),s.sessionId=o,np(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,s)}async function o2(t){const{BuildInfo:e}=Xi(),n={};El()?n.iosBundleId=e.packageName:xl()?n.androidPackageName=e.packageName:ht(t,"operation-not-supported-in-this-environment"),await MS(t,n)}function s2(t){const{cordova:e}=Xi();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(t):i=e.InAppBrowser.open(t,cM()?"_blank":"_system","location=yes"),n(i)})})}async function a2(t,e,n){const{cordova:r}=Xi();let i=()=>{};try{await new Promise((o,s)=>{let a=null;function l(){var h;o();const p=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof p=="function"&&p(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function u(){a||(a=window.setTimeout(()=>{s(Ye(t,"redirect-cancelled-by-user"))},r2))}function f(){(document==null?void 0:document.visibilityState)==="visible"&&u()}e.addPassiveListener(l),document.addEventListener("resume",u,!1),xl()&&document.addEventListener("visibilitychange",f,!1),i=()=>{e.removePassiveListener(l),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",f,!1),a&&window.clearTimeout(a)}})}finally{i()}}function l2(t){var e,n,r,i,o,s,a,l,u,f;const h=Xi();O(typeof((e=h==null?void 0:h.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),O(typeof((n=h==null?void 0:h.BuildInfo)===null||n===void 0?void 0:n.packageName)<"u",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),O(typeof((o=(i=(r=h==null?void 0:h.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||o===void 0?void 0:o.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((l=(a=(s=h==null?void 0:h.cordova)===null||s===void 0?void 0:s.plugins)===null||a===void 0?void 0:a.browsertab)===null||l===void 0?void 0:l.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((f=(u=h==null?void 0:h.cordova)===null||u===void 0?void 0:u.InAppBrowser)===null||f===void 0?void 0:f.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function u2(t){const e=c2(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}function c2(t){if(Un(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2=20;class f2 extends AS{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function h2(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:m2(),postBody:null,tenantId:t.tenantId,error:Ye(t,"no-auth-event")}}function p2(t,e){return rp()._set(ip(t),e)}async function f0(t){const e=await rp()._get(ip(t));return e&&await rp()._remove(ip(t)),e}function g2(t,e){var n,r;const i=y2(e);if(i.includes("/__/auth/callback")){const o=Du(i),s=o.firebaseError?v2(decodeURIComponent(o.firebaseError)):null,a=(r=(n=s==null?void 0:s.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],l=a?Ye(a):null;return l?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:l,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:i,postBody:null}}return null}function m2(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<d2;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function rp(){return Yt(pm)}function ip(t){return Hi("authEvent",t.config.apiKey,t.name)}function v2(t){try{return JSON.parse(t)}catch{return null}}function y2(t){const e=Du(t),n=e.link?decodeURIComponent(e.link):void 0,r=Du(n).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Du(i).link||i||r||n||t}function Du(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return Po(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2=500;class w2{constructor(){this._redirectPersistence=Yi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=yd,this._overrideRedirectResult=_m}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new f2(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){ht(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,i){l2(e);const o=await this._initialize(e);await o.initialized(),o.resetRedirect(),pL(),await this._originValidation(e);const s=h2(e,r,i);await p2(e,s);const a=await i2(e,s,n),l=await s2(a);return a2(e,o,l)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=o2(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:i,BuildInfo:o}=Xi(),s=setTimeout(async()=>{await f0(e),n.onEvent(h0())},_2),a=async f=>{clearTimeout(s);const h=await f0(e);let p=null;h&&(f!=null&&f.url)&&(p=g2(h,f.url)),n.onEvent(p||h0())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const l=i,u=`${o.packageName.toLowerCase()}://`;Xi().handleOpenURL=async f=>{if(f.toLowerCase().startsWith(u)&&a({url:f}),typeof l=="function")try{l(f)}catch(h){console.error(h)}}}}const x2=w2;function h0(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Ye("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E2(t,e){Ve(t)._logFramework(e)}var C2="@firebase/auth-compat",S2="0.5.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T2=1e3;function wa(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function I2(){return wa()==="http:"||wa()==="https:"}function LS(t=Qe()){return!!((wa()==="file:"||wa()==="ionic:"||wa()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function k2(){return ad()||kC()}function b2(){return RC()&&(document==null?void 0:document.documentMode)===11}function N2(t=Qe()){return/Edge\/\d+/.test(t)}function R2(t=Qe()){return b2()||N2(t)}function OS(){try{const t=self.localStorage,e=Tl();if(t)return t.setItem(e,"1"),t.removeItem(e),R2()?hc():!0}catch{return xm()&&hc()}return!1}function xm(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Uf(){return(I2()||NC()||LS())&&!k2()&&OS()&&!xm()}function US(){return LS()&&typeof document<"u"}async function A2(){return US()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},T2);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function P2(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt={LOCAL:"local",NONE:"none",SESSION:"session"},$s=O,FS="persistence";function M2(t,e){if($s(Object.values(Jt).includes(e),t,"invalid-persistence-type"),ad()){$s(e!==Jt.SESSION,t,"unsupported-persistence-type");return}if(kC()){$s(e===Jt.NONE,t,"unsupported-persistence-type");return}if(xm()){$s(e===Jt.NONE||e===Jt.LOCAL&&hc(),t,"unsupported-persistence-type");return}$s(e===Jt.NONE||OS(),t,"unsupported-persistence-type")}async function op(t){await t._initializationPromise;const e=VS(),n=Hi(FS,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function D2(t,e){const n=VS();if(!n)return[];const r=Hi(FS,t,e);switch(n.getItem(r)){case Jt.NONE:return[os];case Jt.LOCAL:return[el,Yi];case Jt.SESSION:return[Yi];default:return[]}}function VS(){var t;try{return((t=P2())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2=O;class $r{constructor(){this.browserResolver=Yt(YL),this.cordovaResolver=Yt(x2),this.underlyingResolver=null,this._redirectPersistence=Yi,this._completeRedirectFn=yd,this._overrideRedirectResult=_m}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,i)}async _openRedirect(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,i)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return US()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return L2(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await A2();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HS(t){return t.unwrap()}function O2(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(t){return BS(t)}function F2(t,e){var n;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new V2(t,ED(t,e))}else if(r){const i=BS(e),o=e;i&&(o.credential=i,o.tenantId=r.tenantId||void 0,o.email=r.email||void 0,o.phoneNumber=r.phoneNumber||void 0)}}function BS(t){const{_tokenResponse:e}=t instanceof Gt?t.customData:t;if(!e)return null;if(!(t instanceof Gt)&&"temporaryProof"in e&&"phoneNumber"in e)return Qi.credentialFromResult(t);const n=e.providerId;if(!n||n===zs.PASSWORD)return null;let r;switch(n){case zs.GOOGLE:r=Jn;break;case zs.FACEBOOK:r=qn;break;case zs.GITHUB:r=jn;break;case zs.TWITTER:r=Kn;break;default:const{oauthIdToken:i,oauthAccessToken:o,oauthTokenSecret:s,pendingToken:a,nonce:l}=e;return!o&&!s&&!i&&!a?null:a?n.startsWith("saml.")?ss._create(n,a):tr._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:i,accessToken:o}):new $o(n).credential({idToken:i,accessToken:o,rawNonce:l})}return t instanceof Gt?r.credentialFromError(t):r.credentialFromResult(t)}function Dt(t,e){return e.catch(n=>{throw n instanceof Gt&&F2(t,n),n}).then(n=>{const r=n.operationType,i=n.user;return{operationType:r,credential:U2(n),additionalUserInfo:xD(n),user:cr.getOrCreate(i)}})}async function sp(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>Dt(t,n.confirm(r))}}class V2{constructor(e,n){this.resolver=n,this.auth=O2(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Dt(HS(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this._delegate=e,this.multiFactor=ID(e)}static getOrCreate(e){return cr.USER_MAP.has(e)||cr.USER_MAP.set(e,new cr(e)),cr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Dt(this.auth,gS(this._delegate,e))}async linkWithPhoneNumber(e,n){return sp(this.auth,tL(this._delegate,e,n))}async linkWithPopup(e){return Dt(this.auth,cL(this._delegate,e,$r))}async linkWithRedirect(e){return await op(Ve(this.auth)),_L(this._delegate,e,$r)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Dt(this.auth,mS(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return sp(this.auth,nL(this._delegate,e,n))}reauthenticateWithPopup(e){return Dt(this.auth,uL(this._delegate,e,$r))}async reauthenticateWithRedirect(e){return await op(Ve(this.auth)),vL(this._delegate,e,$r)}sendEmailVerification(e){return cD(this._delegate,e)}async unlink(e){return await YM(this._delegate,e),this}updateEmail(e){return pD(this._delegate,e)}updatePassword(e){return gD(this._delegate,e)}updatePhoneNumber(e){return rL(this._delegate,e)}updateProfile(e){return hD(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return dD(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}cr.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws=O;class ap{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Ws(r,"invalid-api-key",{appName:e.name}),Ws(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?$r:void 0;this._delegate=n.initialize({options:{persistence:H2(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(z1),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?cr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){IM(this._delegate,e,n)}applyActionCode(e){return tD(this._delegate,e)}checkActionCode(e){return vS(this._delegate,e)}confirmPasswordReset(e,n){return eD(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return Dt(this._delegate,rD(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return uD(this._delegate,e)}isSignInWithEmailLink(e){return sD(this._delegate,e)}async getRedirectResult(){Ws(Uf(),this._delegate,"operation-not-supported-in-this-environment");const e=await xL(this._delegate,$r);return e?Dt(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){E2(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:i,error:o,complete:s}=p0(e,n,r);return this._delegate.onAuthStateChanged(i,o,s)}onIdTokenChanged(e,n,r){const{next:i,error:o,complete:s}=p0(e,n,r);return this._delegate.onIdTokenChanged(i,o,s)}sendSignInLinkToEmail(e,n){return oD(this._delegate,e,n)}sendPasswordResetEmail(e,n){return ZM(this._delegate,e,n||void 0)}async setPersistence(e){M2(this._delegate,e);let n;switch(e){case Jt.SESSION:n=Yi;break;case Jt.LOCAL:n=await Yt(el)._isAvailable()?el:pm;break;case Jt.NONE:n=os;break;default:return ht("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Dt(this._delegate,KM(this._delegate))}signInWithCredential(e){return Dt(this._delegate,hd(this._delegate,e))}signInWithCustomToken(e){return Dt(this._delegate,XM(this._delegate,e))}signInWithEmailAndPassword(e,n){return Dt(this._delegate,iD(this._delegate,e,n))}signInWithEmailLink(e,n){return Dt(this._delegate,aD(this._delegate,e,n))}signInWithPhoneNumber(e,n){return sp(this._delegate,eL(this._delegate,e,n))}async signInWithPopup(e){return Ws(Uf(),this._delegate,"operation-not-supported-in-this-environment"),Dt(this._delegate,lL(this._delegate,e,$r))}async signInWithRedirect(e){return Ws(Uf(),this._delegate,"operation-not-supported-in-this-environment"),await op(this._delegate),gL(this._delegate,e,$r)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return nD(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}ap.Persistence=Jt;function p0(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const i=r;return{next:s=>i(s&&cr.getOrCreate(s)),error:e,complete:n}}function H2(t,e){const n=D2(t,e);if(typeof self<"u"&&!n.includes(el)&&n.push(el),typeof window<"u")for(const r of[pm,Yi])n.includes(r)||n.push(r);return n.includes(os)||n.push(os),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(){this.providerId="phone",this._delegate=new Qi(HS(Xt.auth()))}static credential(e,n){return Qi.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}Em.PHONE_SIGN_IN_METHOD=Qi.PHONE_SIGN_IN_METHOD;Em.PROVIDER_ID=Qi.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2=O;class G2{constructor(e,n,r=Xt.app()){var i;B2((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new XD(r.auth(),e,n),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2="auth-compat";function $2(t){t.INTERNAL.registerComponent(new yn(z2,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new ap(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:mo.EMAIL_SIGNIN,PASSWORD_RESET:mo.PASSWORD_RESET,RECOVER_EMAIL:mo.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:mo.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:mo.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:mo.VERIFY_EMAIL}},EmailAuthProvider:wi,FacebookAuthProvider:qn,GithubAuthProvider:jn,GoogleAuthProvider:Jn,OAuthProvider:$o,SAMLAuthProvider:yc,PhoneAuthProvider:Em,PhoneMultiFactorGenerator:DS,RecaptchaVerifier:G2,TwitterAuthProvider:Kn,Auth:ap,AuthCredential:ws,Error:Gt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(C2,S2)}$2(Xt);var g0={};const m0="@firebase/database",v0="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GS="";function zS(t){GS=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),je(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Ja(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return en(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new W2(e)}}catch{}return new q2},Ui=$S("localStorage"),lp=$S("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo=new _l("@firebase/database"),WS=function(){let t=1;return function(){return t++}}(),qS=function(t){const e=xP(t),n=new yP;n.update(e);const r=n.digest();return jg.encodeByteArray(r)},kl=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=kl.apply(null,r):typeof r=="object"?e+=je(r):e+=r,e+=" "}return e};let Gi=null,y0=!0;const JS=function(t,e){U(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(qo.logLevel=ge.VERBOSE,Gi=qo.log.bind(qo),e&&lp.set("logging_enabled",!0)):typeof t=="function"?Gi=t:(Gi=null,lp.remove("logging_enabled"))},it=function(...t){if(y0===!0&&(y0=!1,Gi===null&&lp.get("logging_enabled")===!0&&JS(!0)),Gi){const e=kl.apply(null,t);Gi(e)}},bl=function(t){return function(...e){it(t,...e)}},up=function(...t){const e="FIREBASE INTERNAL ERROR: "+kl(...t);qo.error(e)},nr=function(...t){const e=`FIREBASE FATAL ERROR: ${kl(...t)}`;throw qo.error(e),new Error(e)},wt=function(...t){const e="FIREBASE WARNING: "+kl(...t);qo.warn(e)},J2=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&wt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},_d=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},j2=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},di="[MIN_NAME]",Er="[MAX_NAME]",lo=function(t,e){if(t===e)return 0;if(t===di||e===Er)return-1;if(e===di||t===Er)return 1;{const n=_0(t),r=_0(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},K2=function(t,e){return t===e?0:t<e?-1:1},qs=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+je(e))},Cm=function(t){if(typeof t!="object"||t===null)return je(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=je(e[r]),n+=":",n+=Cm(t[e[r]]);return n+="}",n},jS=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function at(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const KS=function(t){U(!_d(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let i,o,s,a,l;t===0?(o=0,s=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),o=a+r,s=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(o=0,s=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(l=n;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);for(l=e;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);u.push(i?1:0),u.reverse();const f=u.join("");let h="";for(l=0;l<64;l+=8){let p=parseInt(f.substr(l,8),2).toString(16);p.length===1&&(p="0"+p),h=h+p}return h.toLowerCase()},Y2=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Q2=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function X2(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const Z2=new RegExp("^-?(0*)\\d{1,10}$"),eO=-2147483648,tO=2147483647,_0=function(t){if(Z2.test(t)){const e=Number(t);if(e>=eO&&e<=tO)return e}return null},Es=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw wt("Exception was thrown by user callback.",n),e},Math.floor(0))}},nO=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},xa=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){wt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(it("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',wt(e)}}class Jo{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Jo.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm="5",YS="v",QS="s",XS="r",ZS="f",eT=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,tT="ls",nT="p",cp="ac",rT="websocket",iT="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(e,n,r,i,o=!1,s="",a=!1,l=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=s,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ui.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ui.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function oO(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function sT(t,e,n){U(typeof e=="string","typeof type must == string"),U(typeof n=="object","typeof params must == object");let r;if(e===rT)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===iT)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);oO(t)&&(n.ns=t.namespace);const i=[];return at(n,(o,s)=>{i.push(o+"="+s)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(){this.counters_={}}incrementCounter(e,n=1){en(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return nP(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ff={},Vf={};function Tm(t){const e=t.toString();return Ff[e]||(Ff[e]=new sO),Ff[e]}function aO(t,e){const n=t.toString();return Vf[n]||(Vf[n]=e()),Vf[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Es(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w0="start",uO="close",cO="pLPCommand",dO="pRTLPCB",aT="id",lT="pw",uT="ser",fO="cb",hO="seg",pO="ts",gO="d",mO="dframe",cT=1870,dT=30,vO=cT-dT,yO=25e3,_O=3e4;class Wr{constructor(e,n,r,i,o,s,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=s,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=bl(e),this.stats_=Tm(n),this.urlFn=l=>(this.appCheckToken&&(l[cp]=this.appCheckToken),sT(n,iT,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new lO(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(_O)),j2(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Im((...o)=>{const[s,a,l,u,f]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,s===w0)this.id=a,this.password=l;else if(s===uO)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+s)},(...o)=>{const[s,a]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(s,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[w0]="t",r[uT]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[fO]=this.scriptTagHolder.uniqueCallbackIdentifier),r[YS]=Sm,this.transportSessionId&&(r[QS]=this.transportSessionId),this.lastSessionId&&(r[tT]=this.lastSessionId),this.applicationId&&(r[nT]=this.applicationId),this.appCheckToken&&(r[cp]=this.appCheckToken),typeof location<"u"&&location.hostname&&eT.test(location.hostname)&&(r[XS]=ZS);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Wr.forceAllow_=!0}static forceDisallow(){Wr.forceDisallow_=!0}static isAvailable(){return Wr.forceAllow_?!0:!Wr.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Y2()&&!Q2()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=je(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=SC(n),i=jS(r,vO);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[mO]="t",r[aT]=e,r[lT]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=je(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Im{constructor(e,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=WS(),window[cO+this.uniqueCallbackIdentifier]=e,window[dO+this.uniqueCallbackIdentifier]=n,this.myIFrame=Im.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const s="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(a){it("frame writing exception"),a.stack&&it(a.stack),it(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||it("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[aT]=this.myID,e[lT]=this.myPW,e[uT]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+dT+r.length<=cT;){const s=this.pendingSegs.shift();r=r+"&"+hO+i+"="+s.seg+"&"+pO+i+"="+s.ts+"&"+gO+i+"="+s.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(yO)),o=()=>{clearTimeout(i),r()};this.addTag(e,o)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{it("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wO=16384,xO=45e3;let Ec=null;typeof MozWebSocket<"u"?Ec=MozWebSocket:typeof WebSocket<"u"&&(Ec=WebSocket);class un{constructor(e,n,r,i,o,s,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=bl(this.connId),this.stats_=Tm(n),this.connURL=un.connectionURL_(n,s,a,i,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,i,o){const s={};return s[YS]=Sm,typeof location<"u"&&location.hostname&&eT.test(location.hostname)&&(s[XS]=ZS),n&&(s[QS]=n),r&&(s[tT]=r),i&&(s[cp]=i),o&&(s[nT]=o),sT(e,rT,s)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ui.set("previous_websocket_failure",!0);try{let r;dP(),this.mySock=new Ec(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){un.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Ec!==null&&!un.forceDisallow_}static previouslyFailed(){return Ui.isInMemoryStorage||Ui.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ui.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=Ja(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(U(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=je(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=jS(n,wO);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(xO))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}un.responsesRequiredToBeHealthy=2;un.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Wr,un]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=un&&un.isAvailable();let r=n&&!un.previouslyFailed();if(e.webSocketOnly&&(n||wt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[un];else{const i=this.transports_=[];for(const o of as.ALL_TRANSPORTS)o&&o.isAvailable()&&i.push(o);as.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}as.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EO=6e4,CO=5e3,SO=10*1024,TO=100*1024,Hf="t",x0="d",IO="s",E0="r",kO="e",C0="o",S0="a",T0="n",I0="p",bO="h";class NO{constructor(e,n,r,i,o,s,a,l,u,f){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=s,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=bl("c:"+this.id+":"),this.transportManager_=new as(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=xa(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>TO?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>SO?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Hf in e){const n=e[Hf];n===S0?this.upgradeIfSecondaryHealthy_():n===E0?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===C0&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=qs("t",e),r=qs("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:I0,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:S0,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:T0,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=qs("t",e),r=qs("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=qs(Hf,e);if(x0 in e){const r=e[x0];if(n===bO){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===T0){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===IO?this.onConnectionShutdown_(r):n===E0?this.onReset_(r):n===kO?up("Server Error: "+r):n===C0?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):up("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Sm!==r&&wt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),xa(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(EO))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):xa(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(CO))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:I0,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ui.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e){this.allowedEvents_=e,this.listeners_={},U(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let o=0;o<i.length;o++)if(i[o].callback===n&&(!r||r===i[o].context)){i.splice(o,1);return}}validateEventType_(e){U(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc extends hT{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Yg()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Cc}getInitialEvent(e){return U(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0=32,b0=768;class pe{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function ce(){return new pe("")}function te(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function fi(t){return t.pieces_.length-t.pieceNum_}function xe(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new pe(t.pieces_,e)}function km(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function RO(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function tl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function pT(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new pe(e,0)}function Re(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof pe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new pe(n,0)}function ne(t){return t.pieceNum_>=t.pieces_.length}function bt(t,e){const n=te(t),r=te(e);if(n===null)return e;if(n===r)return bt(xe(t),xe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function AO(t,e){const n=tl(t,0),r=tl(e,0);for(let i=0;i<n.length&&i<r.length;i++){const o=lo(n[i],r[i]);if(o!==0)return o}return n.length===r.length?0:n.length<r.length?-1:1}function bm(t,e){if(fi(t)!==fi(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function dn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(fi(t)>fi(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class PO{constructor(e,n){this.errorPrefix_=n,this.parts_=tl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=ld(this.parts_[r]);gT(this)}}function MO(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=ld(e),gT(t)}function DO(t){const e=t.parts_.pop();t.byteLength_-=ld(e),t.parts_.length>0&&(t.byteLength_-=1)}function gT(t){if(t.byteLength_>b0)throw new Error(t.errorPrefix_+"has a key path longer than "+b0+" bytes ("+t.byteLength_+").");if(t.parts_.length>k0)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+k0+") or object contains a cycle "+Ai(t))}function Ai(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm extends hT{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new Nm}getInitialEvent(e){return U(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js=1e3,LO=60*5*1e3,N0=30*1e3,OO=1.3,UO=3e4,FO="server_kill",R0=3;class pr extends fT{constructor(e,n,r,i,o,s,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=o,this.authTokenProvider_=s,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=pr.nextPersistentConnectionId_++,this.log_=bl("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Js,this.maxReconnectDelay_=LO,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Nm.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Cc.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const i=++this.requestNumber_,o={r:i,a:e,b:n};this.log_(je(o)),U(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const n=new Ot,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:s=>{const a=s.d;s.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),n.promise}listen(e,n,r,i){this.initConnection_();const o=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+o),this.listens.has(s)||this.listens.set(s,new Map),U(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),U(!this.listens.get(s).has(o),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:r};this.listens.get(s).set(o,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+r+" for "+i);const o={p:r},s="q";e.tag&&(o.q=n._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(s,o,a=>{const l=a.d,u=a.s;pr.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(u,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&en(e,"w")){const r=Ki(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',o=n._path.toString();wt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||vP(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=N0)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=mP(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,i=>{const o=i.s,s=i.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,s))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),U(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,n)}sendUnlisten_(e,n,r,i){this.log_("Unlisten on "+e+" for "+n);const o={p:e},s="n";i&&(o.q=r,o.t=i),this.sendRequest(s,o)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,i){const o={p:n,d:r};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,s=>{i&&setTimeout(()=>{i(s.s,s.d)},Math.floor(0))})}put(e,n,r,i){this.putInternal("p",e,n,r,i)}merge(e,n,r,i){this.putInternal("m",e,n,r,i)}putInternal(e,n,r,i,o){this.initConnection_();const s={p:n,d:r};o!==void 0&&(s.h=o),this.outstandingPuts_.push({action:e,request:s,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,o=>{this.log_(n+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(o.s,o.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+je(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):up("Unrecognized action received from server: "+je(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){U(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Js,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Js,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>UO&&(this.reconnectDelay_=Js),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*OO)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+pr.nextConnectionId_++,o=this.lastSessionId;let s=!1,a=null;const l=function(){a?a.close():(s=!0,r())},u=function(h){U(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:l,sendRequest:u};const f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,p]=await Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);s?it("getToken() completed but was canceled"):(it("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=p&&p.token,a=new NO(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,m=>{wt(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(FO)},o))}catch(h){this.log_("Failed to get token: "+h),s||(this.repoInfo_.nodeAdmin&&wt(h),l())}}}interrupt(e){it("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){it("Resuming connection for reason: "+e),delete this.interruptReasons_[e],pc(this.interruptReasons_)&&(this.reconnectDelay_=Js,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(o=>Cm(o)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const r=new pe(e).toString();let i;if(this.listens.has(r)){const o=this.listens.get(r);i=o.get(n),o.delete(n),o.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,n){it("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=R0&&(this.reconnectDelay_=N0,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){it("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=R0&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+GS.replace(/\./g,"-")]=1,Yg()?e["framework.cordova"]=1:ad()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Cc.getInstance().currentlyOnline();return pc(this.interruptReasons_)&&e}}pr.nextPersistentConnectionId_=0;pr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new oe(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new oe(di,e),i=new oe(di,n);return this.compare(r,i)!==0}minPost(){return oe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uu;class mT extends wd{static get __EMPTY_NODE(){return uu}static set __EMPTY_NODE(e){uu=e}compare(e,n){return lo(e.name,n.name)}isDefinedOn(e){throw ys("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return oe.MIN}maxPost(){return new oe(Er,uu)}makePost(e,n){return U(typeof e=="string","KeyIndex indexValue must always be a string."),new oe(e,uu)}toString(){return".key"}}const Zn=new mT;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e,n,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=n?r(e.key,n):1,i&&(s*=-1),s<0)this.isReverse_?e=e.left:e=e.right;else if(s===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class rt{constructor(e,n,r,i,o){this.key=e,this.value=n,this.color=r??rt.RED,this.left=i??Ft.EMPTY_NODE,this.right=o??Ft.EMPTY_NODE}copy(e,n,r,i,o){return new rt(e??this.key,n??this.value,r??this.color,i??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const o=r(e,i.key);return o<0?i=i.copy(null,null,null,i.left.insert(e,n,r),null):o===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ft.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,i;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return Ft.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}rt.RED=!0;rt.BLACK=!1;class VO{copy(e,n,r,i,o){return this}insert(e,n,r){return new rt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Ft{constructor(e,n=Ft.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Ft(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,rt.BLACK,null,null))}remove(e){return new Ft(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,rt.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new cu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new cu(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new cu(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new cu(this.root_,null,this.comparator_,!0,e)}}Ft.EMPTY_NODE=new VO;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HO(t,e){return lo(t.name,e.name)}function Rm(t,e){return lo(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dp;function BO(t){dp=t}const vT=function(t){return typeof t=="number"?"number:"+KS(t):"string:"+t},yT=function(t){if(t.isLeafNode()){const e=t.val();U(typeof e=="string"||typeof e=="number"||typeof e=="object"&&en(e,".sv"),"Priority must be a string or number.")}else U(t===dp||t.isEmpty(),"priority of unexpected type.");U(t===dp||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let A0;class Ze{constructor(e,n=Ze.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,U(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),yT(this.priorityNode_)}static set __childrenNodeConstructor(e){A0=e}static get __childrenNodeConstructor(){return A0}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Ze(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Ze.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ne(e)?this:te(e)===".priority"?this.priorityNode_:Ze.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Ze.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=te(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(U(r!==".priority"||fi(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Ze.__childrenNodeConstructor.EMPTY_NODE.updateChild(xe(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+vT(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=KS(this.value_):e+=this.value_,this.lazyHash_=qS(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Ze.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Ze.__childrenNodeConstructor?-1:(U(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,i=Ze.VALUE_TYPE_ORDER.indexOf(n),o=Ze.VALUE_TYPE_ORDER.indexOf(r);return U(i>=0,"Unknown leaf type: "+n),U(o>=0,"Unknown leaf type: "+r),i===o?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Ze.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _T,wT;function GO(t){_T=t}function zO(t){wT=t}class $O extends wd{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),o=r.compareTo(i);return o===0?lo(e.name,n.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return oe.MIN}maxPost(){return new oe(Er,new Ze("[PRIORITY-POST]",wT))}makePost(e,n){const r=_T(e);return new oe(n,new Ze("[PRIORITY-POST]",r))}toString(){return".priority"}}const Ie=new $O;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO=Math.log(2);class qO{constructor(e){const n=o=>parseInt(Math.log(o)/WO,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Sc=function(t,e,n,r){t.sort(e);const i=function(l,u){const f=u-l;let h,p;if(f===0)return null;if(f===1)return h=t[l],p=n?n(h):h,new rt(p,h.node,rt.BLACK,null,null);{const m=parseInt(f/2,10)+l,_=i(l,m),x=i(m+1,u);return h=t[m],p=n?n(h):h,new rt(p,h.node,rt.BLACK,_,x)}},o=function(l){let u=null,f=null,h=t.length;const p=function(_,x){const C=h-_,y=h;h-=_;const w=i(C+1,y),v=t[C],E=n?n(v):v;m(new rt(E,v.node,x,null,w))},m=function(_){u?(u.left=_,u=_):(f=_,u=_)};for(let _=0;_<l.count;++_){const x=l.nextBitIsOne(),C=Math.pow(2,l.count-(_+1));x?p(C,rt.BLACK):(p(C,rt.BLACK),p(C,rt.RED))}return f},s=new qO(t.length),a=o(s);return new Ft(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bf;const vo={};class dr{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return U(vo&&Ie,"ChildrenNode.ts has not been loaded"),Bf=Bf||new dr({".priority":vo},{".priority":Ie}),Bf}get(e){const n=Ki(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Ft?n:null}hasIndex(e){return en(this.indexSet_,e.toString())}addIndex(e,n){U(e!==Zn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const o=n.getIterator(oe.Wrap);let s=o.getNext();for(;s;)i=i||e.isDefinedOn(s.node),r.push(s),s=o.getNext();let a;i?a=Sc(r,e.getCompare()):a=vo;const l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;const f=Object.assign({},this.indexes_);return f[l]=a,new dr(f,u)}addToIndexes(e,n){const r=gc(this.indexes_,(i,o)=>{const s=Ki(this.indexSet_,o);if(U(s,"Missing index implementation for "+o),i===vo)if(s.isDefinedOn(e.node)){const a=[],l=n.getIterator(oe.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),Sc(a,s.getCompare())}else return vo;else{const a=n.get(e.name);let l=i;return a&&(l=l.remove(new oe(e.name,a))),l.insert(e,e.node)}});return new dr(r,this.indexSet_)}removeFromIndexes(e,n){const r=gc(this.indexes_,i=>{if(i===vo)return i;{const o=n.get(e.name);return o?i.remove(new oe(e.name,o)):i}});return new dr(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let js;class j{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&yT(this.priorityNode_),this.children_.isEmpty()&&U(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return js||(js=new j(new Ft(Rm),null,dr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||js}updatePriority(e){return this.children_.isEmpty()?this:new j(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?js:n}}getChild(e){const n=te(e);return n===null?this:this.getImmediateChild(n).getChild(xe(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(U(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new oe(e,n);let i,o;n.isEmpty()?(i=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(r,this.children_));const s=i.isEmpty()?js:this.priorityNode_;return new j(i,s,o)}}updateChild(e,n){const r=te(e);if(r===null)return n;{U(te(e)!==".priority"||fi(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(xe(e),n);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,i=0,o=!0;if(this.forEachChild(Ie,(s,a)=>{n[s]=a.val(e),r++,o&&j.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):o=!1}),!e&&o&&i<2*r){const s=[];for(const a in n)s[a]=n[a];return s}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+vT(this.getPriority().val())+":"),this.forEachChild(Ie,(n,r)=>{const i=r.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":qS(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const i=this.resolveIndex_(r);if(i){const o=i.getPredecessorKey(new oe(e,n));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new oe(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new oe(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,oe.Wrap);let o=i.peek();for(;o!=null&&n.compare(o,e)<0;)i.getNext(),o=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,oe.Wrap);let o=i.peek();for(;o!=null&&n.compare(o,e)>0;)i.getNext(),o=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Nl?-1:0}withIndex(e){if(e===Zn||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new j(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Zn||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(Ie),i=n.getIterator(Ie);let o=r.getNext(),s=i.getNext();for(;o&&s;){if(o.name!==s.name||!o.node.equals(s.node))return!1;o=r.getNext(),s=i.getNext()}return o===null&&s===null}else return!1;else return!1}}resolveIndex_(e){return e===Zn?null:this.indexMap_.get(e.toString())}}j.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class JO extends j{constructor(){super(new Ft(Rm),j.EMPTY_NODE,dr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return j.EMPTY_NODE}isEmpty(){return!1}}const Nl=new JO;Object.defineProperties(oe,{MIN:{value:new oe(di,j.EMPTY_NODE)},MAX:{value:new oe(Er,Nl)}});mT.__EMPTY_NODE=j.EMPTY_NODE;Ze.__childrenNodeConstructor=j;BO(Nl);zO(Nl);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO=!0;function Me(t,e=null){if(t===null)return j.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),U(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Ze(n,Me(e))}if(!(t instanceof Array)&&jO){const n=[];let r=!1;if(at(t,(s,a)=>{if(s.substring(0,1)!=="."){const l=Me(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new oe(s,l)))}}),n.length===0)return j.EMPTY_NODE;const o=Sc(n,HO,s=>s.name,Rm);if(r){const s=Sc(n,Ie.getCompare());return new j(o,Me(e),new dr({".priority":s},{".priority":Ie}))}else return new j(o,Me(e),dr.Default)}else{let n=j.EMPTY_NODE;return at(t,(r,i)=>{if(en(t,r)&&r.substring(0,1)!=="."){const o=Me(i);(o.isLeafNode()||!o.isEmpty())&&(n=n.updateImmediateChild(r,o))}}),n.updatePriority(Me(e))}}GO(Me);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am extends wd{constructor(e){super(),this.indexPath_=e,U(!ne(e)&&te(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),o=r.compareTo(i);return o===0?lo(e.name,n.name):o}makePost(e,n){const r=Me(e),i=j.EMPTY_NODE.updateChild(this.indexPath_,r);return new oe(n,i)}maxPost(){const e=j.EMPTY_NODE.updateChild(this.indexPath_,Nl);return new oe(Er,e)}toString(){return tl(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO extends wd{compare(e,n){const r=e.node.compareTo(n.node);return r===0?lo(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return oe.MIN}maxPost(){return oe.MAX}makePost(e,n){const r=Me(e);return new oe(n,r)}toString(){return".value"}}const Pm=new KO;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xT(t){return{type:"value",snapshotNode:t}}function ls(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function nl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function rl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function YO(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e){this.index_=e}updateChild(e,n,r,i,o,s){U(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(s!=null&&(r.isEmpty()?e.hasChild(n)?s.trackChildChange(nl(n,a)):U(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(ls(n,r)):s.trackChildChange(rl(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ie,(i,o)=>{n.hasChild(i)||r.trackChildChange(nl(i,o))}),n.isLeafNode()||n.forEachChild(Ie,(i,o)=>{if(e.hasChild(i)){const s=e.getImmediateChild(i);s.equals(o)||r.trackChildChange(rl(i,o,s))}else r.trackChildChange(ls(i,o))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?j.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e){this.indexedFilter_=new Mm(e.getIndex()),this.index_=e.getIndex(),this.startPost_=il.getStartPost_(e),this.endPost_=il.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,o,s){return this.matches(new oe(n,r))||(r=j.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,o,s)}updateFullNode(e,n,r){n.isLeafNode()&&(n=j.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(j.EMPTY_NODE);const o=this;return n.forEachChild(Ie,(s,a)=>{o.matches(new oe(s,a))||(i=i.updateImmediateChild(s,j.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new il(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,o,s){return this.rangedFilter_.matches(new oe(n,r))||(r=j.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,o,s):this.fullLimitUpdateChild_(e,n,r,o,s)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=j.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=j.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let s=0;for(;o.hasNext()&&s<this.limit_;){const a=o.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),s++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(j.EMPTY_NODE);let o;this.reverse_?o=i.getReverseIterator(this.index_):o=i.getIterator(this.index_);let s=0;for(;o.hasNext();){const a=o.getNext();s<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?s++:i=i.updateImmediateChild(a.name,j.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,o){let s;if(this.reverse_){const h=this.index_.getCompare();s=(p,m)=>h(m,p)}else s=this.index_.getCompare();const a=e;U(a.numChildren()===this.limit_,"");const l=new oe(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),f=this.rangedFilter_.matches(l);if(a.hasChild(n)){const h=a.getImmediateChild(n);let p=i.getChildAfterChild(this.index_,u,this.reverse_);for(;p!=null&&(p.name===n||a.hasChild(p.name));)p=i.getChildAfterChild(this.index_,p,this.reverse_);const m=p==null?1:s(p,l);if(f&&!r.isEmpty()&&m>=0)return o!=null&&o.trackChildChange(rl(n,r,h)),a.updateImmediateChild(n,r);{o!=null&&o.trackChildChange(nl(n,h));const x=a.updateImmediateChild(n,j.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(o!=null&&o.trackChildChange(ls(p.name,p.node)),x.updateImmediateChild(p.name,p.node)):x}}else return r.isEmpty()?e:f&&s(u,l)>=0?(o!=null&&(o.trackChildChange(nl(u.name,u.node)),o.trackChildChange(ls(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,j.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ie}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return U(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return U(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:di}hasEnd(){return this.endSet_}getIndexEndValue(){return U(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return U(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Er}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return U(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ie}copy(){const e=new xd;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function XO(t){return t.loadsAllData()?new Mm(t.getIndex()):t.hasLimit()?new QO(t):new il(t)}function ZO(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function eU(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function fp(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function tU(t,e,n){let r;return t.index_===Zn||n?r=fp(t,e,n):r=fp(t,e,Er),r.startAfterSet_=!0,r}function hp(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function nU(t,e,n){let r;return t.index_===Zn||n?r=hp(t,e,n):r=hp(t,e,di),r.endBeforeSet_=!0,r}function Ed(t,e){const n=t.copy();return n.index_=e,n}function P0(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Ie?n="$priority":t.index_===Pm?n="$value":t.index_===Zn?n="$key":(U(t.index_ instanceof Am,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=je(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=je(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+je(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=je(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+je(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function M0(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ie&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc extends fT{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=bl("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(U(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const s=Tc.getListenId_(e,r),a={};this.listens_[s]=a;const l=P0(e._queryParams);this.restRequest_(o+".json",l,(u,f)=>{let h=f;if(u===404&&(h=null,u=null),u===null&&this.onDataUpdate_(o,h,!1,r),Ki(this.listens_,s)===a){let p;u?u===401?p="permission_denied":p="rest_error:"+u:p="ok",i(p,null)}})}unlisten(e,n){const r=Tc.getListenId_(e,n);delete this.listens_[r]}get(e){const n=P0(e._queryParams),r=e._path.toString(),i=new Ot;return this.restRequest_(r+".json",n,(o,s)=>{let a=s;o===404&&(a=null,o=null),o===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(n.auth=i.accessToken),o&&o.token&&(n.ac=o.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+so(n);this.log_("Sending REST request for "+s);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Ja(a.responseText)}catch{wt("Failed to parse JSON response for "+s+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&wt("Got unsuccessful REST response for "+s+" Status: "+a.status),r(a.status);r=null}},a.open("GET",s,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rU{constructor(){this.rootNode_=j.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(){return{value:null,children:new Map}}function Cs(t,e,n){if(ne(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=te(e);t.children.has(r)||t.children.set(r,Ic());const i=t.children.get(r);e=xe(e),Cs(i,e,n)}}function pp(t,e){if(ne(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Ie,(r,i)=>{Cs(t,new pe(r),i)}),pp(t,e)}}else if(t.children.size>0){const n=te(e);return e=xe(e),t.children.has(n)&&pp(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function gp(t,e,n){t.value!==null?n(e,t.value):iU(t,(r,i)=>{const o=new pe(e.toString()+"/"+r);gp(i,o,n)})}function iU(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oU{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&at(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D0=10*1e3,sU=30*1e3,aU=5*60*1e3;class lU{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new oU(e);const r=D0+(sU-D0)*Math.random();xa(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;at(e,(i,o)=>{o>0&&en(this.statsToReport_,i)&&(n[i]=o,r=!0)}),r&&this.server_.reportStats(n),xa(this.reportStats_.bind(this),Math.floor(Math.random()*2*aU))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(bn||(bn={}));function Dm(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Lm(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Om(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=bn.ACK_USER_WRITE,this.source=Dm()}operationForChild(e){if(ne(this.path)){if(this.affectedTree.value!=null)return U(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new pe(e));return new kc(ce(),n,this.revert)}}else return U(te(this.path)===e,"operationForChild called for unrelated child."),new kc(xe(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e,n){this.source=e,this.path=n,this.type=bn.LISTEN_COMPLETE}operationForChild(e){return ne(this.path)?new ol(this.source,ce()):new ol(this.source,xe(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=bn.OVERWRITE}operationForChild(e){return ne(this.path)?new Zi(this.source,ce(),this.snap.getImmediateChild(e)):new Zi(this.source,xe(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=bn.MERGE}operationForChild(e){if(ne(this.path)){const n=this.children.subtree(new pe(e));return n.isEmpty()?null:n.value?new Zi(this.source,ce(),n.value):new us(this.source,ce(),n)}else return U(te(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new us(this.source,xe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ne(e))return this.isFullyInitialized()&&!this.filtered_;const n=te(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function cU(t,e,n,r){const i=[],o=[];return e.forEach(s=>{s.type==="child_changed"&&t.index_.indexedValueChanged(s.oldSnap,s.snapshotNode)&&o.push(YO(s.childName,s.snapshotNode))}),Ks(t,i,"child_removed",e,r,n),Ks(t,i,"child_added",e,r,n),Ks(t,i,"child_moved",o,r,n),Ks(t,i,"child_changed",e,r,n),Ks(t,i,"value",e,r,n),i}function Ks(t,e,n,r,i,o){const s=r.filter(a=>a.type===n);s.sort((a,l)=>fU(t,a,l)),s.forEach(a=>{const l=dU(t,a,o);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,t.query_))})})}function dU(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function fU(t,e,n){if(e.childName==null||n.childName==null)throw ys("Should only compare child_ events.");const r=new oe(e.childName,e.snapshotNode),i=new oe(n.childName,n.snapshotNode);return t.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cd(t,e){return{eventCache:t,serverCache:e}}function Ea(t,e,n,r){return Cd(new hi(e,n,r),t.serverCache)}function ET(t,e,n,r){return Cd(t.eventCache,new hi(e,n,r))}function bc(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function eo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gf;const hU=()=>(Gf||(Gf=new Ft(K2)),Gf);class Se{constructor(e,n=hU()){this.value=e,this.children=n}static fromObject(e){let n=new Se(null);return at(e,(r,i)=>{n=n.set(new pe(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ce(),value:this.value};if(ne(e))return null;{const r=te(e),i=this.children.get(r);if(i!==null){const o=i.findRootMostMatchingPathAndValue(xe(e),n);return o!=null?{path:Re(new pe(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ne(e))return this;{const n=te(e),r=this.children.get(n);return r!==null?r.subtree(xe(e)):new Se(null)}}set(e,n){if(ne(e))return new Se(n,this.children);{const r=te(e),o=(this.children.get(r)||new Se(null)).set(xe(e),n),s=this.children.insert(r,o);return new Se(this.value,s)}}remove(e){if(ne(e))return this.children.isEmpty()?new Se(null):new Se(null,this.children);{const n=te(e),r=this.children.get(n);if(r){const i=r.remove(xe(e));let o;return i.isEmpty()?o=this.children.remove(n):o=this.children.insert(n,i),this.value===null&&o.isEmpty()?new Se(null):new Se(this.value,o)}else return this}}get(e){if(ne(e))return this.value;{const n=te(e),r=this.children.get(n);return r?r.get(xe(e)):null}}setTree(e,n){if(ne(e))return n;{const r=te(e),o=(this.children.get(r)||new Se(null)).setTree(xe(e),n);let s;return o.isEmpty()?s=this.children.remove(r):s=this.children.insert(r,o),new Se(this.value,s)}}fold(e){return this.fold_(ce(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(Re(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ce(),n)}findOnPath_(e,n,r){const i=this.value?r(n,this.value):!1;if(i)return i;if(ne(e))return null;{const o=te(e),s=this.children.get(o);return s?s.findOnPath_(xe(e),Re(n,o),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ce(),n)}foreachOnPath_(e,n,r){if(ne(e))return this;{this.value&&r(n,this.value);const i=te(e),o=this.children.get(i);return o?o.foreachOnPath_(xe(e),Re(n,i),r):new Se(null)}}foreach(e){this.foreach_(ce(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Re(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.writeTree_=e}static empty(){return new Pn(new Se(null))}}function Ca(t,e,n){if(ne(e))return new Pn(new Se(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let o=r.value;const s=bt(i,e);return o=o.updateChild(s,n),new Pn(t.writeTree_.set(i,o))}else{const i=new Se(n),o=t.writeTree_.setTree(e,i);return new Pn(o)}}}function mp(t,e,n){let r=t;return at(n,(i,o)=>{r=Ca(r,Re(e,i),o)}),r}function L0(t,e){if(ne(e))return Pn.empty();{const n=t.writeTree_.setTree(e,new Se(null));return new Pn(n)}}function vp(t,e){return uo(t,e)!=null}function uo(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(bt(n.path,e)):null}function O0(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ie,(r,i)=>{e.push(new oe(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new oe(r,i.value))}),e}function ri(t,e){if(ne(e))return t;{const n=uo(t,e);return n!=null?new Pn(new Se(n)):new Pn(t.writeTree_.subtree(e))}}function yp(t){return t.writeTree_.isEmpty()}function cs(t,e){return CT(ce(),t.writeTree_,e)}function CT(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,o)=>{i===".priority"?(U(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):n=CT(Re(t,i),o,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Re(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sd(t,e){return kT(e,t)}function pU(t,e,n,r,i){U(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Ca(t.visibleWrites,e,n)),t.lastWriteId=r}function gU(t,e,n,r){U(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=mp(t.visibleWrites,e,n),t.lastWriteId=r}function mU(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function vU(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);U(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,o=!1,s=t.allWrites.length-1;for(;i&&s>=0;){const a=t.allWrites[s];a.visible&&(s>=n&&yU(a,r.path)?i=!1:dn(r.path,a.path)&&(o=!0)),s--}if(i){if(o)return _U(t),!0;if(r.snap)t.visibleWrites=L0(t.visibleWrites,r.path);else{const a=r.children;at(a,l=>{t.visibleWrites=L0(t.visibleWrites,Re(r.path,l))})}return!0}else return!1}function yU(t,e){if(t.snap)return dn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&dn(Re(t.path,n),e))return!0;return!1}function _U(t){t.visibleWrites=ST(t.allWrites,wU,ce()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function wU(t){return t.visible}function ST(t,e,n){let r=Pn.empty();for(let i=0;i<t.length;++i){const o=t[i];if(e(o)){const s=o.path;let a;if(o.snap)dn(n,s)?(a=bt(n,s),r=Ca(r,a,o.snap)):dn(s,n)&&(a=bt(s,n),r=Ca(r,ce(),o.snap.getChild(a)));else if(o.children){if(dn(n,s))a=bt(n,s),r=mp(r,a,o.children);else if(dn(s,n))if(a=bt(s,n),ne(a))r=mp(r,ce(),o.children);else{const l=Ki(o.children,te(a));if(l){const u=l.getChild(xe(a));r=Ca(r,ce(),u)}}}else throw ys("WriteRecord should have .snap or .children")}}return r}function TT(t,e,n,r,i){if(!r&&!i){const o=uo(t.visibleWrites,e);if(o!=null)return o;{const s=ri(t.visibleWrites,e);if(yp(s))return n;if(n==null&&!vp(s,ce()))return null;{const a=n||j.EMPTY_NODE;return cs(s,a)}}}else{const o=ri(t.visibleWrites,e);if(!i&&yp(o))return n;if(!i&&n==null&&!vp(o,ce()))return null;{const s=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(dn(u.path,e)||dn(e,u.path))},a=ST(t.allWrites,s,e),l=n||j.EMPTY_NODE;return cs(a,l)}}}function xU(t,e,n){let r=j.EMPTY_NODE;const i=uo(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ie,(o,s)=>{r=r.updateImmediateChild(o,s)}),r;if(n){const o=ri(t.visibleWrites,e);return n.forEachChild(Ie,(s,a)=>{const l=cs(ri(o,new pe(s)),a);r=r.updateImmediateChild(s,l)}),O0(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}else{const o=ri(t.visibleWrites,e);return O0(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}}function EU(t,e,n,r,i){U(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=Re(e,n);if(vp(t.visibleWrites,o))return null;{const s=ri(t.visibleWrites,o);return yp(s)?i.getChild(n):cs(s,i.getChild(n))}}function CU(t,e,n,r){const i=Re(e,n),o=uo(t.visibleWrites,i);if(o!=null)return o;if(r.isCompleteForChild(n)){const s=ri(t.visibleWrites,i);return cs(s,r.getNode().getImmediateChild(n))}else return null}function SU(t,e){return uo(t.visibleWrites,e)}function TU(t,e,n,r,i,o,s){let a;const l=ri(t.visibleWrites,e),u=uo(l,ce());if(u!=null)a=u;else if(n!=null)a=cs(l,n);else return[];if(a=a.withIndex(s),!a.isEmpty()&&!a.isLeafNode()){const f=[],h=s.getCompare(),p=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s);let m=p.getNext();for(;m&&f.length<i;)h(m,r)!==0&&f.push(m),m=p.getNext();return f}else return[]}function IU(){return{visibleWrites:Pn.empty(),allWrites:[],lastWriteId:-1}}function Nc(t,e,n,r){return TT(t.writeTree,t.treePath,e,n,r)}function Um(t,e){return xU(t.writeTree,t.treePath,e)}function U0(t,e,n,r){return EU(t.writeTree,t.treePath,e,n,r)}function Rc(t,e){return SU(t.writeTree,Re(t.treePath,e))}function kU(t,e,n,r,i,o){return TU(t.writeTree,t.treePath,e,n,r,i,o)}function Fm(t,e,n){return CU(t.writeTree,t.treePath,e,n)}function IT(t,e){return kT(Re(t.treePath,e),t.writeTree)}function kT(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bU{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;U(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),U(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const o=i.type;if(n==="child_added"&&o==="child_removed")this.changeMap.set(r,rl(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&o==="child_changed")this.changeMap.set(r,nl(r,i.oldSnap));else if(n==="child_changed"&&o==="child_added")this.changeMap.set(r,ls(r,e.snapshotNode));else if(n==="child_changed"&&o==="child_changed")this.changeMap.set(r,rl(r,e.snapshotNode,i.oldSnap));else throw ys("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NU{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const bT=new NU;class Vm{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new hi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Fm(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:eo(this.viewCache_),o=kU(this.writes_,i,n,1,r,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RU(t){return{filter:t}}function AU(t,e){U(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),U(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function PU(t,e,n,r,i){const o=new bU;let s,a;if(n.type===bn.OVERWRITE){const u=n;u.source.fromUser?s=_p(t,e,u.path,u.snap,r,i,o):(U(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!ne(u.path),s=Ac(t,e,u.path,u.snap,r,i,a,o))}else if(n.type===bn.MERGE){const u=n;u.source.fromUser?s=DU(t,e,u.path,u.children,r,i,o):(U(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),s=wp(t,e,u.path,u.children,r,i,a,o))}else if(n.type===bn.ACK_USER_WRITE){const u=n;u.revert?s=UU(t,e,u.path,r,i,o):s=LU(t,e,u.path,u.affectedTree,r,i,o)}else if(n.type===bn.LISTEN_COMPLETE)s=OU(t,e,n.path,r,o);else throw ys("Unknown operation type: "+n.type);const l=o.getChanges();return MU(e,s,l),{viewCache:s,changes:l}}function MU(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=bc(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(xT(bc(e)))}}function NT(t,e,n,r,i,o){const s=e.eventCache;if(Rc(r,n)!=null)return e;{let a,l;if(ne(n))if(U(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=eo(e),f=u instanceof j?u:j.EMPTY_NODE,h=Um(r,f);a=t.filter.updateFullNode(e.eventCache.getNode(),h,o)}else{const u=Nc(r,eo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,o)}else{const u=te(n);if(u===".priority"){U(fi(n)===1,"Can't have a priority with additional path components");const f=s.getNode();l=e.serverCache.getNode();const h=U0(r,n,f,l);h!=null?a=t.filter.updatePriority(f,h):a=s.getNode()}else{const f=xe(n);let h;if(s.isCompleteForChild(u)){l=e.serverCache.getNode();const p=U0(r,n,s.getNode(),l);p!=null?h=s.getNode().getImmediateChild(u).updateChild(f,p):h=s.getNode().getImmediateChild(u)}else h=Fm(r,u,e.serverCache);h!=null?a=t.filter.updateChild(s.getNode(),u,h,f,i,o):a=s.getNode()}}return Ea(e,a,s.isFullyInitialized()||ne(n),t.filter.filtersNodes())}}function Ac(t,e,n,r,i,o,s,a){const l=e.serverCache;let u;const f=s?t.filter:t.filter.getIndexedFilter();if(ne(n))u=f.updateFullNode(l.getNode(),r,null);else if(f.filtersNodes()&&!l.isFiltered()){const m=l.getNode().updateChild(n,r);u=f.updateFullNode(l.getNode(),m,null)}else{const m=te(n);if(!l.isCompleteForPath(n)&&fi(n)>1)return e;const _=xe(n),C=l.getNode().getImmediateChild(m).updateChild(_,r);m===".priority"?u=f.updatePriority(l.getNode(),C):u=f.updateChild(l.getNode(),m,C,_,bT,null)}const h=ET(e,u,l.isFullyInitialized()||ne(n),f.filtersNodes()),p=new Vm(i,h,o);return NT(t,h,n,i,p,a)}function _p(t,e,n,r,i,o,s){const a=e.eventCache;let l,u;const f=new Vm(i,e,o);if(ne(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,s),l=Ea(e,u,!0,t.filter.filtersNodes());else{const h=te(n);if(h===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),l=Ea(e,u,a.isFullyInitialized(),a.isFiltered());else{const p=xe(n),m=a.getNode().getImmediateChild(h);let _;if(ne(p))_=r;else{const x=f.getCompleteChild(h);x!=null?km(p)===".priority"&&x.getChild(pT(p)).isEmpty()?_=x:_=x.updateChild(p,r):_=j.EMPTY_NODE}if(m.equals(_))l=e;else{const x=t.filter.updateChild(a.getNode(),h,_,p,f,s);l=Ea(e,x,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function F0(t,e){return t.eventCache.isCompleteForChild(e)}function DU(t,e,n,r,i,o,s){let a=e;return r.foreach((l,u)=>{const f=Re(n,l);F0(e,te(f))&&(a=_p(t,a,f,u,i,o,s))}),r.foreach((l,u)=>{const f=Re(n,l);F0(e,te(f))||(a=_p(t,a,f,u,i,o,s))}),a}function V0(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function wp(t,e,n,r,i,o,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;ne(n)?u=r:u=new Se(null).setTree(n,r);const f=e.serverCache.getNode();return u.children.inorderTraversal((h,p)=>{if(f.hasChild(h)){const m=e.serverCache.getNode().getImmediateChild(h),_=V0(t,m,p);l=Ac(t,l,new pe(h),_,i,o,s,a)}}),u.children.inorderTraversal((h,p)=>{const m=!e.serverCache.isCompleteForChild(h)&&p.value===null;if(!f.hasChild(h)&&!m){const _=e.serverCache.getNode().getImmediateChild(h),x=V0(t,_,p);l=Ac(t,l,new pe(h),x,i,o,s,a)}}),l}function LU(t,e,n,r,i,o,s){if(Rc(i,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(ne(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Ac(t,e,n,l.getNode().getChild(n),i,o,a,s);if(ne(n)){let u=new Se(null);return l.getNode().forEachChild(Zn,(f,h)=>{u=u.set(new pe(f),h)}),wp(t,e,n,u,i,o,a,s)}else return e}else{let u=new Se(null);return r.foreach((f,h)=>{const p=Re(n,f);l.isCompleteForPath(p)&&(u=u.set(f,l.getNode().getChild(p)))}),wp(t,e,n,u,i,o,a,s)}}function OU(t,e,n,r,i){const o=e.serverCache,s=ET(e,o.getNode(),o.isFullyInitialized()||ne(n),o.isFiltered());return NT(t,s,n,r,bT,i)}function UU(t,e,n,r,i,o){let s;if(Rc(r,n)!=null)return e;{const a=new Vm(r,e,i),l=e.eventCache.getNode();let u;if(ne(n)||te(n)===".priority"){let f;if(e.serverCache.isFullyInitialized())f=Nc(r,eo(e));else{const h=e.serverCache.getNode();U(h instanceof j,"serverChildren would be complete if leaf node"),f=Um(r,h)}f=f,u=t.filter.updateFullNode(l,f,o)}else{const f=te(n);let h=Fm(r,f,e.serverCache);h==null&&e.serverCache.isCompleteForChild(f)&&(h=l.getImmediateChild(f)),h!=null?u=t.filter.updateChild(l,f,h,xe(n),a,o):e.eventCache.getNode().hasChild(f)?u=t.filter.updateChild(l,f,j.EMPTY_NODE,xe(n),a,o):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(s=Nc(r,eo(e)),s.isLeafNode()&&(u=t.filter.updateFullNode(u,s,o)))}return s=e.serverCache.isFullyInitialized()||Rc(r,ce())!=null,Ea(e,u,s,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FU{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new Mm(r.getIndex()),o=XO(r);this.processor_=RU(o);const s=n.serverCache,a=n.eventCache,l=i.updateFullNode(j.EMPTY_NODE,s.getNode(),null),u=o.updateFullNode(j.EMPTY_NODE,a.getNode(),null),f=new hi(l,s.isFullyInitialized(),i.filtersNodes()),h=new hi(u,a.isFullyInitialized(),o.filtersNodes());this.viewCache_=Cd(h,f),this.eventGenerator_=new uU(this.query_)}get query(){return this.query_}}function VU(t){return t.viewCache_.serverCache.getNode()}function HU(t){return bc(t.viewCache_)}function BU(t,e){const n=eo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ne(e)&&!n.getImmediateChild(te(e)).isEmpty())?n.getChild(e):null}function H0(t){return t.eventRegistrations_.length===0}function GU(t,e){t.eventRegistrations_.push(e)}function B0(t,e,n){const r=[];if(n){U(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(o=>{const s=o.createCancelEvent(n,i);s&&r.push(s)})}if(e){let i=[];for(let o=0;o<t.eventRegistrations_.length;++o){const s=t.eventRegistrations_[o];if(!s.matches(e))i.push(s);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(o+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function G0(t,e,n,r){e.type===bn.MERGE&&e.source.queryId!==null&&(U(eo(t.viewCache_),"We should always have a full cache before handling merges"),U(bc(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,o=PU(t.processor_,i,e,n,r);return AU(t.processor_,o.viewCache),U(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=o.viewCache,RT(t,o.changes,o.viewCache.eventCache.getNode(),null)}function zU(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ie,(o,s)=>{r.push(ls(o,s))}),n.isFullyInitialized()&&r.push(xT(n.getNode())),RT(t,r,n.getNode(),e)}function RT(t,e,n,r){const i=r?[r]:t.eventRegistrations_;return cU(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pc;class AT{constructor(){this.views=new Map}}function $U(t){U(!Pc,"__referenceConstructor has already been defined"),Pc=t}function WU(){return U(Pc,"Reference.ts has not been loaded"),Pc}function qU(t){return t.views.size===0}function Hm(t,e,n,r){const i=e.source.queryId;if(i!==null){const o=t.views.get(i);return U(o!=null,"SyncTree gave us an op for an invalid query."),G0(o,e,n,r)}else{let o=[];for(const s of t.views.values())o=o.concat(G0(s,e,n,r));return o}}function PT(t,e,n,r,i){const o=e._queryIdentifier,s=t.views.get(o);if(!s){let a=Nc(n,i?r:null),l=!1;a?l=!0:r instanceof j?(a=Um(n,r),l=!1):(a=j.EMPTY_NODE,l=!1);const u=Cd(new hi(a,l,!1),new hi(r,i,!1));return new FU(e,u)}return s}function JU(t,e,n,r,i,o){const s=PT(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,s),GU(s,n),zU(s,n)}function jU(t,e,n,r){const i=e._queryIdentifier,o=[];let s=[];const a=pi(t);if(i==="default")for(const[l,u]of t.views.entries())s=s.concat(B0(u,n,r)),H0(u)&&(t.views.delete(l),u.query._queryParams.loadsAllData()||o.push(u.query));else{const l=t.views.get(i);l&&(s=s.concat(B0(l,n,r)),H0(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||o.push(l.query)))}return a&&!pi(t)&&o.push(new(WU())(e._repo,e._path)),{removed:o,events:s}}function MT(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function ii(t,e){let n=null;for(const r of t.views.values())n=n||BU(r,e);return n}function DT(t,e){if(e._queryParams.loadsAllData())return Td(t);{const r=e._queryIdentifier;return t.views.get(r)}}function LT(t,e){return DT(t,e)!=null}function pi(t){return Td(t)!=null}function Td(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mc;function KU(t){U(!Mc,"__referenceConstructor has already been defined"),Mc=t}function YU(){return U(Mc,"Reference.ts has not been loaded"),Mc}let QU=1;class z0{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Se(null),this.pendingWriteTree_=IU(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Bm(t,e,n,r,i){return pU(t.pendingWriteTree_,e,n,r,i),i?Ss(t,new Zi(Dm(),e,n)):[]}function XU(t,e,n,r){gU(t.pendingWriteTree_,e,n,r);const i=Se.fromObject(n);return Ss(t,new us(Dm(),e,i))}function qr(t,e,n=!1){const r=mU(t.pendingWriteTree_,e);if(vU(t.pendingWriteTree_,e)){let o=new Se(null);return r.snap!=null?o=o.set(ce(),!0):at(r.children,s=>{o=o.set(new pe(s),!0)}),Ss(t,new kc(r.path,o,n))}else return[]}function Rl(t,e,n){return Ss(t,new Zi(Lm(),e,n))}function ZU(t,e,n){const r=Se.fromObject(n);return Ss(t,new us(Lm(),e,r))}function eF(t,e){return Ss(t,new ol(Lm(),e))}function tF(t,e,n){const r=Gm(t,n);if(r){const i=zm(r),o=i.path,s=i.queryId,a=bt(o,e),l=new ol(Om(s),a);return $m(t,o,l)}else return[]}function Dc(t,e,n,r,i=!1){const o=e._path,s=t.syncPointTree_.get(o);let a=[];if(s&&(e._queryIdentifier==="default"||LT(s,e))){const l=jU(s,e,n,r);qU(s)&&(t.syncPointTree_=t.syncPointTree_.remove(o));const u=l.removed;if(a=l.events,!i){const f=u.findIndex(p=>p._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(o,(p,m)=>pi(m));if(f&&!h){const p=t.syncPointTree_.subtree(o);if(!p.isEmpty()){const m=iF(p);for(let _=0;_<m.length;++_){const x=m[_],C=x.query,y=VT(t,x);t.listenProvider_.startListening(Sa(C),sl(t,C),y.hashFn,y.onComplete)}}}!h&&u.length>0&&!r&&(f?t.listenProvider_.stopListening(Sa(e),null):u.forEach(p=>{const m=t.queryToTagMap.get(kd(p));t.listenProvider_.stopListening(Sa(p),m)}))}oF(t,u)}return a}function OT(t,e,n,r){const i=Gm(t,r);if(i!=null){const o=zm(i),s=o.path,a=o.queryId,l=bt(s,e),u=new Zi(Om(a),l,n);return $m(t,s,u)}else return[]}function nF(t,e,n,r){const i=Gm(t,r);if(i){const o=zm(i),s=o.path,a=o.queryId,l=bt(s,e),u=Se.fromObject(n),f=new us(Om(a),l,u);return $m(t,s,f)}else return[]}function xp(t,e,n,r=!1){const i=e._path;let o=null,s=!1;t.syncPointTree_.foreachOnPath(i,(p,m)=>{const _=bt(p,i);o=o||ii(m,_),s=s||pi(m)});let a=t.syncPointTree_.get(i);a?(s=s||pi(a),o=o||ii(a,ce())):(a=new AT,t.syncPointTree_=t.syncPointTree_.set(i,a));let l;o!=null?l=!0:(l=!1,o=j.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((m,_)=>{const x=ii(_,ce());x&&(o=o.updateImmediateChild(m,x))}));const u=LT(a,e);if(!u&&!e._queryParams.loadsAllData()){const p=kd(e);U(!t.queryToTagMap.has(p),"View does not exist, but we have a tag");const m=sF();t.queryToTagMap.set(p,m),t.tagToQueryMap.set(m,p)}const f=Sd(t.pendingWriteTree_,i);let h=JU(a,e,n,f,o,l);if(!u&&!s&&!r){const p=DT(a,e);h=h.concat(aF(t,e,p))}return h}function Id(t,e,n){const i=t.pendingWriteTree_,o=t.syncPointTree_.findOnPath(e,(s,a)=>{const l=bt(s,e),u=ii(a,l);if(u)return u});return TT(i,e,o,n,!0)}function rF(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(u,f)=>{const h=bt(u,n);r=r||ii(f,h)});let i=t.syncPointTree_.get(n);i?r=r||ii(i,ce()):(i=new AT,t.syncPointTree_=t.syncPointTree_.set(n,i));const o=r!=null,s=o?new hi(r,!0,!1):null,a=Sd(t.pendingWriteTree_,e._path),l=PT(i,e,a,o?s.getNode():j.EMPTY_NODE,o);return HU(l)}function Ss(t,e){return UT(e,t.syncPointTree_,null,Sd(t.pendingWriteTree_,ce()))}function UT(t,e,n,r){if(ne(t.path))return FT(t,e,n,r);{const i=e.get(ce());n==null&&i!=null&&(n=ii(i,ce()));let o=[];const s=te(t.path),a=t.operationForChild(s),l=e.children.get(s);if(l&&a){const u=n?n.getImmediateChild(s):null,f=IT(r,s);o=o.concat(UT(a,l,u,f))}return i&&(o=o.concat(Hm(i,t,r,n))),o}}function FT(t,e,n,r){const i=e.get(ce());n==null&&i!=null&&(n=ii(i,ce()));let o=[];return e.children.inorderTraversal((s,a)=>{const l=n?n.getImmediateChild(s):null,u=IT(r,s),f=t.operationForChild(s);f&&(o=o.concat(FT(f,a,l,u)))}),i&&(o=o.concat(Hm(i,t,r,n))),o}function VT(t,e){const n=e.query,r=sl(t,n);return{hashFn:()=>(VU(e)||j.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?tF(t,n._path,r):eF(t,n._path);{const o=X2(i,n);return Dc(t,n,null,o)}}}}function sl(t,e){const n=kd(e);return t.queryToTagMap.get(n)}function kd(t){return t._path.toString()+"$"+t._queryIdentifier}function Gm(t,e){return t.tagToQueryMap.get(e)}function zm(t){const e=t.indexOf("$");return U(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new pe(t.substr(0,e))}}function $m(t,e,n){const r=t.syncPointTree_.get(e);U(r,"Missing sync point for query tag that we're tracking");const i=Sd(t.pendingWriteTree_,e);return Hm(r,n,i,null)}function iF(t){return t.fold((e,n,r)=>{if(n&&pi(n))return[Td(n)];{let i=[];return n&&(i=MT(n)),at(r,(o,s)=>{i=i.concat(s)}),i}})}function Sa(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(YU())(t._repo,t._path):t}function oF(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=kd(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}function sF(){return QU++}function aF(t,e,n){const r=e._path,i=sl(t,e),o=VT(t,n),s=t.listenProvider_.startListening(Sa(e),i,o.hashFn,o.onComplete),a=t.syncPointTree_.subtree(r);if(i)U(!pi(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((u,f,h)=>{if(!ne(u)&&f&&pi(f))return[Td(f).query];{let p=[];return f&&(p=p.concat(MT(f).map(m=>m.query))),at(h,(m,_)=>{p=p.concat(_)}),p}});for(let u=0;u<l.length;++u){const f=l[u];t.listenProvider_.stopListening(Sa(f),sl(t,f))}}return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Wm(n)}node(){return this.node_}}class qm{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Re(this.path_,e);return new qm(this.syncTree_,n)}node(){return Id(this.syncTree_,this.path_)}}const lF=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},$0=function(t,e,n){if(!t||typeof t!="object")return t;if(U(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return uF(t[".sv"],e,n);if(typeof t[".sv"]=="object")return cF(t[".sv"],e);U(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},uF=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:U(!1,"Unexpected server value: "+t)}},cF=function(t,e,n){t.hasOwnProperty("increment")||U(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&U(!1,"Unexpected increment value: "+r);const i=e.node();if(U(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return typeof s!="number"?r:s+r},HT=function(t,e,n,r){return jm(e,new qm(n,t),r)},Jm=function(t,e,n){return jm(t,new Wm(e),n)};function jm(t,e,n){const r=t.getPriority().val(),i=$0(r,e.getImmediateChild(".priority"),n);let o;if(t.isLeafNode()){const s=t,a=$0(s.getValue(),e,n);return a!==s.getValue()||i!==s.getPriority().val()?new Ze(a,Me(i)):t}else{const s=t;return o=s,i!==s.getPriority().val()&&(o=o.updatePriority(new Ze(i))),s.forEachChild(Ie,(a,l)=>{const u=jm(l,e.getImmediateChild(a),n);u!==l&&(o=o.updateImmediateChild(a,u))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function bd(t,e){let n=e instanceof pe?e:new pe(e),r=t,i=te(n);for(;i!==null;){const o=Ki(r.node.children,i)||{children:{},childCount:0};r=new Km(i,r,o),n=xe(n),i=te(n)}return r}function co(t){return t.node.value}function Ym(t,e){t.node.value=e,Ep(t)}function BT(t){return t.node.childCount>0}function dF(t){return co(t)===void 0&&!BT(t)}function Nd(t,e){at(t.node.children,(n,r)=>{e(new Km(n,t,r))})}function GT(t,e,n,r){n&&e(t),Nd(t,i=>{GT(i,e,!0)})}function fF(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Al(t){return new pe(t.parent===null?t.name:Al(t.parent)+"/"+t.name)}function Ep(t){t.parent!==null&&hF(t.parent,t.name,t)}function hF(t,e,n){const r=dF(n),i=en(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Ep(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,Ep(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pF=/[\[\].#$\/\u0000-\u001F\u007F]/,gF=/[\[\].#$\u0000-\u001F\u007F]/,zf=10*1024*1024,Rd=function(t){return typeof t=="string"&&t.length!==0&&!pF.test(t)},zT=function(t){return typeof t=="string"&&t.length!==0&&!gF.test(t)},mF=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),zT(t)},al=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!_d(t)||t&&typeof t=="object"&&en(t,".sv")},rr=function(t,e,n,r){r&&e===void 0||Pl(zt(t,"value"),e,n)},Pl=function(t,e,n){const r=n instanceof pe?new PO(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Ai(r));if(typeof e=="function")throw new Error(t+"contains a function "+Ai(r)+" with contents = "+e.toString());if(_d(e))throw new Error(t+"contains "+e.toString()+" "+Ai(r));if(typeof e=="string"&&e.length>zf/3&&ld(e)>zf)throw new Error(t+"contains a string greater than "+zf+" utf8 bytes "+Ai(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,o=!1;if(at(e,(s,a)=>{if(s===".value")i=!0;else if(s!==".priority"&&s!==".sv"&&(o=!0,!Rd(s)))throw new Error(t+" contains an invalid key ("+s+") "+Ai(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);MO(r,s),Pl(t,a,r),DO(r)}),i&&o)throw new Error(t+' contains ".value" child '+Ai(r)+" in addition to actual children.")}},vF=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const o=tl(r);for(let s=0;s<o.length;s++)if(!(o[s]===".priority"&&s===o.length-1)){if(!Rd(o[s]))throw new Error(t+"contains an invalid key ("+o[s]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(AO);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&dn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},$T=function(t,e,n,r){const i=zt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const o=[];at(e,(s,a)=>{const l=new pe(s);if(Pl(i,a,Re(n,l)),km(l)===".priority"&&!al(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(l)}),vF(i,o)},Qm=function(t,e,n){if(_d(e))throw new Error(zt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!al(e))throw new Error(zt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Ml=function(t,e,n,r){if(n!==void 0&&!Rd(n))throw new Error(zt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},ll=function(t,e,n,r){if(!zT(n))throw new Error(zt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},yF=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ll(t,e,n)},fn=function(t,e){if(te(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},WT=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Rd(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!mF(n))throw new Error(zt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _F{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Ad(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],o=i.getPath();n!==null&&!bm(o,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function qT(t,e,n){Ad(t,n),JT(t,r=>bm(r,e))}function tn(t,e,n){Ad(t,n),JT(t,r=>dn(r,e)||dn(e,r))}function JT(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];if(i){const o=i.path;e(o)?(wF(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function wF(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();Gi&&it("event: "+n.toString()),Es(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT="repo_interrupt",xF=25;class EF{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new _F,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ic(),this.transactionQueueTree_=new Km,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function CF(t,e,n){if(t.stats_=Tm(t.repoInfo_),t.forceRestClient_||nO())t.server_=new Tc(t.repoInfo_,(r,i,o,s)=>{W0(t,r,i,o,s)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>q0(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{je(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new pr(t.repoInfo_,e,(r,i,o,s)=>{W0(t,r,i,o,s)},r=>{q0(t,r)},r=>{SF(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=aO(t.repoInfo_,()=>new lU(t.stats_,t.server_)),t.infoData_=new rU,t.infoSyncTree_=new z0({startListening:(r,i,o,s)=>{let a=[];const l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=Rl(t.infoSyncTree_,r._path,l),setTimeout(()=>{s("ok")},0)),a},stopListening:()=>{}}),Xm(t,"connected",!1),t.serverSyncTree_=new z0({startListening:(r,i,o,s)=>(t.server_.listen(r,o,i,(a,l)=>{const u=s(a,l);tn(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function KT(t){const n=t.infoData_.getNode(new pe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Dl(t){return lF({timestamp:KT(t)})}function W0(t,e,n,r,i){t.dataUpdateCount++;const o=new pe(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let s=[];if(i)if(r){const l=gc(n,u=>Me(u));s=nF(t.serverSyncTree_,o,l,i)}else{const l=Me(n);s=OT(t.serverSyncTree_,o,l,i)}else if(r){const l=gc(n,u=>Me(u));s=ZU(t.serverSyncTree_,o,l)}else{const l=Me(n);s=Rl(t.serverSyncTree_,o,l)}let a=o;s.length>0&&(a=ds(t,o)),tn(t.eventQueue_,a,s)}function q0(t,e){Xm(t,"connected",e),e===!1&&kF(t)}function SF(t,e){at(e,(n,r)=>{Xm(t,n,r)})}function Xm(t,e,n){const r=new pe("/.info/"+e),i=Me(n);t.infoData_.updateSnapshot(r,i);const o=Rl(t.infoSyncTree_,r,i);tn(t.eventQueue_,r,o)}function Pd(t){return t.nextWriteId_++}function TF(t,e,n){const r=rF(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{const o=Me(i).withIndex(e._queryParams.getIndex());xp(t.serverSyncTree_,e,n,!0);let s;if(e._queryParams.loadsAllData())s=Rl(t.serverSyncTree_,e._path,o);else{const a=sl(t.serverSyncTree_,e);s=OT(t.serverSyncTree_,e._path,o,a)}return tn(t.eventQueue_,e._path,s),Dc(t.serverSyncTree_,e,n,null,!0),o},i=>(Ts(t,"get for query "+je(e)+" failed: "+i),Promise.reject(new Error(i))))}function Zm(t,e,n,r,i){Ts(t,"set",{path:e.toString(),value:n,priority:r});const o=Dl(t),s=Me(n,r),a=Id(t.serverSyncTree_,e),l=Jm(s,a,o),u=Pd(t),f=Bm(t.serverSyncTree_,e,l,u,!0);Ad(t.eventQueue_,f),t.server_.put(e.toString(),s.val(!0),(p,m)=>{const _=p==="ok";_||wt("set at "+e+" failed: "+p);const x=qr(t.serverSyncTree_,u,!_);tn(t.eventQueue_,e,x),gi(t,i,p,m)});const h=tv(t,e);ds(t,h),tn(t.eventQueue_,h,[])}function IF(t,e,n,r){Ts(t,"update",{path:e.toString(),value:n});let i=!0;const o=Dl(t),s={};if(at(n,(a,l)=>{i=!1,s[a]=HT(Re(e,a),Me(l),t.serverSyncTree_,o)}),i)it("update() called with empty data.  Don't do anything."),gi(t,r,"ok",void 0);else{const a=Pd(t),l=XU(t.serverSyncTree_,e,s,a);Ad(t.eventQueue_,l),t.server_.merge(e.toString(),n,(u,f)=>{const h=u==="ok";h||wt("update at "+e+" failed: "+u);const p=qr(t.serverSyncTree_,a,!h),m=p.length>0?ds(t,e):e;tn(t.eventQueue_,m,p),gi(t,r,u,f)}),at(n,u=>{const f=tv(t,Re(e,u));ds(t,f)}),tn(t.eventQueue_,e,[])}}function kF(t){Ts(t,"onDisconnectEvents");const e=Dl(t),n=Ic();gp(t.onDisconnect_,ce(),(i,o)=>{const s=HT(i,o,t.serverSyncTree_,e);Cs(n,i,s)});let r=[];gp(n,ce(),(i,o)=>{r=r.concat(Rl(t.serverSyncTree_,i,o));const s=tv(t,i);ds(t,s)}),t.onDisconnect_=Ic(),tn(t.eventQueue_,ce(),r)}function bF(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&pp(t.onDisconnect_,e),gi(t,n,r,i)})}function J0(t,e,n,r){const i=Me(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(o,s)=>{o==="ok"&&Cs(t.onDisconnect_,e,i),gi(t,r,o,s)})}function NF(t,e,n,r,i){const o=Me(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(s,a)=>{s==="ok"&&Cs(t.onDisconnect_,e,o),gi(t,i,s,a)})}function RF(t,e,n,r){if(pc(n)){it("onDisconnect().update() called with empty data.  Don't do anything."),gi(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,o)=>{i==="ok"&&at(n,(s,a)=>{const l=Me(a);Cs(t.onDisconnect_,Re(e,s),l)}),gi(t,r,i,o)})}function AF(t,e,n){let r;te(e._path)===".info"?r=xp(t.infoSyncTree_,e,n):r=xp(t.serverSyncTree_,e,n),qT(t.eventQueue_,e._path,r)}function Cp(t,e,n){let r;te(e._path)===".info"?r=Dc(t.infoSyncTree_,e,n):r=Dc(t.serverSyncTree_,e,n),qT(t.eventQueue_,e._path,r)}function YT(t){t.persistentConnection_&&t.persistentConnection_.interrupt(jT)}function PF(t){t.persistentConnection_&&t.persistentConnection_.resume(jT)}function Ts(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),it(n,...e)}function gi(t,e,n,r){e&&Es(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let o=i;r&&(o+=": "+r);const s=new Error(o);s.code=i,e(s)}})}function MF(t,e,n,r,i,o){Ts(t,"transaction on "+e);const s={path:e,update:n,onComplete:r,status:null,order:WS(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=ev(t,e,void 0);s.currentInputSnapshot=a;const l=s.update(a.val());if(l===void 0)s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&s.onComplete(null,!1,s.currentInputSnapshot);else{Pl("transaction failed: Data returned ",l,s.path),s.status=0;const u=bd(t.transactionQueueTree_,e),f=co(u)||[];f.push(s),Ym(u,f);let h;typeof l=="object"&&l!==null&&en(l,".priority")?(h=Ki(l,".priority"),U(al(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Id(t.serverSyncTree_,e)||j.EMPTY_NODE).getPriority().val();const p=Dl(t),m=Me(l,h),_=Jm(m,a,p);s.currentOutputSnapshotRaw=m,s.currentOutputSnapshotResolved=_,s.currentWriteId=Pd(t);const x=Bm(t.serverSyncTree_,e,_,s.currentWriteId,s.applyLocally);tn(t.eventQueue_,e,x),Md(t,t.transactionQueueTree_)}}function ev(t,e,n){return Id(t.serverSyncTree_,e,n)||j.EMPTY_NODE}function Md(t,e=t.transactionQueueTree_){if(e||Dd(t,e),co(e)){const n=XT(t,e);U(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&DF(t,Al(e),n)}else BT(e)&&Nd(e,n=>{Md(t,n)})}function DF(t,e,n){const r=n.map(u=>u.currentWriteId),i=ev(t,e,r);let o=i;const s=i.hash();for(let u=0;u<n.length;u++){const f=n[u];U(f.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;const h=bt(e,f.path);o=o.updateChild(h,f.currentOutputSnapshotRaw)}const a=o.val(!0),l=e;t.server_.put(l.toString(),a,u=>{Ts(t,"transaction put response",{path:l.toString(),status:u});let f=[];if(u==="ok"){const h=[];for(let p=0;p<n.length;p++)n[p].status=2,f=f.concat(qr(t.serverSyncTree_,n[p].currentWriteId)),n[p].onComplete&&h.push(()=>n[p].onComplete(null,!0,n[p].currentOutputSnapshotResolved)),n[p].unwatcher();Dd(t,bd(t.transactionQueueTree_,e)),Md(t,t.transactionQueueTree_),tn(t.eventQueue_,e,f);for(let p=0;p<h.length;p++)Es(h[p])}else{if(u==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{wt("transaction at "+l.toString()+" failed: "+u);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=u}ds(t,e)}},s)}function ds(t,e){const n=QT(t,e),r=Al(n),i=XT(t,n);return LF(t,i,r),r}function LF(t,e,n){if(e.length===0)return;const r=[];let i=[];const s=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=bt(n,l.path);let f=!1,h;if(U(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)f=!0,h=l.abortReason,i=i.concat(qr(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=xF)f=!0,h="maxretry",i=i.concat(qr(t.serverSyncTree_,l.currentWriteId,!0));else{const p=ev(t,l.path,s);l.currentInputSnapshot=p;const m=e[a].update(p.val());if(m!==void 0){Pl("transaction failed: Data returned ",m,l.path);let _=Me(m);typeof m=="object"&&m!=null&&en(m,".priority")||(_=_.updatePriority(p.getPriority()));const C=l.currentWriteId,y=Dl(t),w=Jm(_,p,y);l.currentOutputSnapshotRaw=_,l.currentOutputSnapshotResolved=w,l.currentWriteId=Pd(t),s.splice(s.indexOf(C),1),i=i.concat(Bm(t.serverSyncTree_,l.path,w,l.currentWriteId,l.applyLocally)),i=i.concat(qr(t.serverSyncTree_,C,!0))}else f=!0,h="nodata",i=i.concat(qr(t.serverSyncTree_,l.currentWriteId,!0))}tn(t.eventQueue_,n,i),i=[],f&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}Dd(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Es(r[a]);Md(t,t.transactionQueueTree_)}function QT(t,e){let n,r=t.transactionQueueTree_;for(n=te(e);n!==null&&co(r)===void 0;)r=bd(r,n),e=xe(e),n=te(e);return r}function XT(t,e){const n=[];return ZT(t,e,n),n.sort((r,i)=>r.order-i.order),n}function ZT(t,e,n){const r=co(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Nd(e,i=>{ZT(t,i,n)})}function Dd(t,e){const n=co(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,Ym(e,n.length>0?n:void 0)}Nd(e,r=>{Dd(t,r)})}function tv(t,e){const n=Al(QT(t,e)),r=bd(t.transactionQueueTree_,e);return fF(r,i=>{$f(t,i)}),$f(t,r),GT(r,i=>{$f(t,i)}),n}function $f(t,e){const n=co(e);if(n){const r=[];let i=[],o=-1;for(let s=0;s<n.length;s++)n[s].status===3||(n[s].status===1?(U(o===s-1,"All SENT items should be at beginning of queue."),o=s,n[s].status=3,n[s].abortReason="set"):(U(n[s].status===0,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat(qr(t.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));o===-1?Ym(e,void 0):n.length=o+1,tn(t.eventQueue_,Al(e),i);for(let s=0;s<r.length;s++)Es(r[s])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OF(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function UF(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):wt(`Invalid query segment '${n}' in query '${t}'`)}return e}const Sp=function(t,e){const n=FF(t),r=n.namespace;n.domain==="firebase.com"&&nr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&nr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||J2();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new oT(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new pe(n.pathString)}},FF=function(t){let e="",n="",r="",i="",o="",s=!0,a="https",l=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let f=t.indexOf("/");f===-1&&(f=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(f,h)),f<h&&(i=OF(t.substring(f,h)));const p=UF(t.substring(Math.min(t.length,h)));u=e.indexOf(":"),u>=0?(s=a==="https"||a==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;const m=e.slice(0,u);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{const _=e.indexOf(".");r=e.substring(0,_).toLowerCase(),n=e.substring(_+1),o=r}"ns"in p&&(o=p.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j0="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",VF=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let i;const o=new Array(8);for(i=7;i>=0;i--)o[i]=j0.charAt(n%64),n=Math.floor(n/64);U(n===0,"Cannot push at time == 0");let s=o.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)s+=j0.charAt(e[i]);return U(s.length===20,"nextPushId: Length should be 20."),s}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+je(this.snapshot.exportVal())}}class tI{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return U(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let HF=class{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Ot;return bF(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){fn("OnDisconnect.remove",this._path);const e=new Ot;return J0(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){fn("OnDisconnect.set",this._path),rr("OnDisconnect.set",e,this._path,!1);const n=new Ot;return J0(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){fn("OnDisconnect.setWithPriority",this._path),rr("OnDisconnect.setWithPriority",e,this._path,!1),Qm("OnDisconnect.setWithPriority",n);const r=new Ot;return NF(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){fn("OnDisconnect.update",this._path),$T("OnDisconnect.update",e,this._path);const n=new Ot;return RF(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ne(this._path)?null:km(this._path)}get ref(){return new xn(this._repo,this._path)}get _queryIdentifier(){const e=M0(this._queryParams),n=Cm(e);return n==="{}"?"default":n}get _queryObject(){return M0(this._queryParams)}isEqual(e){if(e=Z(e),!(e instanceof Wt))return!1;const n=this._repo===e._repo,r=bm(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+RO(this._path)}}function Ld(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function xi(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Zn){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==di)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Er)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Ie){if(e!=null&&!al(e)||n!=null&&!al(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(U(t.getIndex()instanceof Am||t.getIndex()===Pm,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Od(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class xn extends Wt{constructor(e,n){super(e,n,new xd,!1)}get parent(){const e=pT(this._path);return e===null?null:new xn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let Ud=class Tp{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new pe(e),r=to(this.ref,e);return new Tp(this._node.getChild(n),r,Ie)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new Tp(i,to(this.ref,r),Ie)))}hasChild(e){const n=new pe(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function nI(t,e){return t=Z(t),t._checkNotDeleted("ref"),e!==void 0?to(t._root,e):t._root}function K0(t,e){t=Z(t),t._checkNotDeleted("refFromURL");const n=Sp(e,t._repo.repoInfo_.nodeAdmin);WT("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&nr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),nI(t,n.path.toString())}function to(t,e){return t=Z(t),te(t._path)===null?yF("child","path",e):ll("child","path",e),new xn(t._repo,Re(t._path,e))}function BF(t,e){t=Z(t),fn("push",t._path),rr("push",e,t._path,!0);const n=KT(t._repo),r=VF(n),i=to(t,r),o=to(t,r);let s;return e!=null?s=rv(o,e).then(()=>o):s=Promise.resolve(o),i.then=s.then.bind(s),i.catch=s.then.bind(s,void 0),i}function GF(t){return fn("remove",t._path),rv(t,null)}function rv(t,e){t=Z(t),fn("set",t._path),rr("set",e,t._path,!1);const n=new Ot;return Zm(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function zF(t,e){t=Z(t),fn("setPriority",t._path),Qm("setPriority",e);const n=new Ot;return Zm(t._repo,Re(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function $F(t,e,n){if(fn("setWithPriority",t._path),rr("setWithPriority",e,t._path,!1),Qm("setWithPriority",n),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new Ot;return Zm(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function WF(t,e){$T("update",e,t._path);const n=new Ot;return IF(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function qF(t){t=Z(t);const e=new nv(()=>{}),n=new Ll(e);return TF(t._repo,t,n).then(r=>new Ud(r,new xn(t._repo,t._path),t._queryParams.getIndex()))}class Ll{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new eI("value",this,new Ud(e.snapshotNode,new xn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new tI(this,e,n):null}matches(e){return e instanceof Ll?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Fd{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new tI(this,e,n):null}createEvent(e,n){U(e.childName!=null,"Child events should have a childName.");const r=to(new xn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new eI(e.type,this,new Ud(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Fd?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Ol(t,e,n,r,i){let o;if(typeof r=="object"&&(o=void 0,i=r),typeof r=="function"&&(o=r),i&&i.onlyOnce){const l=n,u=(f,h)=>{Cp(t._repo,t,a),l(f,h)};u.userCallback=n.userCallback,u.context=n.context,n=u}const s=new nv(n,o||void 0),a=e==="value"?new Ll(s):new Fd(e,s);return AF(t._repo,t,a),()=>Cp(t._repo,t,a)}function Ip(t,e,n,r){return Ol(t,"value",e,n,r)}function Y0(t,e,n,r){return Ol(t,"child_added",e,n,r)}function Q0(t,e,n,r){return Ol(t,"child_changed",e,n,r)}function X0(t,e,n,r){return Ol(t,"child_moved",e,n,r)}function Z0(t,e,n,r){return Ol(t,"child_removed",e,n,r)}function e_(t,e,n){let r=null;const i=n?new nv(n):null;e==="value"?r=new Ll(i):e&&(r=new Fd(e,i)),Cp(t._repo,t,r)}class Fn{}class rI extends Fn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){rr("endAt",this._value,e._path,!0);const n=hp(e._queryParams,this._value,this._key);if(Od(n),xi(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Wt(e._repo,e._path,n,e._orderByCalled)}}function JF(t,e){return Ml("endAt","key",e),new rI(t,e)}class jF extends Fn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){rr("endBefore",this._value,e._path,!1);const n=nU(e._queryParams,this._value,this._key);if(Od(n),xi(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Wt(e._repo,e._path,n,e._orderByCalled)}}function KF(t,e){return Ml("endBefore","key",e),new jF(t,e)}class iI extends Fn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){rr("startAt",this._value,e._path,!0);const n=fp(e._queryParams,this._value,this._key);if(Od(n),xi(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Wt(e._repo,e._path,n,e._orderByCalled)}}function YF(t=null,e){return Ml("startAt","key",e),new iI(t,e)}class QF extends Fn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){rr("startAfter",this._value,e._path,!1);const n=tU(e._queryParams,this._value,this._key);if(Od(n),xi(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Wt(e._repo,e._path,n,e._orderByCalled)}}function XF(t,e){return Ml("startAfter","key",e),new QF(t,e)}class ZF extends Fn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Wt(e._repo,e._path,ZO(e._queryParams,this._limit),e._orderByCalled)}}function e4(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new ZF(t)}class t4 extends Fn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Wt(e._repo,e._path,eU(e._queryParams,this._limit),e._orderByCalled)}}function n4(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new t4(t)}class r4 extends Fn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Ld(e,"orderByChild");const n=new pe(this._path);if(ne(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new Am(n),i=Ed(e._queryParams,r);return xi(i),new Wt(e._repo,e._path,i,!0)}}function i4(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return ll("orderByChild","path",t),new r4(t)}class o4 extends Fn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Ld(e,"orderByKey");const n=Ed(e._queryParams,Zn);return xi(n),new Wt(e._repo,e._path,n,!0)}}function s4(){return new o4}class a4 extends Fn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Ld(e,"orderByPriority");const n=Ed(e._queryParams,Ie);return xi(n),new Wt(e._repo,e._path,n,!0)}}function l4(){return new a4}class u4 extends Fn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Ld(e,"orderByValue");const n=Ed(e._queryParams,Pm);return xi(n),new Wt(e._repo,e._path,n,!0)}}function c4(){return new u4}class d4 extends Fn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(rr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new rI(this._value,this._key)._apply(new iI(this._value,this._key)._apply(e))}}function f4(t,e){return Ml("equalTo","key",e),new d4(t,e)}function Sn(t,...e){let n=Z(t);for(const r of e)n=r._apply(n);return n}$U(xn);KU(xn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4="FIREBASE_DATABASE_EMULATOR_HOST",kp={};let p4=!1;function g4(t,e,n,r){t.repoInfo_=new oT(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function oI(t,e,n,r,i){let o=r||t.options.databaseURL;o===void 0&&(t.options.projectId||nr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),it("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let s=Sp(o,i),a=s.repoInfo,l,u;typeof process<"u"&&g0&&(u=g0[h4]),u?(l=!0,o=`http://${u}?ns=${a.namespace}`,s=Sp(o,i),a=s.repoInfo):l=!s.repoInfo.secure;const f=i&&l?new Jo(Jo.OWNER):new iO(t.name,t.options,e);WT("Invalid Firebase Database URL",s),ne(s.path)||nr("Database URL must point to the root of a Firebase Database (not including a child path).");const h=v4(a,t,f,new rO(t.name,n));return new y4(h,t)}function m4(t,e){const n=kp[e];(!n||n[t.key]!==t)&&nr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),YT(t),delete n[t.key]}function v4(t,e,n,r){let i=kp[e.name];i||(i={},kp[e.name]=i);let o=i[t.toURLString()];return o&&nr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new EF(t,p4,n,r),i[t.toURLString()]=o,o}let y4=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(CF(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new xn(this._repo,ce())),this._rootInternal}_delete(){return this._rootInternal!==null&&(m4(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&nr("Cannot call "+e+" on a deleted database.")}};function sI(){as.IS_TRANSPORT_INITIALIZED&&wt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function _4(){sI(),Wr.forceDisallow()}function w4(){sI(),un.forceDisallow(),Wr.forceAllow()}function x4(t,e,n,r={}){t=Z(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&nr("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&nr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Jo(Jo.OWNER);else if(r.mockUserToken){const s=typeof r.mockUserToken=="string"?r.mockUserToken:lP(r.mockUserToken,t.app.options.projectId);o=new Jo(s)}g4(i,e,n,o)}function E4(t){t=Z(t),t._checkNotDeleted("goOffline"),YT(t._repo)}function C4(t){t=Z(t),t._checkNotDeleted("goOnline"),PF(t._repo)}function S4(t,e){JS(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(t){zS(_i),ci(new yn("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return oI(r,i,o,n)},"PUBLIC").setMultipleInstances(!0)),An(m0,v0,t),An(m0,v0,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4={".sv":"timestamp"};function k4(){return I4}function b4(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let N4=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function R4(t,e,n){var r;if(t=Z(t),fn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=(r=n==null?void 0:n.applyLocally)!==null&&r!==void 0?r:!0,o=new Ot,s=(l,u,f)=>{let h=null;l?o.reject(l):(h=new Ud(f,new xn(t._repo,t._path),Ie),o.resolve(new N4(u,h)))},a=Ip(t,()=>{});return MF(t._repo,t._path,e,s,a,i),o.promise}pr.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};pr.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};T4();const A4="@firebase/database-compat",P4="1.0.8";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4=new _l("@firebase/database-compat"),aI=function(t){const e="FIREBASE WARNING: "+t;M4.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4=function(t,e,n,r){if(n!==void 0&&typeof n!="boolean")throw new Error(zt(t,e)+"must be a boolean.")},L4=function(t,e,n){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(zt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(e){this._delegate=e}cancel(e){K("OnDisconnect.cancel",0,1,arguments.length),nt("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){K("OnDisconnect.remove",0,1,arguments.length),nt("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){K("OnDisconnect.set",1,2,arguments.length),nt("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){K("OnDisconnect.setWithPriority",2,3,arguments.length),nt("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),o=>r(o)),i}update(e,n){if(K("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let o=0;o<e.length;++o)i[""+o]=e[o];e=i,aI("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}nt("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return K("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,n){this._database=e,this._delegate=n}val(){return K("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return K("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return K("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return K("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return K("DataSnapshot.child",0,1,arguments.length),e=String(e),ll("DataSnapshot.child","path",e),new oi(this._database,this._delegate.child(e))}hasChild(e){return K("DataSnapshot.hasChild",1,1,arguments.length),ll("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)}getPriority(){return K("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return K("DataSnapshot.forEach",1,1,arguments.length),nt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new oi(this._database,n)))}hasChildren(){return K("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return K("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return K("DataSnapshot.ref",0,0,arguments.length),new jt(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class ut{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var o;K("Query.on",2,4,arguments.length),nt("Query.on","callback",n,!1);const s=ut.getCancelAndContextArgs_("Query.on",r,i),a=(u,f)=>{n.call(s.context,new oi(this.database,u),f)};a.userCallback=n,a.context=s.context;const l=(o=s.cancel)===null||o===void 0?void 0:o.bind(s.context);switch(e){case"value":return Ip(this._delegate,a,l),n;case"child_added":return Y0(this._delegate,a,l),n;case"child_removed":return Z0(this._delegate,a,l),n;case"child_changed":return Q0(this._delegate,a,l),n;case"child_moved":return X0(this._delegate,a,l),n;default:throw new Error(zt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(K("Query.off",0,3,arguments.length),L4("Query.off",e),nt("Query.off","callback",n,!0),Hy("Query.off","context",r),n){const i=()=>{};i.userCallback=n,i.context=r,e_(this._delegate,e,i)}else e_(this._delegate,e)}get(){return qF(this._delegate).then(e=>new oi(this.database,e))}once(e,n,r,i){K("Query.once",1,4,arguments.length),nt("Query.once","callback",n,!0);const o=ut.getCancelAndContextArgs_("Query.once",r,i),s=new Ot,a=(u,f)=>{const h=new oi(this.database,u);n&&n.call(o.context,h,f),s.resolve(h)};a.userCallback=n,a.context=o.context;const l=u=>{o.cancel&&o.cancel.call(o.context,u),s.reject(u)};switch(e){case"value":Ip(this._delegate,a,l,{onlyOnce:!0});break;case"child_added":Y0(this._delegate,a,l,{onlyOnce:!0});break;case"child_removed":Z0(this._delegate,a,l,{onlyOnce:!0});break;case"child_changed":Q0(this._delegate,a,l,{onlyOnce:!0});break;case"child_moved":X0(this._delegate,a,l,{onlyOnce:!0});break;default:throw new Error(zt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return K("Query.limitToFirst",1,1,arguments.length),new ut(this.database,Sn(this._delegate,e4(e)))}limitToLast(e){return K("Query.limitToLast",1,1,arguments.length),new ut(this.database,Sn(this._delegate,n4(e)))}orderByChild(e){return K("Query.orderByChild",1,1,arguments.length),new ut(this.database,Sn(this._delegate,i4(e)))}orderByKey(){return K("Query.orderByKey",0,0,arguments.length),new ut(this.database,Sn(this._delegate,s4()))}orderByPriority(){return K("Query.orderByPriority",0,0,arguments.length),new ut(this.database,Sn(this._delegate,l4()))}orderByValue(){return K("Query.orderByValue",0,0,arguments.length),new ut(this.database,Sn(this._delegate,c4()))}startAt(e=null,n){return K("Query.startAt",0,2,arguments.length),new ut(this.database,Sn(this._delegate,YF(e,n)))}startAfter(e=null,n){return K("Query.startAfter",0,2,arguments.length),new ut(this.database,Sn(this._delegate,XF(e,n)))}endAt(e=null,n){return K("Query.endAt",0,2,arguments.length),new ut(this.database,Sn(this._delegate,JF(e,n)))}endBefore(e=null,n){return K("Query.endBefore",0,2,arguments.length),new ut(this.database,Sn(this._delegate,KF(e,n)))}equalTo(e,n){return K("Query.equalTo",1,2,arguments.length),new ut(this.database,Sn(this._delegate,f4(e,n)))}toString(){return K("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return K("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(K("Query.isEqual",1,1,arguments.length),!(e instanceof ut)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,nt(e,"cancel",i.cancel,!0),i.context=r,Hy(e,"context",i.context);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(zt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new jt(this.database,new xn(this._delegate._repo,this._delegate._path))}}class jt extends ut{constructor(e,n){super(e,new Wt(n._repo,n._path,new xd,!1)),this.database=e,this._delegate=n}getKey(){return K("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return K("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new jt(this.database,to(this._delegate,e))}getParent(){K("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new jt(this.database,e):null}getRoot(){return K("Reference.root",0,0,arguments.length),new jt(this.database,this._delegate.root)}set(e,n){K("Reference.set",1,2,arguments.length),nt("Reference.set","onComplete",n,!0);const r=rv(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(K("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let o=0;o<e.length;++o)i[""+o]=e[o];e=i,aI("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}fn("Reference.update",this._delegate._path),nt("Reference.update","onComplete",n,!0);const r=WF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){K("Reference.setWithPriority",2,3,arguments.length),nt("Reference.setWithPriority","onComplete",r,!0);const i=$F(this._delegate,e,n);return r&&i.then(()=>r(null),o=>r(o)),i}remove(e){K("Reference.remove",0,1,arguments.length),nt("Reference.remove","onComplete",e,!0);const n=GF(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){K("Reference.transaction",1,3,arguments.length),nt("Reference.transaction","transactionUpdate",e,!1),nt("Reference.transaction","onComplete",n,!0),D4("Reference.transaction","applyLocally",r);const i=R4(this._delegate,e,{applyLocally:r}).then(o=>new U4(o.committed,new oi(this.database,o.snapshot)));return n&&i.then(o=>n(null,o.committed,o.snapshot),o=>n(o,!1,null)),i}setPriority(e,n){K("Reference.setPriority",1,2,arguments.length),nt("Reference.setPriority","onComplete",n,!0);const r=zF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){K("Reference.push",0,2,arguments.length),nt("Reference.push","onComplete",n,!0);const r=BF(this._delegate,e),i=r.then(s=>new jt(this.database,s));n&&i.then(()=>n(null),s=>n(s));const o=new jt(this.database,r);return o.then=i.then.bind(i),o.catch=i.catch.bind(i,void 0),o}onDisconnect(){return fn("Reference.onDisconnect",this._delegate._path),new O4(new HF(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:_4,forceLongPolling:w4}}useEmulator(e,n,r={}){x4(this._delegate,e,n,r)}ref(e){if(K("database.ref",0,1,arguments.length),e instanceof jt){const n=K0(this._delegate,e.toString());return new jt(this,n)}else{const n=nI(this._delegate,e);return new jt(this,n)}}refFromURL(e){K("database.refFromURL",1,1,arguments.length);const r=K0(this._delegate,e);return new jt(this,r)}goOffline(){return K("database.goOffline",0,0,arguments.length),E4(this._delegate)}goOnline(){return K("database.goOnline",0,0,arguments.length),C4(this._delegate)}}ul.ServerValue={TIMESTAMP:k4(),increment:t=>b4(t)};function F4({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:o,nodeAdmin:s=!1}){zS(n);const a=new Qg("database-standalone"),l=new Yh("auth-internal",a);l.setComponent(new yn("auth-internal",()=>r,"PRIVATE"));let u;return i&&(u=new Yh("app-check-internal",a),u.setComponent(new yn("app-check-internal",()=>i,"PRIVATE"))),{instance:new ul(oI(t,l,u,e,s),t),namespace:o}}var V4=Object.freeze({__proto__:null,initStandalone:F4});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H4=ul.ServerValue;function B4(t){t.INTERNAL.registerComponent(new yn("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new ul(i,r)},"PUBLIC").setServiceProps({Reference:jt,Query:ut,Database:ul,DataSnapshot:oi,enableLogging:S4,INTERNAL:V4,ServerValue:H4}).setMultipleInstances(!0)),t.registerVersion(A4,P4)}B4(Xt);const G4={apiKey:"AIzaSyDD_CE0YjvmEBm65fbXv1X5zYRXjbV1UL8",authDomain:"spiel-master-1a1df.firebaseapp.com",databaseURL:"https://spiel-master-1a1df-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"spiel-master-1a1df",storageBucket:"spiel-master-1a1df.firebasestorage.app",messagingSenderId:"486111805415",appId:"1:486111805415:web:5cd01eaf33688cc1ab8742",measurementId:"G-K1LTRBX73Q"};Xt.apps.length?Xt.app():Xt.initializeApp(G4);const bp=Xt.auth(),z4=new Xt.auth.GoogleAuthProvider,we=Xt.database(),t_=({onClose:t,onGoogleLogin:e,onAdminLogin:n,isLanding:r=!1})=>{const[i,o]=S.useState(""),[s,a]=S.useState(""),[l,u]=S.useState(""),[f,h]=S.useState(!1),p=async _=>{if(_.preventDefault(),!i||!s){u("Please enter both username and password.");return}if(u(""),h(!0),i==="Admin"&&s==="Korikong3263!"){n({uid:"admin_master_local",username:"Admin",displayName:"Master Admin",role:"admin",isLocal:!0,email:"admin@internal"}),h(!1),r||t();return}try{const y=(await we.ref("accounts").once("value")).val();let w=null,v=null;y&&Object.entries(y).forEach(([E,I])=>{(I.username===i||I.email===i)&&I.password===s&&(w=I,v=E)}),w&&v?(n({uid:v,...w,isLocal:!0}),h(!1),r||t()):(u("Invalid credentials"),h(!1))}catch(x){console.error("Login Check Error",x),u("Connection error. Please try again."),h(!1)}},m=r?"min-h-screen bg-gradient-to-br from-orange-500 via-orange-600 to-red-600 flex items-center justify-center p-4":"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200";return g.jsx("div",{className:m,children:g.jsxs("div",{className:`bg-white dark:bg-slate-900 rounded-2xl w-full max-w-sm shadow-2xl overflow-hidden border border-gray-100 dark:border-slate-800 relative flex flex-col ${r?"animate-fade-in":""}`,children:[!r&&g.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors z-10",children:g.jsx(io,{size:20})}),g.jsxs("div",{className:"p-8",children:[g.jsxs("div",{className:"text-center mb-6",children:[g.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900/20 rounded-full flex items-center justify-center mx-auto mb-3 text-blue-600",children:g.jsx(rd,{size:24})}),g.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Workspace Access"}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Sign in to manage spiels and use AI tools."})]}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs("button",{onClick:e,className:"w-full py-3 px-4 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 hover:bg-gray-50 dark:hover:bg-slate-700 rounded-xl flex items-center justify-center gap-3 transition-all font-bold text-sm text-gray-700 dark:text-gray-200 shadow-sm hover:shadow-md",children:[g.jsx("i",{className:"fa-brands fa-google text-red-500 text-lg"}),"Sign in with Google"]}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"absolute inset-0 flex items-center",children:g.jsx("div",{className:"w-full border-t border-gray-200 dark:border-slate-700"})}),g.jsx("div",{className:"relative flex justify-center text-[10px] uppercase font-bold tracking-widest",children:g.jsx("span",{className:"bg-white dark:bg-slate-900 px-2 text-gray-400",children:"Or Local Login"})})]}),g.jsxs("form",{onSubmit:p,className:"space-y-3",children:[g.jsxs("div",{className:"relative",children:[g.jsx(pa,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),g.jsx("input",{type:"text",value:i,onChange:_=>o(_.target.value),className:"w-full pl-9 pr-3 py-2.5 bg-gray-50 dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-xl text-sm text-gray-900 dark:text-white placeholder-gray-400 outline-none focus:border-blue-500 transition-colors",placeholder:"Username"})]}),g.jsxs("div",{className:"relative",children:[g.jsx(Ga,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),g.jsx("input",{type:"password",value:s,onChange:_=>a(_.target.value),className:"w-full pl-9 pr-3 py-2.5 bg-gray-50 dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-xl text-sm text-gray-900 dark:text-white placeholder-gray-400 outline-none focus:border-blue-500 transition-colors",placeholder:"Password"})]}),l&&g.jsx("p",{className:"text-xs text-red-500 font-bold text-center",children:l}),g.jsx("button",{type:"submit",disabled:f,className:"w-full py-2.5 bg-gray-900 dark:bg-white text-white dark:text-gray-900 rounded-xl text-sm font-bold shadow-lg hover:opacity-90 transition-all flex items-center justify-center gap-2",children:f?g.jsx("span",{className:"animate-pulse",children:"Verifying..."}):g.jsxs(g.Fragment,{children:[g.jsx($N,{size:16})," Login"]})})]})]})]}),g.jsx("div",{className:"p-3 bg-gray-50 dark:bg-black/20 border-t border-gray-100 dark:border-slate-800 text-center",children:g.jsxs("div",{className:"flex items-center justify-center gap-2 text-[10px] text-gray-400 dark:text-gray-500 font-medium",children:[g.jsx(jE,{size:12}),g.jsx("span",{children:"Issues? Contact"}),g.jsx("a",{href:"https://link.seatalk.io/profile/open?seatalk_id=1223036706",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline font-bold",children:"Kong"})]})})]})})},$4=[{label:"Default",value:"bg-white dark:bg-[#202124]"},{label:"Red",value:"bg-red-50 dark:bg-[#450a0a]"},{label:"Orange",value:"bg-orange-50 dark:bg-[#431407]"},{label:"Yellow",value:"bg-yellow-50 dark:bg-[#422006]"},{label:"Green",value:"bg-green-50 dark:bg-[#052e16]"},{label:"Teal",value:"bg-teal-50 dark:bg-[#042f2e]"},{label:"Blue",value:"bg-blue-50 dark:bg-[#172554]"},{label:"Purple",value:"bg-purple-50 dark:bg-[#3b0764]"},{label:"Pink",value:"bg-pink-50 dark:bg-[#500724]"},{label:"Gray",value:"bg-gray-50 dark:bg-[#1f2937]"}],W4=({spiel:t,onClose:e,onCopy:n,onEdit:r,isAdmin:i,onSave:o,onViewImage:s})=>{const[a,l]=S.useState({title:t.title,english:t.english,brazil:t.brazil,images:t.images||[],color:t.color||"bg-white dark:bg-[#202124]",isPinned:t.isPinned||!1}),[u,f]=S.useState(!1),[h,p]=S.useState(!1),[m,_]=S.useState(!1),x=S.useRef(!1),C=S.useRef(a);S.useEffect(()=>{C.current=a,x.current=u},[a,u]);const y=()=>{x.current&&o&&!t.isDefault&&i&&o(t.id,C.current),e()},w=async(T,R)=>{try{await navigator.clipboard.writeText(T),n(`Copied ${R}`)}catch{n("Failed to copy")}},v=i&&!t.isDefault;S.useEffect(()=>{const T=N=>{N.key==="Escape"&&y()},R=async N=>{var G;if(!v)return;const D=(G=N.clipboardData)==null?void 0:G.items;if(D){for(let F=0;F<D.length;F++)if(D[F].type.indexOf("image")!==-1){const J=D[F].getAsFile();if(J){p(!0);try{const re=await xC(J);l(Oe=>({...Oe,images:[...Oe.images,re]})),f(!0),n("Image pasted and added")}catch(re){console.error(re),n("Failed to process image")}finally{p(!1)}}}}};return window.addEventListener("keydown",T),window.addEventListener("paste",R),()=>{window.removeEventListener("keydown",T),window.removeEventListener("paste",R)}},[v]);const E=(T,R)=>{l(N=>({...N,[T]:R})),f(!0)},I=T=>{l(R=>({...R,images:R.images.filter((N,D)=>D!==T)})),f(!0)},k=()=>{v&&E("isPinned",!a.isPinned)},b=a.color;return g.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:y,children:g.jsxs("div",{className:`${b} w-full max-w-5xl rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] border border-gray-200 dark:border-gray-700 transition-colors duration-300 scale-100 text-gray-900 dark:text-gray-100 relative`,onClick:T=>{T.stopPropagation(),_(!1)},children:[g.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-black/5 dark:border-white/10",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:`text-[10px] font-bold uppercase px-2 py-0.5 rounded-md ${t.isDefault?"bg-orange-50 text-orange-600 dark:bg-orange-900/20":"bg-blue-50 text-blue-600 dark:bg-blue-900/20"}`,children:t.category}),t.isDefault?g.jsx(rd,{size:14,className:"text-orange-500"}):g.jsx(pa,{size:14,className:"text-blue-500"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[v&&g.jsx("button",{onClick:k,className:`p-2 rounded-full transition-colors ${a.isPinned?"text-gray-900 dark:text-gray-100 bg-black/5 dark:bg-white/10":"text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/10"}`,title:a.isPinned?"Unpin":"Pin note",children:g.jsx(Hh,{size:20,className:a.isPinned?"fill-current":""})}),g.jsxs("button",{onClick:y,className:"p-2 rounded-full transition-colors text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/10",title:u?"Save & Close":"Close",children:[u?g.jsx("span",{className:"text-xs font-bold mr-2 text-blue-500",children:"Done"}):null,g.jsx(io,{size:20})]})]})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-6",children:[g.jsx("div",{className:"border-b border-black/5 dark:border-white/10 pb-4",children:v?g.jsx("input",{type:"text",value:a.title,onChange:T=>E("title",T.target.value),className:"w-full text-2xl font-bold leading-tight bg-transparent border-none focus:ring-0 outline-none placeholder-gray-400",placeholder:"Title"}):g.jsx("h2",{className:"text-2xl font-bold leading-tight text-gray-900 dark:text-white",children:t.title})}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-gray-500 dark:text-gray-400",children:"English Response"}),g.jsx("button",{onClick:()=>w(a.english,"English"),className:"p-1.5 transition-colors rounded-md text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",title:"Copy English",children:g.jsx(ji,{size:16})})]}),g.jsx("div",{className:"flex-1 p-4 rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-black/20 overflow-hidden flex flex-col",children:v?g.jsx("textarea",{value:a.english,onChange:T=>E("english",T.target.value),className:"w-full h-full min-h-[300px] bg-transparent border-none focus:ring-0 outline-none resize-none text-sm md:text-base font-medium leading-relaxed text-gray-800 dark:text-gray-200 custom-scrollbar",placeholder:"Type English response..."}):g.jsx("div",{className:"overflow-y-auto max-h-[400px] custom-scrollbar",children:g.jsx("p",{className:"text-sm md:text-base whitespace-pre-wrap font-medium leading-relaxed text-gray-800 dark:text-gray-200",children:t.english})})})]}),g.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-gray-500 dark:text-gray-400",children:"Portuguese (Brazil)"}),g.jsx("button",{onClick:()=>w(a.brazil,"Portuguese"),className:"p-1.5 transition-colors rounded-md text-gray-400 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20",title:"Copy Portuguese",children:g.jsx(ji,{size:16})})]}),g.jsx("div",{className:"flex-1 p-4 rounded-xl border border-black/5 dark:border-white/10 bg-white/60 dark:bg-black/20 overflow-hidden flex flex-col",children:v?g.jsx("textarea",{value:a.brazil,onChange:T=>E("brazil",T.target.value),className:"w-full h-full min-h-[300px] bg-transparent border-none focus:ring-0 outline-none resize-none text-sm md:text-base font-medium leading-relaxed text-gray-800 dark:text-gray-200 custom-scrollbar",placeholder:"Type Portuguese response..."}):g.jsx("div",{className:"overflow-y-auto max-h-[400px] custom-scrollbar",children:g.jsx("p",{className:"text-sm md:text-base whitespace-pre-wrap font-medium leading-relaxed text-gray-800 dark:text-gray-200",children:t.brazil})})})]})]}),(a.images.length>0||h)&&g.jsxs("div",{className:"space-y-2 pt-4",children:[g.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-gray-500 dark:text-gray-400",children:"Visual Aids"}),g.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:[a.images.map((T,R)=>g.jsxs("div",{className:"relative group rounded-xl overflow-hidden border border-gray-200 dark:border-gray-700 aspect-square bg-gray-100 dark:bg-gray-800 cursor-zoom-in",children:[g.jsx("div",{onClick:()=>s==null?void 0:s(T),className:"w-full h-full",children:g.jsx("img",{src:T,alt:`Visual aid ${R+1}`,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"})}),g.jsx("div",{className:"absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center pointer-events-none",children:g.jsx("div",{className:"w-10 h-10 bg-black/50 backdrop-blur-sm rounded-full flex items-center justify-center text-white",children:g.jsx(oR,{size:18})})}),v&&g.jsx("button",{onClick:N=>{N.stopPropagation(),I(R)},className:"absolute top-2 right-2 bg-red-600 text-white p-1.5 rounded-full shadow-md opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-700 pointer-events-auto",title:"Remove Image",children:g.jsx(_r,{size:14})})]},R)),h&&g.jsx("div",{className:"relative rounded-xl overflow-hidden border border-gray-200 dark:border-gray-700 aspect-square bg-gray-100 dark:bg-gray-800 flex items-center justify-center",children:g.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})})]}),v&&g.jsx("p",{className:"text-[10px] text-gray-400 mt-2 italic",children:"Tip: Click anywhere in this window and press Ctrl+V to paste an image."})]})]}),g.jsxs("div",{className:"p-4 border-t border-black/5 dark:border-white/10 bg-black/5 dark:bg-white/5 flex justify-between items-center text-[10px] font-medium text-gray-500 dark:text-gray-400 relative",children:[v&&g.jsxs("div",{className:"relative",children:[g.jsx("button",{onClick:T=>{T.stopPropagation(),_(!m)},className:"p-2 rounded-full hover:bg-black/10 dark:hover:bg-white/10 text-gray-500 dark:text-gray-400 transition-colors",title:"Change background color",children:g.jsx(QE,{size:16})}),m&&g.jsx("div",{className:"absolute bottom-full left-0 mb-2 p-2 bg-white dark:bg-[#303134] rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 flex gap-2 z-50 animate-in fade-in zoom-in-95 duration-200",children:$4.map(T=>g.jsx("button",{onClick:R=>{R.stopPropagation(),E("color",T.value),_(!1)},className:`w-6 h-6 rounded-full border border-gray-300 dark:border-gray-600 hover:scale-110 transition-transform ${T.value.split(" ")[0]} ${a.color===T.value?"ring-2 ring-blue-500 ring-offset-2 dark:ring-offset-gray-800":""}`,title:T.label},T.label))})]}),g.jsxs("div",{className:"flex gap-4",children:[g.jsxs("span",{children:["Created: ",new Date(t.createdAt).toLocaleDateString()]}),g.jsxs("span",{children:["ID: ",t.id.substring(0,8),"..."]})]}),v&&g.jsx("button",{onClick:y,className:"px-4 py-1.5 bg-transparent hover:bg-black/5 dark:hover:bg-white/10 rounded-lg text-gray-900 dark:text-gray-100 font-bold transition-colors",children:"Close"})]})]})})},q4=({src:t,onClose:e,onCopy:n})=>{const[r,i]=S.useState(!1),[o,s]=S.useState(1),[a,l]=S.useState({x:0,y:0}),[u,f]=S.useState(!1),h=S.useRef({x:0,y:0}),p=S.useRef(null);S.useEffect(()=>{const v=E=>{E.key==="Escape"&&e()};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[e]);const m=async()=>{try{const E=await(await fetch(t)).blob();await navigator.clipboard.write([new ClipboardItem({[E.type]:E})]),i(!0),n&&n("Image copied to clipboard"),setTimeout(()=>i(!1),2e3)}catch(v){console.error(v),n&&n("Failed to copy image")}},_=v=>{v.stopPropagation();const E=-v.deltaY,I=.1;let k=o+(E>0?I:-I);k=Math.min(Math.max(.5,k),5),s(k)},x=v=>{v.preventDefault(),f(!0),h.current={x:v.clientX-a.x,y:v.clientY-a.y}},C=v=>{u&&l({x:v.clientX-h.current.x,y:v.clientY-h.current.y})},y=()=>{f(!1)},w=()=>{s(1),l({x:0,y:0})};return g.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/95 backdrop-blur-md animate-in fade-in duration-200 overflow-hidden",onClick:e,onWheel:_,children:[g.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 z-50 flex justify-between items-start pointer-events-none",children:[g.jsxs("div",{className:"pointer-events-auto flex gap-2",children:[g.jsx("button",{onClick:v=>{v.stopPropagation(),w()},className:"p-2 rounded-full bg-white/10 text-white/70 hover:bg-white/20 hover:text-white transition-colors",title:"Reset View",children:g.jsx(XE,{size:20})}),g.jsxs("div",{className:"bg-black/50 text-white/70 px-3 py-2 rounded-full text-xs font-mono font-bold",children:[Math.round(o*100),"%"]})]}),g.jsxs("div",{className:"pointer-events-auto flex gap-2",children:[g.jsx("button",{onClick:v=>{v.stopPropagation(),m()},className:`
                p-2 rounded-full transition-all shadow-lg border border-white/10
                ${r?"bg-green-600 text-white":"bg-white/10 text-white/70 hover:bg-white/20 hover:text-white"}
              `,title:"Copy Image",children:r?g.jsx(KE,{size:20}):g.jsx(ji,{size:20})}),g.jsx("button",{onClick:e,className:"p-2 text-white/50 hover:text-white hover:bg-white/10 rounded-full transition-colors",children:g.jsx(io,{size:28})})]})]}),g.jsx("div",{className:"relative w-full h-full flex items-center justify-center cursor-move",onMouseDown:x,onMouseMove:C,onMouseUp:y,onMouseLeave:y,onClick:v=>v.stopPropagation(),children:g.jsx("img",{ref:p,src:t,className:"max-w-none transition-transform duration-75 ease-linear select-none",style:{transform:`translate(${a.x}px, ${a.y}px) scale(${o})`,maxHeight:"85vh",maxWidth:"85vw"},draggable:!1,alt:"Expanded"})}),g.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 text-white/40 text-xs font-medium pointer-events-none bg-black/40 px-3 py-1 rounded-full backdrop-blur-sm",children:"Scroll to zoom  Drag to pan"})]})},J4=({title:t,initialValue:e="",placeholder:n,onConfirm:r,onCancel:i})=>{const[o,s]=S.useState(e),a=S.useRef(null);S.useEffect(()=>{a.current&&a.current.focus()},[]);const l=u=>{u.preventDefault(),o.trim()&&r(o.trim())};return g.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm animate-in fade-in duration-200",children:g.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl w-full max-w-sm shadow-2xl overflow-hidden p-6 border border-gray-100 dark:border-slate-800",children:[g.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 text-center",children:t}),g.jsxs("form",{onSubmit:l,children:[g.jsx("input",{ref:a,type:"text",className:"w-full p-3 bg-gray-50 dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-xl text-sm text-gray-900 dark:text-white outline-none focus:border-blue-500 transition-colors mb-6",placeholder:n,value:o,onChange:u=>s(u.target.value)}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{type:"button",onClick:i,className:"flex-1 py-3 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl font-bold text-xs uppercase tracking-wider hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),g.jsx("button",{type:"submit",disabled:!o.trim(),className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-xs uppercase tracking-wider shadow-lg transition-colors disabled:opacity-50",children:"Save"})]})]})]})})},j4=({deletedSpiels:t,onClose:e,onRestore:n,onDeleteForever:r})=>g.jsx("div",{className:"fixed inset-0 z-[50] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:g.jsxs("div",{className:"bg-[#f0f2f5] dark:bg-[#1e1e1e] w-full max-w-6xl h-[85vh] rounded-3xl shadow-2xl overflow-hidden flex flex-col border border-gray-200 dark:border-gray-700",children:[g.jsxs("div",{className:"p-6 bg-white dark:bg-[#202124] border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-full flex items-center justify-center shadow-sm",children:g.jsx(_r,{size:24})}),g.jsxs("div",{children:[g.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Trash Bin"}),g.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Items here are removed from the main view."})]})]}),g.jsx("button",{onClick:e,className:"p-2.5 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors text-gray-400 hover:text-gray-900 dark:hover:text-white",children:g.jsx(io,{size:24})})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-6 md:p-8 custom-scrollbar bg-[#f0f2f5] dark:bg-[#121212]",children:t.length===0?g.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-40 space-y-4",children:[g.jsx("div",{className:"w-24 h-24 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center",children:g.jsx(PN,{size:48,className:"text-gray-400 dark:text-gray-600"})}),g.jsx("p",{className:"text-lg font-bold text-gray-500 dark:text-gray-400",children:"The trash is empty"})]}):g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:t.map(i=>g.jsx("div",{className:"h-64",children:g.jsx(Jh,{spiel:i,onCopy:()=>{},isTrashView:!0,onRestore:()=>n(i.id),onDelete:()=>r(i.id)})},i.id))})})]})});var K4={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Y4,Q4;function X4(){return{geminiUrl:Y4,vertexUrl:Q4}}function Z4(t,e,n,r){var i,o;if(!(t!=null&&t.baseUrl)){const s=X4();return e?(i=s.vertexUrl)!==null&&i!==void 0?i:n:(o=s.geminiUrl)!==null&&o!==void 0?o:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kr{}function H(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const o=e[i];return o!=null?String(o):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function d(t,e,n){for(let o=0;o<e.length-1;o++){const s=e[o];if(s.endsWith("[]")){const a=s.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(t[a])){const l=t[a];if(Array.isArray(n))for(let u=0;u<l.length;u++){const f=l[u];d(f,e.slice(o+1),n[u])}else for(const u of l)d(u,e.slice(o+1),n)}return}else if(s.endsWith("[0]")){const a=s.slice(0,-3);a in t||(t[a]=[{}]);const l=t[a];d(l[0],e.slice(o+1),n);return}(!t[s]||typeof t[s]!="object")&&(t[s]={}),t=t[s]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function c(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const i=e[r];if(i.endsWith("[]")){const o=i.slice(0,-2);if(o in t){const s=t[o];return Array.isArray(s)?s.map(a=>c(a,e.slice(r+1),n)):n}else return n}else t=t[i]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function eV(t,e){for(const[n,r]of Object.entries(e)){const i=n.split("."),o=r.split("."),s=new Set;let a=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){a=l;break}if(a!==-1&&o.length>a)for(let l=a;l<o.length;l++){const u=o[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&s.add(u)}Np(t,i,o,0,s)}}function Np(t,e,n,r,i){if(r>=e.length||typeof t!="object"||t===null)return;const o=e[r];if(o.endsWith("[]")){const s=o.slice(0,-2),a=t;if(s in a&&Array.isArray(a[s]))for(const l of a[s])Np(l,e,n,r+1,i)}else if(o==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const s=t,a=Object.keys(s).filter(u=>!u.startsWith("_")&&!i.has(u)),l={};for(const u of a)l[u]=s[u];for(const[u,f]of Object.entries(l)){const h=[];for(const p of n.slice(r))p==="*"?h.push(u):h.push(p);d(s,h,f)}for(const u of a)delete s[u]}}else{const s=t;o in s&&Np(s[o],e,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iv(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tV(t){const e={},n=c(t,["operationName"]);n!=null&&d(e,["operationName"],n);const r=c(t,["resourceName"]);return r!=null&&d(e,["_url","resourceName"],r),e}function nV(t){const e={},n=c(t,["name"]);n!=null&&d(e,["name"],n);const r=c(t,["metadata"]);r!=null&&d(e,["metadata"],r);const i=c(t,["done"]);i!=null&&d(e,["done"],i);const o=c(t,["error"]);o!=null&&d(e,["error"],o);const s=c(t,["response","generateVideoResponse"]);return s!=null&&d(e,["response"],iV(s)),e}function rV(t){const e={},n=c(t,["name"]);n!=null&&d(e,["name"],n);const r=c(t,["metadata"]);r!=null&&d(e,["metadata"],r);const i=c(t,["done"]);i!=null&&d(e,["done"],i);const o=c(t,["error"]);o!=null&&d(e,["error"],o);const s=c(t,["response"]);return s!=null&&d(e,["response"],oV(s)),e}function iV(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>sV(s))),d(e,["generatedVideos"],o)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&d(e,["raiMediaFilteredReasons"],i),e}function oV(t){const e={},n=c(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>aV(s))),d(e,["generatedVideos"],o)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&d(e,["raiMediaFilteredReasons"],i),e}function sV(t){const e={},n=c(t,["video"]);return n!=null&&d(e,["video"],hV(n)),e}function aV(t){const e={},n=c(t,["_self"]);return n!=null&&d(e,["video"],pV(n)),e}function lV(t){const e={},n=c(t,["operationName"]);return n!=null&&d(e,["_url","operationName"],n),e}function uV(t){const e={},n=c(t,["operationName"]);return n!=null&&d(e,["_url","operationName"],n),e}function cV(t){const e={},n=c(t,["name"]);n!=null&&d(e,["name"],n);const r=c(t,["metadata"]);r!=null&&d(e,["metadata"],r);const i=c(t,["done"]);i!=null&&d(e,["done"],i);const o=c(t,["error"]);o!=null&&d(e,["error"],o);const s=c(t,["response"]);return s!=null&&d(e,["response"],dV(s)),e}function dV(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["parent"]);r!=null&&d(e,["parent"],r);const i=c(t,["documentName"]);return i!=null&&d(e,["documentName"],i),e}function lI(t){const e={},n=c(t,["name"]);n!=null&&d(e,["name"],n);const r=c(t,["metadata"]);r!=null&&d(e,["metadata"],r);const i=c(t,["done"]);i!=null&&d(e,["done"],i);const o=c(t,["error"]);o!=null&&d(e,["error"],o);const s=c(t,["response"]);return s!=null&&d(e,["response"],fV(s)),e}function fV(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["parent"]);r!=null&&d(e,["parent"],r);const i=c(t,["documentName"]);return i!=null&&d(e,["documentName"],i),e}function hV(t){const e={},n=c(t,["uri"]);n!=null&&d(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&d(e,["videoBytes"],iv(r));const i=c(t,["encoding"]);return i!=null&&d(e,["mimeType"],i),e}function pV(t){const e={},n=c(t,["gcsUri"]);n!=null&&d(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&d(e,["videoBytes"],iv(r));const i=c(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var n_;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(n_||(n_={}));var r_;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(r_||(r_={}));var i_;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(i_||(i_={}));var Jr;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Jr||(Jr={}));var o_;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(o_||(o_={}));var s_;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(s_||(s_={}));var a_;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(a_||(a_={}));var l_;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(l_||(l_={}));var u_;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(u_||(u_={}));var c_;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(c_||(c_={}));var d_;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(d_||(d_={}));var f_;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(f_||(f_={}));var h_;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(h_||(h_={}));var p_;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(p_||(p_={}));var g_;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(g_||(g_={}));var m_;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(m_||(m_={}));var v_;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(v_||(v_={}));var y_;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(y_||(y_={}));var __;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(__||(__={}));var w_;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(w_||(w_={}));var x_;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(x_||(x_={}));var Lc;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Lc||(Lc={}));var E_;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(E_||(E_={}));var C_;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(C_||(C_={}));var S_;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(S_||(S_={}));var Rp;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Rp||(Rp={}));var T_;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(T_||(T_={}));var I_;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(I_||(I_={}));var Ap;(function(t){t.COLLECTION="COLLECTION"})(Ap||(Ap={}));var k_;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(k_||(k_={}));var b_;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(b_||(b_={}));var N_;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(N_||(N_={}));var R_;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(R_||(R_={}));var A_;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(A_||(A_={}));var P_;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(P_||(P_={}));var M_;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(M_||(M_={}));var D_;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(D_||(D_={}));var L_;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(L_||(L_={}));var O_;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(O_||(O_={}));var U_;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(U_||(U_={}));var F_;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(F_||(F_={}));var V_;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(V_||(V_={}));var H_;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(H_||(H_={}));var B_;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(B_||(B_={}));var G_;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(G_||(G_={}));var z_;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED",t.REGISTERED="REGISTERED"})(z_||(z_={}));var $_;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})($_||($_={}));var W_;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(W_||(W_={}));var q_;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(q_||(q_={}));var J_;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.ACTIVITY_START="ACTIVITY_START",t.ACTIVITY_END="ACTIVITY_END"})(J_||(J_={}));var j_;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(j_||(j_={}));var K_;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(K_||(K_={}));var Y_;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Y_||(Y_={}));var Q_;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Q_||(Q_={}));var X_;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(X_||(X_={}));var Z_;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(Z_||(Z_={}));var Mo;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Mo||(Mo={}));class Pp{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Ys{get text(){var e,n,r,i,o,s,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const h=[];for(const p of(l=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[m,_]of Object.entries(p))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(_!==null||_!==void 0)&&h.push(m);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;f=!0,u+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var e,n,r,i,o,s,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const h of(l=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[p,m]of Object.entries(h))p!=="inlineData"&&(m!==null||m!==void 0)&&f.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(u+=atob(h.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,i,o,s,a,l;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,i,o,s,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(l=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,i,o,s,a,l,u;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(l=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class ew{}class tw{}class gV{}class mV{}class vV{}class yV{}class nw{}class rw{}class iw{}class _V{}class Oc{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Oc;let i;const o=e;return n?i=rV(o):i=nV(o),Object.assign(r,i),r}}class ow{}class sw{}class aw{}class lw{}class wV{}class xV{}class EV{}class ov{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new ov,o=cV(e);return Object.assign(r,o),r}}class CV{}class SV{}class TV{}class uw{}class IV{get text(){var e,n,r;let i="",o=!1;const s=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&s.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;o=!0,i+=a.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?i:void 0}get data(){var e,n,r;let i="";const o=[];for(const s of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(s))a!=="inlineData"&&l!==null&&o.push(a);s.inlineData&&typeof s.inlineData.data=="string"&&(i+=atob(s.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class kV{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class sv{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new sv,o=lI(e);return Object.assign(r,o),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function de(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function uI(t,e){const n=de(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function cI(t){return Array.isArray(t)?t.map(e=>Uc(e)):[Uc(t)]}function Uc(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function dI(t){const e=Uc(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function fI(t){const e=Uc(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function cw(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function hI(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>cw(e)):[cw(t)]}function Mp(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function dw(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function fw(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function _t(t){if(t==null)throw new Error("ContentUnion is required");return Mp(t)?t:{role:"user",parts:hI(t)}}function av(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=_t(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=_t(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>_t(n)):[_t(e)]}function gn(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(dw(t)||fw(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[_t(t)]}const e=[],n=[],r=Mp(t[0]);for(const i of t){const o=Mp(i);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(i);else{if(dw(i)||fw(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:hI(n)}),e}function bV(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Jr).includes(n[0].toUpperCase())?n[0].toUpperCase():Jr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Jr).includes(r.toUpperCase())?r.toUpperCase():Jr.TYPE_UNSPECIFIED})}}function jo(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=t.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,t=o[1]):o[1].type==="null"&&(e.nullable=!0,t=o[0])),t.type instanceof Array&&bV(t.type,e);for(const[s,a]of Object.entries(t))if(a!=null)if(s=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(Jr).includes(a.toUpperCase())?a.toUpperCase():Jr.TYPE_UNSPECIFIED}else if(n.includes(s))e[s]=jo(a);else if(r.includes(s)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(jo(u))}e[s]=l}else if(i.includes(s)){const l={};for(const[u,f]of Object.entries(a))l[u]=jo(f);e[s]=l}else{if(s==="additionalProperties")continue;e[s]=a}return e}function lv(t){return jo(t)}function uv(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function cv(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Is(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=jo(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=jo(e.response));return t}function ks(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function NV(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function br(t,e){if(typeof e!="string")throw new Error("name must be a string");return NV(t,e,"cachedContents")}function pI(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Ei(t){return iv(t)}function RV(t){return t!=null&&typeof t=="object"&&"name"in t}function AV(t){return t!=null&&typeof t=="object"&&"video"in t}function PV(t){return t!=null&&typeof t=="object"&&"uri"in t}function gI(t){var e;let n;if(RV(t)&&(n=t.name),!(PV(t)&&(n=t.uri,n===void 0))&&!(AV(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function mI(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function vI(t){for(const e of["models","tunedModels","publisherModels"])if(MV(t,e))return t[e];return[]}function MV(t,e){return t!==null&&typeof t=="object"&&e in t}function DV(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function LV(t,e={}){const n=[],r=new Set;for(const i of t){const o=i.name;if(r.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);r.add(o);const s=DV(i,e);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}function yI(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function OV(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function _I(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let o=!1;for(const s of i){if(typeof s!="object"||s===null)continue;const l=s.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function bs(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function wI(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function UV(t){const e={},n=c(t,["responsesFile"]);n!=null&&d(e,["fileName"],n);const r=c(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>v5(s))),d(e,["inlinedResponses"],o)}const i=c(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),d(e,["inlinedEmbedContentResponses"],o)}return e}function FV(t){const e={},n=c(t,["predictionsFormat"]);n!=null&&d(e,["format"],n);const r=c(t,["gcsDestination","outputUriPrefix"]);r!=null&&d(e,["gcsUri"],r);const i=c(t,["bigqueryDestination","outputUri"]);return i!=null&&d(e,["bigqueryUri"],i),e}function VV(t){const e={},n=c(t,["format"]);n!=null&&d(e,["predictionsFormat"],n);const r=c(t,["gcsUri"]);r!=null&&d(e,["gcsDestination","outputUriPrefix"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&d(e,["bigqueryDestination","outputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(c(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Lu(t){const e={},n=c(t,["name"]);n!=null&&d(e,["name"],n);const r=c(t,["metadata","displayName"]);r!=null&&d(e,["displayName"],r);const i=c(t,["metadata","state"]);i!=null&&d(e,["state"],wI(i));const o=c(t,["metadata","createTime"]);o!=null&&d(e,["createTime"],o);const s=c(t,["metadata","endTime"]);s!=null&&d(e,["endTime"],s);const a=c(t,["metadata","updateTime"]);a!=null&&d(e,["updateTime"],a);const l=c(t,["metadata","model"]);l!=null&&d(e,["model"],l);const u=c(t,["metadata","output"]);return u!=null&&d(e,["dest"],UV(_I(u))),e}function Dp(t){const e={},n=c(t,["name"]);n!=null&&d(e,["name"],n);const r=c(t,["displayName"]);r!=null&&d(e,["displayName"],r);const i=c(t,["state"]);i!=null&&d(e,["state"],wI(i));const o=c(t,["error"]);o!=null&&d(e,["error"],o);const s=c(t,["createTime"]);s!=null&&d(e,["createTime"],s);const a=c(t,["startTime"]);a!=null&&d(e,["startTime"],a);const l=c(t,["endTime"]);l!=null&&d(e,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&d(e,["updateTime"],u);const f=c(t,["model"]);f!=null&&d(e,["model"],f);const h=c(t,["inputConfig"]);h!=null&&d(e,["src"],HV(h));const p=c(t,["outputConfig"]);p!=null&&d(e,["dest"],FV(_I(p)));const m=c(t,["completionStats"]);return m!=null&&d(e,["completionStats"],m),e}function HV(t){const e={},n=c(t,["instancesFormat"]);n!=null&&d(e,["format"],n);const r=c(t,["gcsSource","uris"]);r!=null&&d(e,["gcsUri"],r);const i=c(t,["bigquerySource","inputUri"]);return i!=null&&d(e,["bigqueryUri"],i),e}function BV(t,e){const n={};if(c(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(e,["fileName"]);r!=null&&d(n,["fileName"],r);const i=c(e,["inlinedRequests"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>m5(t,s))),d(n,["requests","requests"],o)}return n}function GV(t){const e={},n=c(t,["format"]);n!=null&&d(e,["instancesFormat"],n);const r=c(t,["gcsUri"]);r!=null&&d(e,["gcsSource","uris"],r);const i=c(t,["bigqueryUri"]);if(i!=null&&d(e,["bigquerySource","inputUri"],i),c(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function zV(t){const e={},n=c(t,["data"]);if(n!=null&&d(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function $V(t,e){const n={},r=c(e,["name"]);return r!=null&&d(n,["_url","name"],bs(t,r)),n}function WV(t,e){const n={},r=c(e,["name"]);return r!=null&&d(n,["_url","name"],bs(t,r)),n}function qV(t){const e={},n=c(t,["content"]);n!=null&&d(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&d(e,["citationMetadata"],JV(r));const i=c(t,["tokenCount"]);i!=null&&d(e,["tokenCount"],i);const o=c(t,["finishReason"]);o!=null&&d(e,["finishReason"],o);const s=c(t,["avgLogprobs"]);s!=null&&d(e,["avgLogprobs"],s);const a=c(t,["groundingMetadata"]);a!=null&&d(e,["groundingMetadata"],a);const l=c(t,["index"]);l!=null&&d(e,["index"],l);const u=c(t,["logprobsResult"]);u!=null&&d(e,["logprobsResult"],u);const f=c(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),d(e,["safetyRatings"],p)}const h=c(t,["urlContextMetadata"]);return h!=null&&d(e,["urlContextMetadata"],h),e}function JV(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),d(e,["citations"],r)}return e}function xI(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>S5(o))),d(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&d(e,["role"],r),e}function jV(t,e){const n={},r=c(t,["displayName"]);if(e!==void 0&&r!=null&&d(e,["batch","displayName"],r),c(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function KV(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&d(e,["displayName"],r);const i=c(t,["dest"]);return e!==void 0&&i!=null&&d(e,["outputConfig"],VV(OV(i))),n}function hw(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["src"]);i!=null&&d(n,["batch","inputConfig"],BV(t,yI(t,i)));const o=c(e,["config"]);return o!=null&&jV(o,n),n}function YV(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["model"],de(t,r));const i=c(e,["src"]);i!=null&&d(n,["inputConfig"],GV(yI(t,i)));const o=c(e,["config"]);return o!=null&&KV(o,n),n}function QV(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&d(e,["batch","displayName"],r),n}function XV(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["src"]);i!=null&&d(n,["batch","inputConfig"],o5(t,i));const o=c(e,["config"]);return o!=null&&QV(o,n),n}function ZV(t,e){const n={},r=c(e,["name"]);return r!=null&&d(n,["_url","name"],bs(t,r)),n}function e5(t,e){const n={},r=c(e,["name"]);return r!=null&&d(n,["_url","name"],bs(t,r)),n}function t5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&d(e,["name"],r);const i=c(t,["done"]);i!=null&&d(e,["done"],i);const o=c(t,["error"]);return o!=null&&d(e,["error"],o),e}function n5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["name"]);r!=null&&d(e,["name"],r);const i=c(t,["done"]);i!=null&&d(e,["done"],i);const o=c(t,["error"]);return o!=null&&d(e,["error"],o),e}function r5(t,e){const n={},r=c(e,["contents"]);if(r!=null){let o=av(t,r);Array.isArray(o)&&(o=o.map(s=>s)),d(n,["requests[]","request","content"],o)}const i=c(e,["config"]);return i!=null&&(d(n,["_self"],i5(i,n)),eV(n,{"requests[].*":"requests[].request.*"})),n}function i5(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&d(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&d(e,["requests[]","title"],i);const o=c(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&d(e,["requests[]","outputDimensionality"],o),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function o5(t,e){const n={},r=c(e,["fileName"]);r!=null&&d(n,["file_name"],r);const i=c(e,["inlinedRequests"]);return i!=null&&d(n,["requests"],r5(t,i)),n}function s5(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function a5(t){const e={},n=c(t,["id"]);n!=null&&d(e,["id"],n);const r=c(t,["args"]);r!=null&&d(e,["args"],r);const i=c(t,["name"]);if(i!=null&&d(e,["name"],i),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function l5(t){const e={},n=c(t,["allowedFunctionNames"]);n!=null&&d(e,["allowedFunctionNames"],n);const r=c(t,["mode"]);if(r!=null&&d(e,["mode"],r),c(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function u5(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&d(n,["systemInstruction"],xI(_t(i)));const o=c(e,["temperature"]);o!=null&&d(r,["temperature"],o);const s=c(e,["topP"]);s!=null&&d(r,["topP"],s);const a=c(e,["topK"]);a!=null&&d(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&d(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&d(r,["stopSequences"],f);const h=c(e,["responseLogprobs"]);h!=null&&d(r,["responseLogprobs"],h);const p=c(e,["logprobs"]);p!=null&&d(r,["logprobs"],p);const m=c(e,["presencePenalty"]);m!=null&&d(r,["presencePenalty"],m);const _=c(e,["frequencyPenalty"]);_!=null&&d(r,["frequencyPenalty"],_);const x=c(e,["seed"]);x!=null&&d(r,["seed"],x);const C=c(e,["responseMimeType"]);C!=null&&d(r,["responseMimeType"],C);const y=c(e,["responseSchema"]);y!=null&&d(r,["responseSchema"],lv(y));const w=c(e,["responseJsonSchema"]);if(w!=null&&d(r,["responseJsonSchema"],w),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const v=c(e,["safetySettings"]);if(n!==void 0&&v!=null){let F=v;Array.isArray(F)&&(F=F.map(J=>T5(J))),d(n,["safetySettings"],F)}const E=c(e,["tools"]);if(n!==void 0&&E!=null){let F=ks(E);Array.isArray(F)&&(F=F.map(J=>k5(Is(J)))),d(n,["tools"],F)}const I=c(e,["toolConfig"]);if(n!==void 0&&I!=null&&d(n,["toolConfig"],I5(I)),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=c(e,["cachedContent"]);n!==void 0&&k!=null&&d(n,["cachedContent"],br(t,k));const b=c(e,["responseModalities"]);b!=null&&d(r,["responseModalities"],b);const T=c(e,["mediaResolution"]);T!=null&&d(r,["mediaResolution"],T);const R=c(e,["speechConfig"]);if(R!=null&&d(r,["speechConfig"],uv(R)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=c(e,["thinkingConfig"]);N!=null&&d(r,["thinkingConfig"],N);const D=c(e,["imageConfig"]);D!=null&&d(r,["imageConfig"],g5(D));const G=c(e,["enableEnhancedCivicAnswers"]);if(G!=null&&d(r,["enableEnhancedCivicAnswers"],G),c(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function c5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>qV(u))),d(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&d(e,["modelVersion"],i);const o=c(t,["promptFeedback"]);o!=null&&d(e,["promptFeedback"],o);const s=c(t,["responseId"]);s!=null&&d(e,["responseId"],s);const a=c(t,["usageMetadata"]);return a!=null&&d(e,["usageMetadata"],a),e}function d5(t,e){const n={},r=c(e,["name"]);return r!=null&&d(n,["_url","name"],bs(t,r)),n}function f5(t,e){const n={},r=c(e,["name"]);return r!=null&&d(n,["_url","name"],bs(t,r)),n}function h5(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function p5(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function g5(t){const e={},n=c(t,["aspectRatio"]);n!=null&&d(e,["aspectRatio"],n);const r=c(t,["imageSize"]);if(r!=null&&d(e,["imageSize"],r),c(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(c(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(c(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function m5(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["request","model"],de(t,r));const i=c(e,["contents"]);if(i!=null){let a=gn(i);Array.isArray(a)&&(a=a.map(l=>xI(l))),d(n,["request","contents"],a)}const o=c(e,["metadata"]);o!=null&&d(n,["metadata"],o);const s=c(e,["config"]);return s!=null&&d(n,["request","generationConfig"],u5(t,s,c(n,["request"],{}))),n}function v5(t){const e={},n=c(t,["response"]);n!=null&&d(e,["response"],c5(n));const r=c(t,["error"]);return r!=null&&d(e,["error"],r),e}function y5(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);if(e!==void 0&&i!=null&&d(e,["_query","pageToken"],i),c(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function _5(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);e!==void 0&&i!=null&&d(e,["_query","pageToken"],i);const o=c(t,["filter"]);return e!==void 0&&o!=null&&d(e,["_query","filter"],o),n}function w5(t){const e={},n=c(t,["config"]);return n!=null&&y5(n,e),e}function x5(t){const e={},n=c(t,["config"]);return n!=null&&_5(n,e),e}function E5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const i=c(t,["operations"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>Lu(s))),d(e,["batchJobs"],o)}return e}function C5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const i=c(t,["batchPredictionJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>Dp(s))),d(e,["batchJobs"],o)}return e}function S5(t){const e={},n=c(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);const r=c(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&d(e,["executableCode"],i);const o=c(t,["fileData"]);o!=null&&d(e,["fileData"],s5(o));const s=c(t,["functionCall"]);s!=null&&d(e,["functionCall"],a5(s));const a=c(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);const l=c(t,["inlineData"]);l!=null&&d(e,["inlineData"],zV(l));const u=c(t,["text"]);u!=null&&d(e,["text"],u);const f=c(t,["thought"]);f!=null&&d(e,["thought"],f);const h=c(t,["thoughtSignature"]);h!=null&&d(e,["thoughtSignature"],h);const p=c(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function T5(t){const e={},n=c(t,["category"]);if(n!=null&&d(e,["category"],n),c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=c(t,["threshold"]);return r!=null&&d(e,["threshold"],r),e}function I5(t){const e={},n=c(t,["retrievalConfig"]);n!=null&&d(e,["retrievalConfig"],n);const r=c(t,["functionCallingConfig"]);return r!=null&&d(e,["functionCallingConfig"],l5(r)),e}function k5(t){const e={};if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=c(t,["computerUse"]);n!=null&&d(e,["computerUse"],n);const r=c(t,["fileSearch"]);r!=null&&d(e,["fileSearch"],r);const i=c(t,["codeExecution"]);if(i!=null&&d(e,["codeExecution"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=c(t,["functionDeclarations"]);if(o!=null){let f=o;Array.isArray(f)&&(f=f.map(h=>h)),d(e,["functionDeclarations"],f)}const s=c(t,["googleMaps"]);s!=null&&d(e,["googleMaps"],h5(s));const a=c(t,["googleSearch"]);a!=null&&d(e,["googleSearch"],p5(a));const l=c(t,["googleSearchRetrieval"]);l!=null&&d(e,["googleSearchRetrieval"],l);const u=c(t,["urlContext"]);return u!=null&&d(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Cr;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(Cr||(Cr={}));class fo{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,o;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let s={config:{}};!r||Object.keys(r).length===0?s={config:{}}:typeof r=="object"?s=Object.assign({},r):s=r,s.config&&(s.config.pageToken=n.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(o=(i=s.config)===null||i===void 0?void 0:i.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class b5 extends kr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new fo(Cr.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=hw(this.apiClient,e),r=n._url,i=H("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,l=a.requests,u=[];for(const f of l){const h=Object.assign({},f);if(h.systemInstruction){const p=h.systemInstruction;delete h.systemInstruction;const m=h.request;m.systemInstruction=p,h.request=m}u.push(h)}return a.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const o=this.getGcsUri(e),s=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?r.dest=`${o.slice(0,-6)}/dest`:r.dest=`${o}_dest_${i}`;else if(s)r.dest=`${s}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=YV(this.apiClient,e);return a=H("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>Dp(f))}else{const u=hw(this.apiClient,e);return a=H("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>Lu(f))}}async createEmbeddingsInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=XV(this.apiClient,e);return o=H("{model}:asyncBatchEmbedContent",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>Lu(l))}}async get(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=f5(this.apiClient,e);return a=H("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>Dp(f))}else{const u=d5(this.apiClient,e);return a=H("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>Lu(f))}}async cancel(e){var n,r,i,o;let s="",a={};if(this.apiClient.isVertexAI()){const l=WV(this.apiClient,e);s=H("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=$V(this.apiClient,e);s=H("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=x5(e);return a=H("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=C5(f),p=new uw;return Object.assign(p,h),p})}else{const u=w5(e);return a=H("batches",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=E5(f),p=new uw;return Object.assign(p,h),p})}}async delete(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=e5(this.apiClient,e);return a=H("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>n5(f))}else{const u=ZV(this.apiClient,e);return a=H("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>t5(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N5(t){const e={},n=c(t,["data"]);if(n!=null&&d(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function pw(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>X5(o))),d(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&d(e,["role"],r),e}function R5(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&d(e,["expireTime"],i);const o=c(t,["displayName"]);e!==void 0&&o!=null&&d(e,["displayName"],o);const s=c(t,["contents"]);if(e!==void 0&&s!=null){let f=gn(s);Array.isArray(f)&&(f=f.map(h=>pw(h))),d(e,["contents"],f)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&d(e,["systemInstruction"],pw(_t(a)));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(h=>e3(h))),d(e,["tools"],f)}const u=c(t,["toolConfig"]);if(e!==void 0&&u!=null&&d(e,["toolConfig"],Z5(u)),c(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function A5(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);const i=c(t,["expireTime"]);e!==void 0&&i!=null&&d(e,["expireTime"],i);const o=c(t,["displayName"]);e!==void 0&&o!=null&&d(e,["displayName"],o);const s=c(t,["contents"]);if(e!==void 0&&s!=null){let h=gn(s);Array.isArray(h)&&(h=h.map(p=>p)),d(e,["contents"],h)}const a=c(t,["systemInstruction"]);e!==void 0&&a!=null&&d(e,["systemInstruction"],_t(a));const l=c(t,["tools"]);if(e!==void 0&&l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>t3(p))),d(e,["tools"],h)}const u=c(t,["toolConfig"]);e!==void 0&&u!=null&&d(e,["toolConfig"],u);const f=c(t,["kmsKeyName"]);return e!==void 0&&f!=null&&d(e,["encryption_spec","kmsKeyName"],f),n}function P5(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["model"],uI(t,r));const i=c(e,["config"]);return i!=null&&R5(i,n),n}function M5(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["model"],uI(t,r));const i=c(e,["config"]);return i!=null&&A5(i,n),n}function D5(t,e){const n={},r=c(e,["name"]);return r!=null&&d(n,["_url","name"],br(t,r)),n}function L5(t,e){const n={},r=c(e,["name"]);return r!=null&&d(n,["_url","name"],br(t,r)),n}function O5(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function U5(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function F5(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function V5(t){const e={},n=c(t,["id"]);n!=null&&d(e,["id"],n);const r=c(t,["args"]);r!=null&&d(e,["args"],r);const i=c(t,["name"]);if(i!=null&&d(e,["name"],i),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function H5(t){const e={},n=c(t,["allowedFunctionNames"]);n!=null&&d(e,["allowedFunctionNames"],n);const r=c(t,["mode"]);if(r!=null&&d(e,["mode"],r),c(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function B5(t){const e={},n=c(t,["description"]);n!=null&&d(e,["description"],n);const r=c(t,["name"]);r!=null&&d(e,["name"],r);const i=c(t,["parameters"]);i!=null&&d(e,["parameters"],i);const o=c(t,["parametersJsonSchema"]);o!=null&&d(e,["parametersJsonSchema"],o);const s=c(t,["response"]);s!=null&&d(e,["response"],s);const a=c(t,["responseJsonSchema"]);if(a!=null&&d(e,["responseJsonSchema"],a),c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function G5(t,e){const n={},r=c(e,["name"]);return r!=null&&d(n,["_url","name"],br(t,r)),n}function z5(t,e){const n={},r=c(e,["name"]);return r!=null&&d(n,["_url","name"],br(t,r)),n}function $5(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function W5(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function q5(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&d(e,["_query","pageToken"],i),n}function J5(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&d(e,["_query","pageToken"],i),n}function j5(t){const e={},n=c(t,["config"]);return n!=null&&q5(n,e),e}function K5(t){const e={},n=c(t,["config"]);return n!=null&&J5(n,e),e}function Y5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),d(e,["cachedContents"],o)}return e}function Q5(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const i=c(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),d(e,["cachedContents"],o)}return e}function X5(t){const e={},n=c(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);const r=c(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&d(e,["executableCode"],i);const o=c(t,["fileData"]);o!=null&&d(e,["fileData"],F5(o));const s=c(t,["functionCall"]);s!=null&&d(e,["functionCall"],V5(s));const a=c(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);const l=c(t,["inlineData"]);l!=null&&d(e,["inlineData"],N5(l));const u=c(t,["text"]);u!=null&&d(e,["text"],u);const f=c(t,["thought"]);f!=null&&d(e,["thought"],f);const h=c(t,["thoughtSignature"]);h!=null&&d(e,["thoughtSignature"],h);const p=c(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function Z5(t){const e={},n=c(t,["retrievalConfig"]);n!=null&&d(e,["retrievalConfig"],n);const r=c(t,["functionCallingConfig"]);return r!=null&&d(e,["functionCallingConfig"],H5(r)),e}function e3(t){const e={};if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=c(t,["computerUse"]);n!=null&&d(e,["computerUse"],n);const r=c(t,["fileSearch"]);r!=null&&d(e,["fileSearch"],r);const i=c(t,["codeExecution"]);if(i!=null&&d(e,["codeExecution"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=c(t,["functionDeclarations"]);if(o!=null){let f=o;Array.isArray(f)&&(f=f.map(h=>h)),d(e,["functionDeclarations"],f)}const s=c(t,["googleMaps"]);s!=null&&d(e,["googleMaps"],$5(s));const a=c(t,["googleSearch"]);a!=null&&d(e,["googleSearch"],W5(a));const l=c(t,["googleSearchRetrieval"]);l!=null&&d(e,["googleSearchRetrieval"],l);const u=c(t,["urlContext"]);return u!=null&&d(e,["urlContext"],u),e}function t3(t){const e={},n=c(t,["retrieval"]);n!=null&&d(e,["retrieval"],n);const r=c(t,["computerUse"]);if(r!=null&&d(e,["computerUse"],r),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=c(t,["codeExecution"]);i!=null&&d(e,["codeExecution"],i);const o=c(t,["enterpriseWebSearch"]);o!=null&&d(e,["enterpriseWebSearch"],o);const s=c(t,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>B5(p))),d(e,["functionDeclarations"],h)}const a=c(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],a);const l=c(t,["googleSearch"]);l!=null&&d(e,["googleSearch"],l);const u=c(t,["googleSearchRetrieval"]);u!=null&&d(e,["googleSearchRetrieval"],u);const f=c(t,["urlContext"]);return f!=null&&d(e,["urlContext"],f),e}function n3(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&d(e,["expireTime"],i),n}function r3(t,e){const n={},r=c(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);const i=c(t,["expireTime"]);return e!==void 0&&i!=null&&d(e,["expireTime"],i),n}function i3(t,e){const n={},r=c(e,["name"]);r!=null&&d(n,["_url","name"],br(t,r));const i=c(e,["config"]);return i!=null&&n3(i,n),n}function o3(t,e){const n={},r=c(e,["name"]);r!=null&&d(n,["_url","name"],br(t,r));const i=c(e,["config"]);return i!=null&&r3(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class s3 extends kr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new fo(Cr.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=M5(this.apiClient,e);return a=H("cachedContents",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{const u=P5(this.apiClient,e);return a=H("cachedContents",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async get(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=z5(this.apiClient,e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{const u=G5(this.apiClient,e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async delete(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=L5(this.apiClient,e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=U5(f),p=new aw;return Object.assign(p,h),p})}else{const u=D5(this.apiClient,e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=O5(f),p=new aw;return Object.assign(p,h),p})}}async update(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=o3(this.apiClient,e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{const u=i3(this.apiClient,e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async listInternal(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=K5(e);return a=H("cachedContents",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=Q5(f),p=new lw;return Object.assign(p,h),p})}else{const u=j5(e);return a=H("cachedContents",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=Y5(f),p=new lw;return Object.assign(p,h),p})}}}function Fc(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function gw(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function X(t){return this instanceof X?(this.v=t,this):new X(t)}function Mn(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(m){return function(_){return Promise.resolve(_).then(m,h)}}function a(m,_){r[m]&&(i[m]=function(x){return new Promise(function(C,y){o.push([m,x,C,y])>1||l(m,x)})},_&&(i[m]=_(i[m])))}function l(m,_){try{u(r[m](_))}catch(x){p(o[0][3],x)}}function u(m){m.value instanceof X?Promise.resolve(m.value.v).then(f,h):p(o[0][2],m)}function f(m){l("next",m)}function h(m){l("throw",m)}function p(m,_){m(_),o.shift(),o.length&&l(o[0][0],o[0][1])}}function Dn(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof gw=="function"?gw(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){s=t[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function a3(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:EI(n)}function EI(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function l3(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function mw(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let o=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),o&&!EI(t[r])&&(o=!1),r++;o?e.push(...i):e.pop()}return e}class u3{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new c3(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class c3{constructor(e,n,r,i={},o=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=o,this.sendPromise=Promise.resolve(),l3(o)}async sendMessage(e){var n;await this.sendPromise;const r=_t(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,s,a;const l=await i,u=(s=(o=l.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content,f=l.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let p=[];f!=null&&(p=(a=f.slice(h))!==null&&a!==void 0?a:[]);const m=u?[u]:[];this.recordHistory(r,m,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=_t(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const o=await i;return this.processStreamResponse(o,r)}getHistory(e=!1){const n=e?mw(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return Mn(this,arguments,function*(){var i,o,s,a,l,u;const f=[];try{for(var h=!0,p=Dn(e),m;m=yield X(p.next()),i=m.done,!i;h=!0){a=m.value,h=!1;const _=a;if(a3(_)){const x=(u=(l=_.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content;x!==void 0&&f.push(x)}yield yield X(_)}}catch(_){o={error:_}}finally{try{!h&&!i&&(s=p.return)&&(yield X(s.call(p)))}finally{if(o)throw o.error}}this.recordHistory(n,f)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(o=>o.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...mw(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cl extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,cl.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function d3(t){const e={},n=c(t,["file"]);return n!=null&&d(e,["file"],n),e}function f3(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function h3(t){const e={},n=c(t,["name"]);return n!=null&&d(e,["_url","file"],gI(n)),e}function p3(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function g3(t){const e={},n=c(t,["name"]);return n!=null&&d(e,["_url","file"],gI(n)),e}function m3(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&d(e,["_query","pageToken"],i),n}function v3(t){const e={},n=c(t,["config"]);return n!=null&&m3(n,e),e}function y3(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const i=c(t,["files"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),d(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _3 extends kr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new fo(Cr.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=v3(e);return o=H("files",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=y3(l),f=new CV;return Object.assign(f,u),f})}}async createInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=d3(e);return o=H("upload/v1beta/files",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=f3(l),f=new SV;return Object.assign(f,u),f})}}async get(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=g3(e);return o=H("files/{file}",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=h3(e);return o=H("files/{file}",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=p3(l),f=new TV;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ou(t){const e={},n=c(t,["data"]);if(n!=null&&d(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function w3(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>O3(o))),d(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&d(e,["role"],r),e}function x3(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function E3(t){const e={},n=c(t,["id"]);n!=null&&d(e,["id"],n);const r=c(t,["args"]);r!=null&&d(e,["args"],r);const i=c(t,["name"]);if(i!=null&&d(e,["name"],i),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function C3(t){const e={},n=c(t,["description"]);n!=null&&d(e,["description"],n);const r=c(t,["name"]);r!=null&&d(e,["name"],r);const i=c(t,["parameters"]);i!=null&&d(e,["parameters"],i);const o=c(t,["parametersJsonSchema"]);o!=null&&d(e,["parametersJsonSchema"],o);const s=c(t,["response"]);s!=null&&d(e,["response"],s);const a=c(t,["responseJsonSchema"]);if(a!=null&&d(e,["responseJsonSchema"],a),c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function S3(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&d(e,["modelConfig"],n);const r=c(t,["responseJsonSchema"]);r!=null&&d(e,["responseJsonSchema"],r);const i=c(t,["audioTimestamp"]);i!=null&&d(e,["audioTimestamp"],i);const o=c(t,["candidateCount"]);o!=null&&d(e,["candidateCount"],o);const s=c(t,["enableAffectiveDialog"]);s!=null&&d(e,["enableAffectiveDialog"],s);const a=c(t,["frequencyPenalty"]);a!=null&&d(e,["frequencyPenalty"],a);const l=c(t,["logprobs"]);l!=null&&d(e,["logprobs"],l);const u=c(t,["maxOutputTokens"]);u!=null&&d(e,["maxOutputTokens"],u);const f=c(t,["mediaResolution"]);f!=null&&d(e,["mediaResolution"],f);const h=c(t,["presencePenalty"]);h!=null&&d(e,["presencePenalty"],h);const p=c(t,["responseLogprobs"]);p!=null&&d(e,["responseLogprobs"],p);const m=c(t,["responseMimeType"]);m!=null&&d(e,["responseMimeType"],m);const _=c(t,["responseModalities"]);_!=null&&d(e,["responseModalities"],_);const x=c(t,["responseSchema"]);x!=null&&d(e,["responseSchema"],x);const C=c(t,["routingConfig"]);C!=null&&d(e,["routingConfig"],C);const y=c(t,["seed"]);y!=null&&d(e,["seed"],y);const w=c(t,["speechConfig"]);w!=null&&d(e,["speechConfig"],w);const v=c(t,["stopSequences"]);v!=null&&d(e,["stopSequences"],v);const E=c(t,["temperature"]);E!=null&&d(e,["temperature"],E);const I=c(t,["thinkingConfig"]);I!=null&&d(e,["thinkingConfig"],I);const k=c(t,["topK"]);k!=null&&d(e,["topK"],k);const b=c(t,["topP"]);if(b!=null&&d(e,["topP"],b),c(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function T3(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function I3(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function k3(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig","responseModalities"],i);const o=c(t,["temperature"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","temperature"],o);const s=c(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);const a=c(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&d(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&d(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);const h=c(t,["speechConfig"]);e!==void 0&&h!=null&&d(e,["setup","generationConfig","speechConfig"],cv(h));const p=c(t,["thinkingConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","thinkingConfig"],p);const m=c(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],m);const _=c(t,["systemInstruction"]);e!==void 0&&_!=null&&d(e,["setup","systemInstruction"],w3(_t(_)));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let k=ks(x);Array.isArray(k)&&(k=k.map(b=>F3(Is(b)))),d(e,["setup","tools"],k)}const C=c(t,["sessionResumption"]);e!==void 0&&C!=null&&d(e,["setup","sessionResumption"],U3(C));const y=c(t,["inputAudioTranscription"]);e!==void 0&&y!=null&&d(e,["setup","inputAudioTranscription"],y);const w=c(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&d(e,["setup","outputAudioTranscription"],w);const v=c(t,["realtimeInputConfig"]);e!==void 0&&v!=null&&d(e,["setup","realtimeInputConfig"],v);const E=c(t,["contextWindowCompression"]);e!==void 0&&E!=null&&d(e,["setup","contextWindowCompression"],E);const I=c(t,["proactivity"]);if(e!==void 0&&I!=null&&d(e,["setup","proactivity"],I),c(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function b3(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig"],S3(r));const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig","responseModalities"],i);const o=c(t,["temperature"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","temperature"],o);const s=c(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);const a=c(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&d(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&d(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);const h=c(t,["speechConfig"]);e!==void 0&&h!=null&&d(e,["setup","generationConfig","speechConfig"],cv(h));const p=c(t,["thinkingConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","thinkingConfig"],p);const m=c(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],m);const _=c(t,["systemInstruction"]);e!==void 0&&_!=null&&d(e,["setup","systemInstruction"],_t(_));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let b=ks(x);Array.isArray(b)&&(b=b.map(T=>V3(Is(T)))),d(e,["setup","tools"],b)}const C=c(t,["sessionResumption"]);e!==void 0&&C!=null&&d(e,["setup","sessionResumption"],C);const y=c(t,["inputAudioTranscription"]);e!==void 0&&y!=null&&d(e,["setup","inputAudioTranscription"],y);const w=c(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&d(e,["setup","outputAudioTranscription"],w);const v=c(t,["realtimeInputConfig"]);e!==void 0&&v!=null&&d(e,["setup","realtimeInputConfig"],v);const E=c(t,["contextWindowCompression"]);e!==void 0&&E!=null&&d(e,["setup","contextWindowCompression"],E);const I=c(t,["proactivity"]);e!==void 0&&I!=null&&d(e,["setup","proactivity"],I);const k=c(t,["explicitVadSignal"]);return e!==void 0&&k!=null&&d(e,["setup","explicitVadSignal"],k),n}function N3(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["setup","model"],de(t,r));const i=c(e,["config"]);return i!=null&&d(n,["config"],k3(i,n)),n}function R3(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["setup","model"],de(t,r));const i=c(e,["config"]);return i!=null&&d(n,["config"],b3(i,n)),n}function A3(t){const e={},n=c(t,["musicGenerationConfig"]);return n!=null&&d(e,["musicGenerationConfig"],n),e}function P3(t){const e={},n=c(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),d(e,["weightedPrompts"],r)}return e}function M3(t){const e={},n=c(t,["media"]);if(n!=null){let u=cI(n);Array.isArray(u)&&(u=u.map(f=>Ou(f))),d(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&d(e,["audio"],Ou(fI(r)));const i=c(t,["audioStreamEnd"]);i!=null&&d(e,["audioStreamEnd"],i);const o=c(t,["video"]);o!=null&&d(e,["video"],Ou(dI(o)));const s=c(t,["text"]);s!=null&&d(e,["text"],s);const a=c(t,["activityStart"]);a!=null&&d(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&d(e,["activityEnd"],l),e}function D3(t){const e={},n=c(t,["media"]);if(n!=null){let u=cI(n);Array.isArray(u)&&(u=u.map(f=>f)),d(e,["mediaChunks"],u)}const r=c(t,["audio"]);r!=null&&d(e,["audio"],fI(r));const i=c(t,["audioStreamEnd"]);i!=null&&d(e,["audioStreamEnd"],i);const o=c(t,["video"]);o!=null&&d(e,["video"],dI(o));const s=c(t,["text"]);s!=null&&d(e,["text"],s);const a=c(t,["activityStart"]);a!=null&&d(e,["activityStart"],a);const l=c(t,["activityEnd"]);return l!=null&&d(e,["activityEnd"],l),e}function L3(t){const e={},n=c(t,["setupComplete"]);n!=null&&d(e,["setupComplete"],n);const r=c(t,["serverContent"]);r!=null&&d(e,["serverContent"],r);const i=c(t,["toolCall"]);i!=null&&d(e,["toolCall"],i);const o=c(t,["toolCallCancellation"]);o!=null&&d(e,["toolCallCancellation"],o);const s=c(t,["usageMetadata"]);s!=null&&d(e,["usageMetadata"],H3(s));const a=c(t,["goAway"]);a!=null&&d(e,["goAway"],a);const l=c(t,["sessionResumptionUpdate"]);l!=null&&d(e,["sessionResumptionUpdate"],l);const u=c(t,["voiceActivityDetectionSignal"]);u!=null&&d(e,["voiceActivityDetectionSignal"],u);const f=c(t,["voiceActivity"]);return f!=null&&d(e,["voiceActivity"],B3(f)),e}function O3(t){const e={},n=c(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);const r=c(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&d(e,["executableCode"],i);const o=c(t,["fileData"]);o!=null&&d(e,["fileData"],x3(o));const s=c(t,["functionCall"]);s!=null&&d(e,["functionCall"],E3(s));const a=c(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);const l=c(t,["inlineData"]);l!=null&&d(e,["inlineData"],Ou(l));const u=c(t,["text"]);u!=null&&d(e,["text"],u);const f=c(t,["thought"]);f!=null&&d(e,["thought"],f);const h=c(t,["thoughtSignature"]);h!=null&&d(e,["thoughtSignature"],h);const p=c(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function U3(t){const e={},n=c(t,["handle"]);if(n!=null&&d(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function F3(t){const e={};if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=c(t,["computerUse"]);n!=null&&d(e,["computerUse"],n);const r=c(t,["fileSearch"]);r!=null&&d(e,["fileSearch"],r);const i=c(t,["codeExecution"]);if(i!=null&&d(e,["codeExecution"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=c(t,["functionDeclarations"]);if(o!=null){let f=o;Array.isArray(f)&&(f=f.map(h=>h)),d(e,["functionDeclarations"],f)}const s=c(t,["googleMaps"]);s!=null&&d(e,["googleMaps"],T3(s));const a=c(t,["googleSearch"]);a!=null&&d(e,["googleSearch"],I3(a));const l=c(t,["googleSearchRetrieval"]);l!=null&&d(e,["googleSearchRetrieval"],l);const u=c(t,["urlContext"]);return u!=null&&d(e,["urlContext"],u),e}function V3(t){const e={},n=c(t,["retrieval"]);n!=null&&d(e,["retrieval"],n);const r=c(t,["computerUse"]);if(r!=null&&d(e,["computerUse"],r),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=c(t,["codeExecution"]);i!=null&&d(e,["codeExecution"],i);const o=c(t,["enterpriseWebSearch"]);o!=null&&d(e,["enterpriseWebSearch"],o);const s=c(t,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>C3(p))),d(e,["functionDeclarations"],h)}const a=c(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],a);const l=c(t,["googleSearch"]);l!=null&&d(e,["googleSearch"],l);const u=c(t,["googleSearchRetrieval"]);u!=null&&d(e,["googleSearchRetrieval"],u);const f=c(t,["urlContext"]);return f!=null&&d(e,["urlContext"],f),e}function H3(t){const e={},n=c(t,["promptTokenCount"]);n!=null&&d(e,["promptTokenCount"],n);const r=c(t,["cachedContentTokenCount"]);r!=null&&d(e,["cachedContentTokenCount"],r);const i=c(t,["candidatesTokenCount"]);i!=null&&d(e,["responseTokenCount"],i);const o=c(t,["toolUsePromptTokenCount"]);o!=null&&d(e,["toolUsePromptTokenCount"],o);const s=c(t,["thoughtsTokenCount"]);s!=null&&d(e,["thoughtsTokenCount"],s);const a=c(t,["totalTokenCount"]);a!=null&&d(e,["totalTokenCount"],a);const l=c(t,["promptTokensDetails"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(_=>_)),d(e,["promptTokensDetails"],m)}const u=c(t,["cacheTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(_=>_)),d(e,["cacheTokensDetails"],m)}const f=c(t,["candidatesTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(_=>_)),d(e,["responseTokensDetails"],m)}const h=c(t,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(_=>_)),d(e,["toolUsePromptTokensDetails"],m)}const p=c(t,["trafficType"]);return p!=null&&d(e,["trafficType"],p),e}function B3(t){const e={},n=c(t,["type"]);return n!=null&&d(e,["voiceActivityType"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function G3(t){const e={},n=c(t,["data"]);if(n!=null&&d(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function z3(t){const e={},n=c(t,["content"]);n!=null&&d(e,["content"],n);const r=c(t,["citationMetadata"]);r!=null&&d(e,["citationMetadata"],$3(r));const i=c(t,["tokenCount"]);i!=null&&d(e,["tokenCount"],i);const o=c(t,["finishReason"]);o!=null&&d(e,["finishReason"],o);const s=c(t,["avgLogprobs"]);s!=null&&d(e,["avgLogprobs"],s);const a=c(t,["groundingMetadata"]);a!=null&&d(e,["groundingMetadata"],a);const l=c(t,["index"]);l!=null&&d(e,["index"],l);const u=c(t,["logprobsResult"]);u!=null&&d(e,["logprobsResult"],u);const f=c(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),d(e,["safetyRatings"],p)}const h=c(t,["urlContextMetadata"]);return h!=null&&d(e,["urlContextMetadata"],h),e}function $3(t){const e={},n=c(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),d(e,["citations"],r)}return e}function W3(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["contents"]);if(i!=null){let o=gn(i);Array.isArray(o)&&(o=o.map(s=>s)),d(n,["contents"],o)}return n}function q3(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),d(e,["tokensInfo"],i)}return e}function J3(t){const e={},n=c(t,["values"]);n!=null&&d(e,["values"],n);const r=c(t,["statistics"]);return r!=null&&d(e,["statistics"],j3(r)),e}function j3(t){const e={},n=c(t,["truncated"]);n!=null&&d(e,["truncated"],n);const r=c(t,["token_count"]);return r!=null&&d(e,["tokenCount"],r),e}function Vd(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>rB(o))),d(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&d(e,["role"],r),e}function K3(t){const e={},n=c(t,["controlType"]);n!=null&&d(e,["controlType"],n);const r=c(t,["enableControlImageComputation"]);return r!=null&&d(e,["computeControl"],r),e}function Y3(t){const e={};if(c(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Q3(t,e){const n={},r=c(t,["systemInstruction"]);e!==void 0&&r!=null&&d(e,["systemInstruction"],_t(r));const i=c(t,["tools"]);if(e!==void 0&&i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>II(a))),d(e,["tools"],s)}const o=c(t,["generationConfig"]);return e!==void 0&&o!=null&&d(e,["generationConfig"],GH(o)),n}function X3(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["contents"]);if(i!=null){let s=gn(i);Array.isArray(s)&&(s=s.map(a=>Vd(a))),d(n,["contents"],s)}const o=c(e,["config"]);return o!=null&&Y3(o),n}function Z3(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["contents"]);if(i!=null){let s=gn(i);Array.isArray(s)&&(s=s.map(a=>a)),d(n,["contents"],s)}const o=c(e,["config"]);return o!=null&&Q3(o,n),n}function eH(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);r!=null&&d(e,["totalTokens"],r);const i=c(t,["cachedContentTokenCount"]);return i!=null&&d(e,["cachedContentTokenCount"],i),e}function tH(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["totalTokens"]);return r!=null&&d(e,["totalTokens"],r),e}function nH(t,e){const n={},r=c(e,["model"]);return r!=null&&d(n,["_url","name"],de(t,r)),n}function rH(t,e){const n={},r=c(e,["model"]);return r!=null&&d(n,["_url","name"],de(t,r)),n}function iH(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function oH(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function sH(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&d(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&d(e,["parameters","negativePrompt"],i);const o=c(t,["numberOfImages"]);e!==void 0&&o!=null&&d(e,["parameters","sampleCount"],o);const s=c(t,["aspectRatio"]);e!==void 0&&s!=null&&d(e,["parameters","aspectRatio"],s);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&d(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&d(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&d(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);const h=c(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&d(e,["parameters","includeSafetyAttributes"],h);const p=c(t,["includeRaiReason"]);e!==void 0&&p!=null&&d(e,["parameters","includeRaiReason"],p);const m=c(t,["language"]);e!==void 0&&m!=null&&d(e,["parameters","language"],m);const _=c(t,["outputMimeType"]);e!==void 0&&_!=null&&d(e,["parameters","outputOptions","mimeType"],_);const x=c(t,["outputCompressionQuality"]);e!==void 0&&x!=null&&d(e,["parameters","outputOptions","compressionQuality"],x);const C=c(t,["addWatermark"]);e!==void 0&&C!=null&&d(e,["parameters","addWatermark"],C);const y=c(t,["labels"]);e!==void 0&&y!=null&&d(e,["labels"],y);const w=c(t,["editMode"]);e!==void 0&&w!=null&&d(e,["parameters","editMode"],w);const v=c(t,["baseSteps"]);return e!==void 0&&v!=null&&d(e,["parameters","editConfig","baseSteps"],v),n}function aH(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const o=c(e,["referenceImages"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>uB(l))),d(n,["instances[0]","referenceImages"],a)}const s=c(e,["config"]);return s!=null&&sH(s,n),n}function lH(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Hd(o))),d(e,["generatedImages"],i)}return e}function uH(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&d(e,["requests[]","taskType"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&d(e,["requests[]","title"],i);const o=c(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&d(e,["requests[]","outputDimensionality"],o),c(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function cH(t,e){const n={},r=c(t,["taskType"]);e!==void 0&&r!=null&&d(e,["instances[]","task_type"],r);const i=c(t,["title"]);e!==void 0&&i!=null&&d(e,["instances[]","title"],i);const o=c(t,["outputDimensionality"]);e!==void 0&&o!=null&&d(e,["parameters","outputDimensionality"],o);const s=c(t,["mimeType"]);e!==void 0&&s!=null&&d(e,["instances[]","mimeType"],s);const a=c(t,["autoTruncate"]);return e!==void 0&&a!=null&&d(e,["parameters","autoTruncate"],a),n}function dH(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["contents"]);if(i!=null){let a=av(t,i);Array.isArray(a)&&(a=a.map(l=>l)),d(n,["requests[]","content"],a)}const o=c(e,["config"]);o!=null&&uH(o,n);const s=c(e,["model"]);return s!==void 0&&d(n,["requests[]","model"],de(t,s)),n}function fH(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["contents"]);if(i!=null){let s=av(t,i);Array.isArray(s)&&(s=s.map(a=>a)),d(n,["instances[]","content"],s)}const o=c(e,["config"]);return o!=null&&cH(o,n),n}function hH(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),d(e,["embeddings"],o)}const i=c(t,["metadata"]);return i!=null&&d(e,["metadata"],i),e}function pH(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>J3(s))),d(e,["embeddings"],o)}const i=c(t,["metadata"]);return i!=null&&d(e,["metadata"],i),e}function gH(t){const e={},n=c(t,["endpoint"]);n!=null&&d(e,["name"],n);const r=c(t,["deployedModelId"]);return r!=null&&d(e,["deployedModelId"],r),e}function mH(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function vH(t){const e={},n=c(t,["id"]);n!=null&&d(e,["id"],n);const r=c(t,["args"]);r!=null&&d(e,["args"],r);const i=c(t,["name"]);if(i!=null&&d(e,["name"],i),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function yH(t){const e={},n=c(t,["allowedFunctionNames"]);n!=null&&d(e,["allowedFunctionNames"],n);const r=c(t,["mode"]);if(r!=null&&d(e,["mode"],r),c(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function _H(t){const e={},n=c(t,["description"]);n!=null&&d(e,["description"],n);const r=c(t,["name"]);r!=null&&d(e,["name"],r);const i=c(t,["parameters"]);i!=null&&d(e,["parameters"],i);const o=c(t,["parametersJsonSchema"]);o!=null&&d(e,["parametersJsonSchema"],o);const s=c(t,["response"]);s!=null&&d(e,["response"],s);const a=c(t,["responseJsonSchema"]);if(a!=null&&d(e,["responseJsonSchema"],a),c(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function wH(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&d(n,["systemInstruction"],Vd(_t(i)));const o=c(e,["temperature"]);o!=null&&d(r,["temperature"],o);const s=c(e,["topP"]);s!=null&&d(r,["topP"],s);const a=c(e,["topK"]);a!=null&&d(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&d(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&d(r,["stopSequences"],f);const h=c(e,["responseLogprobs"]);h!=null&&d(r,["responseLogprobs"],h);const p=c(e,["logprobs"]);p!=null&&d(r,["logprobs"],p);const m=c(e,["presencePenalty"]);m!=null&&d(r,["presencePenalty"],m);const _=c(e,["frequencyPenalty"]);_!=null&&d(r,["frequencyPenalty"],_);const x=c(e,["seed"]);x!=null&&d(r,["seed"],x);const C=c(e,["responseMimeType"]);C!=null&&d(r,["responseMimeType"],C);const y=c(e,["responseSchema"]);y!=null&&d(r,["responseSchema"],lv(y));const w=c(e,["responseJsonSchema"]);if(w!=null&&d(r,["responseJsonSchema"],w),c(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const v=c(e,["safetySettings"]);if(n!==void 0&&v!=null){let F=v;Array.isArray(F)&&(F=F.map(J=>cB(J))),d(n,["safetySettings"],F)}const E=c(e,["tools"]);if(n!==void 0&&E!=null){let F=ks(E);Array.isArray(F)&&(F=F.map(J=>vB(Is(J)))),d(n,["tools"],F)}const I=c(e,["toolConfig"]);if(n!==void 0&&I!=null&&d(n,["toolConfig"],mB(I)),c(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=c(e,["cachedContent"]);n!==void 0&&k!=null&&d(n,["cachedContent"],br(t,k));const b=c(e,["responseModalities"]);b!=null&&d(r,["responseModalities"],b);const T=c(e,["mediaResolution"]);T!=null&&d(r,["mediaResolution"],T);const R=c(e,["speechConfig"]);if(R!=null&&d(r,["speechConfig"],uv(R)),c(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=c(e,["thinkingConfig"]);N!=null&&d(r,["thinkingConfig"],N);const D=c(e,["imageConfig"]);D!=null&&d(r,["imageConfig"],JH(D));const G=c(e,["enableEnhancedCivicAnswers"]);if(G!=null&&d(r,["enableEnhancedCivicAnswers"],G),c(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function xH(t,e,n){const r={},i=c(e,["systemInstruction"]);n!==void 0&&i!=null&&d(n,["systemInstruction"],_t(i));const o=c(e,["temperature"]);o!=null&&d(r,["temperature"],o);const s=c(e,["topP"]);s!=null&&d(r,["topP"],s);const a=c(e,["topK"]);a!=null&&d(r,["topK"],a);const l=c(e,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);const u=c(e,["maxOutputTokens"]);u!=null&&d(r,["maxOutputTokens"],u);const f=c(e,["stopSequences"]);f!=null&&d(r,["stopSequences"],f);const h=c(e,["responseLogprobs"]);h!=null&&d(r,["responseLogprobs"],h);const p=c(e,["logprobs"]);p!=null&&d(r,["logprobs"],p);const m=c(e,["presencePenalty"]);m!=null&&d(r,["presencePenalty"],m);const _=c(e,["frequencyPenalty"]);_!=null&&d(r,["frequencyPenalty"],_);const x=c(e,["seed"]);x!=null&&d(r,["seed"],x);const C=c(e,["responseMimeType"]);C!=null&&d(r,["responseMimeType"],C);const y=c(e,["responseSchema"]);y!=null&&d(r,["responseSchema"],lv(y));const w=c(e,["responseJsonSchema"]);w!=null&&d(r,["responseJsonSchema"],w);const v=c(e,["routingConfig"]);v!=null&&d(r,["routingConfig"],v);const E=c(e,["modelSelectionConfig"]);E!=null&&d(r,["modelConfig"],E);const I=c(e,["safetySettings"]);if(n!==void 0&&I!=null){let ee=I;Array.isArray(ee)&&(ee=ee.map(V=>V)),d(n,["safetySettings"],ee)}const k=c(e,["tools"]);if(n!==void 0&&k!=null){let ee=ks(k);Array.isArray(ee)&&(ee=ee.map(V=>II(Is(V)))),d(n,["tools"],ee)}const b=c(e,["toolConfig"]);n!==void 0&&b!=null&&d(n,["toolConfig"],b);const T=c(e,["labels"]);n!==void 0&&T!=null&&d(n,["labels"],T);const R=c(e,["cachedContent"]);n!==void 0&&R!=null&&d(n,["cachedContent"],br(t,R));const N=c(e,["responseModalities"]);N!=null&&d(r,["responseModalities"],N);const D=c(e,["mediaResolution"]);D!=null&&d(r,["mediaResolution"],D);const G=c(e,["speechConfig"]);G!=null&&d(r,["speechConfig"],uv(G));const F=c(e,["audioTimestamp"]);F!=null&&d(r,["audioTimestamp"],F);const J=c(e,["thinkingConfig"]);J!=null&&d(r,["thinkingConfig"],J);const re=c(e,["imageConfig"]);if(re!=null&&d(r,["imageConfig"],jH(re)),c(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const Oe=c(e,["modelArmorConfig"]);return n!==void 0&&Oe!=null&&d(n,["modelArmorConfig"],Oe),r}function vw(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["contents"]);if(i!=null){let s=gn(i);Array.isArray(s)&&(s=s.map(a=>Vd(a))),d(n,["contents"],s)}const o=c(e,["config"]);return o!=null&&d(n,["generationConfig"],wH(t,o,n)),n}function yw(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["contents"]);if(i!=null){let s=gn(i);Array.isArray(s)&&(s=s.map(a=>a)),d(n,["contents"],s)}const o=c(e,["config"]);return o!=null&&d(n,["generationConfig"],xH(t,o,n)),n}function _w(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>z3(u))),d(e,["candidates"],l)}const i=c(t,["modelVersion"]);i!=null&&d(e,["modelVersion"],i);const o=c(t,["promptFeedback"]);o!=null&&d(e,["promptFeedback"],o);const s=c(t,["responseId"]);s!=null&&d(e,["responseId"],s);const a=c(t,["usageMetadata"]);return a!=null&&d(e,["usageMetadata"],a),e}function ww(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>f)),d(e,["candidates"],u)}const i=c(t,["createTime"]);i!=null&&d(e,["createTime"],i);const o=c(t,["modelVersion"]);o!=null&&d(e,["modelVersion"],o);const s=c(t,["promptFeedback"]);s!=null&&d(e,["promptFeedback"],s);const a=c(t,["responseId"]);a!=null&&d(e,["responseId"],a);const l=c(t,["usageMetadata"]);return l!=null&&d(e,["usageMetadata"],l),e}function EH(t,e){const n={};if(c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r);const i=c(t,["aspectRatio"]);e!==void 0&&i!=null&&d(e,["parameters","aspectRatio"],i);const o=c(t,["guidanceScale"]);if(e!==void 0&&o!=null&&d(e,["parameters","guidanceScale"],o),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=c(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&d(e,["parameters","safetySetting"],s);const a=c(t,["personGeneration"]);e!==void 0&&a!=null&&d(e,["parameters","personGeneration"],a);const l=c(t,["includeSafetyAttributes"]);e!==void 0&&l!=null&&d(e,["parameters","includeSafetyAttributes"],l);const u=c(t,["includeRaiReason"]);e!==void 0&&u!=null&&d(e,["parameters","includeRaiReason"],u);const f=c(t,["language"]);e!==void 0&&f!=null&&d(e,["parameters","language"],f);const h=c(t,["outputMimeType"]);e!==void 0&&h!=null&&d(e,["parameters","outputOptions","mimeType"],h);const p=c(t,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&d(e,["parameters","outputOptions","compressionQuality"],p),c(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const m=c(t,["imageSize"]);if(e!==void 0&&m!=null&&d(e,["parameters","sampleImageSize"],m),c(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function CH(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&d(e,["parameters","storageUri"],r);const i=c(t,["negativePrompt"]);e!==void 0&&i!=null&&d(e,["parameters","negativePrompt"],i);const o=c(t,["numberOfImages"]);e!==void 0&&o!=null&&d(e,["parameters","sampleCount"],o);const s=c(t,["aspectRatio"]);e!==void 0&&s!=null&&d(e,["parameters","aspectRatio"],s);const a=c(t,["guidanceScale"]);e!==void 0&&a!=null&&d(e,["parameters","guidanceScale"],a);const l=c(t,["seed"]);e!==void 0&&l!=null&&d(e,["parameters","seed"],l);const u=c(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&d(e,["parameters","safetySetting"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);const h=c(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&d(e,["parameters","includeSafetyAttributes"],h);const p=c(t,["includeRaiReason"]);e!==void 0&&p!=null&&d(e,["parameters","includeRaiReason"],p);const m=c(t,["language"]);e!==void 0&&m!=null&&d(e,["parameters","language"],m);const _=c(t,["outputMimeType"]);e!==void 0&&_!=null&&d(e,["parameters","outputOptions","mimeType"],_);const x=c(t,["outputCompressionQuality"]);e!==void 0&&x!=null&&d(e,["parameters","outputOptions","compressionQuality"],x);const C=c(t,["addWatermark"]);e!==void 0&&C!=null&&d(e,["parameters","addWatermark"],C);const y=c(t,["labels"]);e!==void 0&&y!=null&&d(e,["labels"],y);const w=c(t,["imageSize"]);e!==void 0&&w!=null&&d(e,["parameters","sampleImageSize"],w);const v=c(t,["enhancePrompt"]);return e!==void 0&&v!=null&&d(e,["parameters","enhancePrompt"],v),n}function SH(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const o=c(e,["config"]);return o!=null&&EH(o,n),n}function TH(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const o=c(e,["config"]);return o!=null&&CH(o,n),n}function IH(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>FH(s))),d(e,["generatedImages"],o)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&d(e,["positivePromptSafetyAttributes"],SI(i)),e}function kH(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Hd(s))),d(e,["generatedImages"],o)}const i=c(t,["positivePromptSafetyAttributes"]);return i!=null&&d(e,["positivePromptSafetyAttributes"],TI(i)),e}function bH(t,e){const n={},r=c(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r),c(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=c(t,["durationSeconds"]);if(e!==void 0&&i!=null&&d(e,["parameters","durationSeconds"],i),c(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(t,["aspectRatio"]);e!==void 0&&o!=null&&d(e,["parameters","aspectRatio"],o);const s=c(t,["resolution"]);e!==void 0&&s!=null&&d(e,["parameters","resolution"],s);const a=c(t,["personGeneration"]);if(e!==void 0&&a!=null&&d(e,["parameters","personGeneration"],a),c(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=c(t,["negativePrompt"]);e!==void 0&&l!=null&&d(e,["parameters","negativePrompt"],l);const u=c(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&d(e,["parameters","enhancePrompt"],u),c(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=c(t,["lastFrame"]);e!==void 0&&f!=null&&d(e,["instances[0]","lastFrame"],Bd(f));const h=c(t,["referenceImages"]);if(e!==void 0&&h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>RB(m))),d(e,["instances[0]","referenceImages"],p)}if(c(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(c(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function NH(t,e){const n={},r=c(t,["numberOfVideos"]);e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r);const i=c(t,["outputGcsUri"]);e!==void 0&&i!=null&&d(e,["parameters","storageUri"],i);const o=c(t,["fps"]);e!==void 0&&o!=null&&d(e,["parameters","fps"],o);const s=c(t,["durationSeconds"]);e!==void 0&&s!=null&&d(e,["parameters","durationSeconds"],s);const a=c(t,["seed"]);e!==void 0&&a!=null&&d(e,["parameters","seed"],a);const l=c(t,["aspectRatio"]);e!==void 0&&l!=null&&d(e,["parameters","aspectRatio"],l);const u=c(t,["resolution"]);e!==void 0&&u!=null&&d(e,["parameters","resolution"],u);const f=c(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);const h=c(t,["pubsubTopic"]);e!==void 0&&h!=null&&d(e,["parameters","pubsubTopic"],h);const p=c(t,["negativePrompt"]);e!==void 0&&p!=null&&d(e,["parameters","negativePrompt"],p);const m=c(t,["enhancePrompt"]);e!==void 0&&m!=null&&d(e,["parameters","enhancePrompt"],m);const _=c(t,["generateAudio"]);e!==void 0&&_!=null&&d(e,["parameters","generateAudio"],_);const x=c(t,["lastFrame"]);e!==void 0&&x!=null&&d(e,["instances[0]","lastFrame"],Vn(x));const C=c(t,["referenceImages"]);if(e!==void 0&&C!=null){let v=C;Array.isArray(v)&&(v=v.map(E=>AB(E))),d(e,["instances[0]","referenceImages"],v)}const y=c(t,["mask"]);e!==void 0&&y!=null&&d(e,["instances[0]","mask"],NB(y));const w=c(t,["compressionQuality"]);return e!==void 0&&w!=null&&d(e,["parameters","compressionQuality"],w),n}function RH(t){const e={},n=c(t,["name"]);n!=null&&d(e,["name"],n);const r=c(t,["metadata"]);r!=null&&d(e,["metadata"],r);const i=c(t,["done"]);i!=null&&d(e,["done"],i);const o=c(t,["error"]);o!=null&&d(e,["error"],o);const s=c(t,["response","generateVideoResponse"]);return s!=null&&d(e,["response"],DH(s)),e}function AH(t){const e={},n=c(t,["name"]);n!=null&&d(e,["name"],n);const r=c(t,["metadata"]);r!=null&&d(e,["metadata"],r);const i=c(t,["done"]);i!=null&&d(e,["done"],i);const o=c(t,["error"]);o!=null&&d(e,["error"],o);const s=c(t,["response"]);return s!=null&&d(e,["response"],LH(s)),e}function PH(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const o=c(e,["image"]);o!=null&&d(n,["instances[0]","image"],Bd(o));const s=c(e,["video"]);s!=null&&d(n,["instances[0]","video"],kI(s));const a=c(e,["source"]);a!=null&&OH(a,n);const l=c(e,["config"]);return l!=null&&bH(l,n),n}function MH(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const o=c(e,["image"]);o!=null&&d(n,["instances[0]","image"],Vn(o));const s=c(e,["video"]);s!=null&&d(n,["instances[0]","video"],bI(s));const a=c(e,["source"]);a!=null&&UH(a,n);const l=c(e,["config"]);return l!=null&&NH(l,n),n}function DH(t){const e={},n=c(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>HH(s))),d(e,["generatedVideos"],o)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&d(e,["raiMediaFilteredReasons"],i),e}function LH(t){const e={},n=c(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>BH(s))),d(e,["generatedVideos"],o)}const r=c(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);const i=c(t,["raiMediaFilteredReasons"]);return i!=null&&d(e,["raiMediaFilteredReasons"],i),e}function OH(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&d(e,["instances[0]","image"],Bd(i));const o=c(t,["video"]);return e!==void 0&&o!=null&&d(e,["instances[0]","video"],kI(o)),n}function UH(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&d(e,["instances[0]","image"],Vn(i));const o=c(t,["video"]);return e!==void 0&&o!=null&&d(e,["instances[0]","video"],bI(o)),n}function FH(t){const e={},n=c(t,["_self"]);n!=null&&d(e,["image"],KH(n));const r=c(t,["raiFilteredReason"]);r!=null&&d(e,["raiFilteredReason"],r);const i=c(t,["_self"]);return i!=null&&d(e,["safetyAttributes"],SI(i)),e}function Hd(t){const e={},n=c(t,["_self"]);n!=null&&d(e,["image"],CI(n));const r=c(t,["raiFilteredReason"]);r!=null&&d(e,["raiFilteredReason"],r);const i=c(t,["_self"]);i!=null&&d(e,["safetyAttributes"],TI(i));const o=c(t,["prompt"]);return o!=null&&d(e,["enhancedPrompt"],o),e}function VH(t){const e={},n=c(t,["_self"]);n!=null&&d(e,["mask"],CI(n));const r=c(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),d(e,["labels"],i)}return e}function HH(t){const e={},n=c(t,["video"]);return n!=null&&d(e,["video"],kB(n)),e}function BH(t){const e={},n=c(t,["_self"]);return n!=null&&d(e,["video"],bB(n)),e}function GH(t){const e={},n=c(t,["modelSelectionConfig"]);n!=null&&d(e,["modelConfig"],n);const r=c(t,["responseJsonSchema"]);r!=null&&d(e,["responseJsonSchema"],r);const i=c(t,["audioTimestamp"]);i!=null&&d(e,["audioTimestamp"],i);const o=c(t,["candidateCount"]);o!=null&&d(e,["candidateCount"],o);const s=c(t,["enableAffectiveDialog"]);s!=null&&d(e,["enableAffectiveDialog"],s);const a=c(t,["frequencyPenalty"]);a!=null&&d(e,["frequencyPenalty"],a);const l=c(t,["logprobs"]);l!=null&&d(e,["logprobs"],l);const u=c(t,["maxOutputTokens"]);u!=null&&d(e,["maxOutputTokens"],u);const f=c(t,["mediaResolution"]);f!=null&&d(e,["mediaResolution"],f);const h=c(t,["presencePenalty"]);h!=null&&d(e,["presencePenalty"],h);const p=c(t,["responseLogprobs"]);p!=null&&d(e,["responseLogprobs"],p);const m=c(t,["responseMimeType"]);m!=null&&d(e,["responseMimeType"],m);const _=c(t,["responseModalities"]);_!=null&&d(e,["responseModalities"],_);const x=c(t,["responseSchema"]);x!=null&&d(e,["responseSchema"],x);const C=c(t,["routingConfig"]);C!=null&&d(e,["routingConfig"],C);const y=c(t,["seed"]);y!=null&&d(e,["seed"],y);const w=c(t,["speechConfig"]);w!=null&&d(e,["speechConfig"],w);const v=c(t,["stopSequences"]);v!=null&&d(e,["stopSequences"],v);const E=c(t,["temperature"]);E!=null&&d(e,["temperature"],E);const I=c(t,["thinkingConfig"]);I!=null&&d(e,["thinkingConfig"],I);const k=c(t,["topK"]);k!=null&&d(e,["topK"],k);const b=c(t,["topP"]);if(b!=null&&d(e,["topP"],b),c(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function zH(t,e){const n={},r=c(e,["model"]);return r!=null&&d(n,["_url","name"],de(t,r)),n}function $H(t,e){const n={},r=c(e,["model"]);return r!=null&&d(n,["_url","name"],de(t,r)),n}function WH(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function qH(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function JH(t){const e={},n=c(t,["aspectRatio"]);n!=null&&d(e,["aspectRatio"],n);const r=c(t,["imageSize"]);if(r!=null&&d(e,["imageSize"],r),c(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(c(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(c(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function jH(t){const e={},n=c(t,["aspectRatio"]);n!=null&&d(e,["aspectRatio"],n);const r=c(t,["imageSize"]);r!=null&&d(e,["imageSize"],r);const i=c(t,["personGeneration"]);i!=null&&d(e,["personGeneration"],i);const o=c(t,["outputMimeType"]);o!=null&&d(e,["imageOutputOptions","mimeType"],o);const s=c(t,["outputCompressionQuality"]);return s!=null&&d(e,["imageOutputOptions","compressionQuality"],s),e}function KH(t){const e={},n=c(t,["bytesBase64Encoded"]);n!=null&&d(e,["imageBytes"],Ei(n));const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function CI(t){const e={},n=c(t,["gcsUri"]);n!=null&&d(e,["gcsUri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&d(e,["imageBytes"],Ei(r));const i=c(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function Bd(t){const e={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(t,["imageBytes"]);n!=null&&d(e,["bytesBase64Encoded"],Ei(n));const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function Vn(t){const e={},n=c(t,["gcsUri"]);n!=null&&d(e,["gcsUri"],n);const r=c(t,["imageBytes"]);r!=null&&d(e,["bytesBase64Encoded"],Ei(r));const i=c(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function YH(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&d(n,["_query","pageSize"],i);const o=c(e,["pageToken"]);n!==void 0&&o!=null&&d(n,["_query","pageToken"],o);const s=c(e,["filter"]);n!==void 0&&s!=null&&d(n,["_query","filter"],s);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&d(n,["_url","models_url"],mI(t,a)),r}function QH(t,e,n){const r={},i=c(e,["pageSize"]);n!==void 0&&i!=null&&d(n,["_query","pageSize"],i);const o=c(e,["pageToken"]);n!==void 0&&o!=null&&d(n,["_query","pageToken"],o);const s=c(e,["filter"]);n!==void 0&&s!=null&&d(n,["_query","filter"],s);const a=c(e,["queryBase"]);return n!==void 0&&a!=null&&d(n,["_url","models_url"],mI(t,a)),r}function XH(t,e){const n={},r=c(e,["config"]);return r!=null&&YH(t,r,n),n}function ZH(t,e){const n={},r=c(e,["config"]);return r!=null&&QH(t,r,n),n}function eB(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let o=vI(i);Array.isArray(o)&&(o=o.map(s=>Lp(s))),d(e,["models"],o)}return e}function tB(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const i=c(t,["_self"]);if(i!=null){let o=vI(i);Array.isArray(o)&&(o=o.map(s=>Op(s))),d(e,["models"],o)}return e}function nB(t){const e={},n=c(t,["maskMode"]);n!=null&&d(e,["maskMode"],n);const r=c(t,["segmentationClasses"]);r!=null&&d(e,["maskClasses"],r);const i=c(t,["maskDilation"]);return i!=null&&d(e,["dilation"],i),e}function Lp(t){const e={},n=c(t,["name"]);n!=null&&d(e,["name"],n);const r=c(t,["displayName"]);r!=null&&d(e,["displayName"],r);const i=c(t,["description"]);i!=null&&d(e,["description"],i);const o=c(t,["version"]);o!=null&&d(e,["version"],o);const s=c(t,["_self"]);s!=null&&d(e,["tunedModelInfo"],yB(s));const a=c(t,["inputTokenLimit"]);a!=null&&d(e,["inputTokenLimit"],a);const l=c(t,["outputTokenLimit"]);l!=null&&d(e,["outputTokenLimit"],l);const u=c(t,["supportedGenerationMethods"]);u!=null&&d(e,["supportedActions"],u);const f=c(t,["temperature"]);f!=null&&d(e,["temperature"],f);const h=c(t,["maxTemperature"]);h!=null&&d(e,["maxTemperature"],h);const p=c(t,["topP"]);p!=null&&d(e,["topP"],p);const m=c(t,["topK"]);m!=null&&d(e,["topK"],m);const _=c(t,["thinking"]);return _!=null&&d(e,["thinking"],_),e}function Op(t){const e={},n=c(t,["name"]);n!=null&&d(e,["name"],n);const r=c(t,["displayName"]);r!=null&&d(e,["displayName"],r);const i=c(t,["description"]);i!=null&&d(e,["description"],i);const o=c(t,["versionId"]);o!=null&&d(e,["version"],o);const s=c(t,["deployedModels"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>gH(p))),d(e,["endpoints"],h)}const a=c(t,["labels"]);a!=null&&d(e,["labels"],a);const l=c(t,["_self"]);l!=null&&d(e,["tunedModelInfo"],_B(l));const u=c(t,["defaultCheckpointId"]);u!=null&&d(e,["defaultCheckpointId"],u);const f=c(t,["checkpoints"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(p=>p)),d(e,["checkpoints"],h)}return e}function rB(t){const e={},n=c(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);const r=c(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&d(e,["executableCode"],i);const o=c(t,["fileData"]);o!=null&&d(e,["fileData"],mH(o));const s=c(t,["functionCall"]);s!=null&&d(e,["functionCall"],vH(s));const a=c(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);const l=c(t,["inlineData"]);l!=null&&d(e,["inlineData"],G3(l));const u=c(t,["text"]);u!=null&&d(e,["text"],u);const f=c(t,["thought"]);f!=null&&d(e,["thought"],f);const h=c(t,["thoughtSignature"]);h!=null&&d(e,["thoughtSignature"],h);const p=c(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function iB(t){const e={},n=c(t,["productImage"]);return n!=null&&d(e,["image"],Vn(n)),e}function oB(t,e){const n={},r=c(t,["numberOfImages"]);e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r);const i=c(t,["baseSteps"]);e!==void 0&&i!=null&&d(e,["parameters","baseSteps"],i);const o=c(t,["outputGcsUri"]);e!==void 0&&o!=null&&d(e,["parameters","storageUri"],o);const s=c(t,["seed"]);e!==void 0&&s!=null&&d(e,["parameters","seed"],s);const a=c(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&d(e,["parameters","safetySetting"],a);const l=c(t,["personGeneration"]);e!==void 0&&l!=null&&d(e,["parameters","personGeneration"],l);const u=c(t,["addWatermark"]);e!==void 0&&u!=null&&d(e,["parameters","addWatermark"],u);const f=c(t,["outputMimeType"]);e!==void 0&&f!=null&&d(e,["parameters","outputOptions","mimeType"],f);const h=c(t,["outputCompressionQuality"]);e!==void 0&&h!=null&&d(e,["parameters","outputOptions","compressionQuality"],h);const p=c(t,["enhancePrompt"]);e!==void 0&&p!=null&&d(e,["parameters","enhancePrompt"],p);const m=c(t,["labels"]);return e!==void 0&&m!=null&&d(e,["labels"],m),n}function sB(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["source"]);i!=null&&lB(i,n);const o=c(e,["config"]);return o!=null&&oB(o,n),n}function aB(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Hd(i))),d(e,["generatedImages"],r)}return e}function lB(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);const i=c(t,["personImage"]);e!==void 0&&i!=null&&d(e,["instances[0]","personImage","image"],Vn(i));const o=c(t,["productImages"]);if(e!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(a=>iB(a))),d(e,["instances[0]","productImages"],s)}return n}function uB(t){const e={},n=c(t,["referenceImage"]);n!=null&&d(e,["referenceImage"],Vn(n));const r=c(t,["referenceId"]);r!=null&&d(e,["referenceId"],r);const i=c(t,["referenceType"]);i!=null&&d(e,["referenceType"],i);const o=c(t,["maskImageConfig"]);o!=null&&d(e,["maskImageConfig"],nB(o));const s=c(t,["controlImageConfig"]);s!=null&&d(e,["controlImageConfig"],K3(s));const a=c(t,["styleImageConfig"]);a!=null&&d(e,["styleImageConfig"],a);const l=c(t,["subjectImageConfig"]);return l!=null&&d(e,["subjectImageConfig"],l),e}function SI(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&d(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&d(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&d(e,["contentType"],i),e}function TI(t){const e={},n=c(t,["safetyAttributes","categories"]);n!=null&&d(e,["categories"],n);const r=c(t,["safetyAttributes","scores"]);r!=null&&d(e,["scores"],r);const i=c(t,["contentType"]);return i!=null&&d(e,["contentType"],i),e}function cB(t){const e={},n=c(t,["category"]);if(n!=null&&d(e,["category"],n),c(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=c(t,["threshold"]);return r!=null&&d(e,["threshold"],r),e}function dB(t){const e={},n=c(t,["image"]);return n!=null&&d(e,["image"],Vn(n)),e}function fB(t,e){const n={},r=c(t,["mode"]);e!==void 0&&r!=null&&d(e,["parameters","mode"],r);const i=c(t,["maxPredictions"]);e!==void 0&&i!=null&&d(e,["parameters","maxPredictions"],i);const o=c(t,["confidenceThreshold"]);e!==void 0&&o!=null&&d(e,["parameters","confidenceThreshold"],o);const s=c(t,["maskDilation"]);e!==void 0&&s!=null&&d(e,["parameters","maskDilation"],s);const a=c(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&d(e,["parameters","binaryColorThreshold"],a);const l=c(t,["labels"]);return e!==void 0&&l!=null&&d(e,["labels"],l),n}function hB(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["source"]);i!=null&&gB(i,n);const o=c(e,["config"]);return o!=null&&fB(o,n),n}function pB(t){const e={},n=c(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>VH(i))),d(e,["generatedMasks"],r)}return e}function gB(t,e){const n={},r=c(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);const i=c(t,["image"]);e!==void 0&&i!=null&&d(e,["instances[0]","image"],Vn(i));const o=c(t,["scribbleImage"]);return e!==void 0&&o!=null&&d(e,["instances[0]","scribble"],dB(o)),n}function mB(t){const e={},n=c(t,["retrievalConfig"]);n!=null&&d(e,["retrievalConfig"],n);const r=c(t,["functionCallingConfig"]);return r!=null&&d(e,["functionCallingConfig"],yH(r)),e}function vB(t){const e={};if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=c(t,["computerUse"]);n!=null&&d(e,["computerUse"],n);const r=c(t,["fileSearch"]);r!=null&&d(e,["fileSearch"],r);const i=c(t,["codeExecution"]);if(i!=null&&d(e,["codeExecution"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=c(t,["functionDeclarations"]);if(o!=null){let f=o;Array.isArray(f)&&(f=f.map(h=>h)),d(e,["functionDeclarations"],f)}const s=c(t,["googleMaps"]);s!=null&&d(e,["googleMaps"],WH(s));const a=c(t,["googleSearch"]);a!=null&&d(e,["googleSearch"],qH(a));const l=c(t,["googleSearchRetrieval"]);l!=null&&d(e,["googleSearchRetrieval"],l);const u=c(t,["urlContext"]);return u!=null&&d(e,["urlContext"],u),e}function II(t){const e={},n=c(t,["retrieval"]);n!=null&&d(e,["retrieval"],n);const r=c(t,["computerUse"]);if(r!=null&&d(e,["computerUse"],r),c(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=c(t,["codeExecution"]);i!=null&&d(e,["codeExecution"],i);const o=c(t,["enterpriseWebSearch"]);o!=null&&d(e,["enterpriseWebSearch"],o);const s=c(t,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>_H(p))),d(e,["functionDeclarations"],h)}const a=c(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],a);const l=c(t,["googleSearch"]);l!=null&&d(e,["googleSearch"],l);const u=c(t,["googleSearchRetrieval"]);u!=null&&d(e,["googleSearchRetrieval"],u);const f=c(t,["urlContext"]);return f!=null&&d(e,["urlContext"],f),e}function yB(t){const e={},n=c(t,["baseModel"]);n!=null&&d(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&d(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&d(e,["updateTime"],i),e}function _B(t){const e={},n=c(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&d(e,["baseModel"],n);const r=c(t,["createTime"]);r!=null&&d(e,["createTime"],r);const i=c(t,["updateTime"]);return i!=null&&d(e,["updateTime"],i),e}function wB(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&d(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&d(e,["description"],i);const o=c(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&d(e,["defaultCheckpointId"],o),n}function xB(t,e){const n={},r=c(t,["displayName"]);e!==void 0&&r!=null&&d(e,["displayName"],r);const i=c(t,["description"]);e!==void 0&&i!=null&&d(e,["description"],i);const o=c(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&d(e,["defaultCheckpointId"],o),n}function EB(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","name"],de(t,r));const i=c(e,["config"]);return i!=null&&wB(i,n),n}function CB(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["config"]);return i!=null&&xB(i,n),n}function SB(t,e){const n={},r=c(t,["outputGcsUri"]);e!==void 0&&r!=null&&d(e,["parameters","storageUri"],r);const i=c(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&d(e,["parameters","safetySetting"],i);const o=c(t,["personGeneration"]);e!==void 0&&o!=null&&d(e,["parameters","personGeneration"],o);const s=c(t,["includeRaiReason"]);e!==void 0&&s!=null&&d(e,["parameters","includeRaiReason"],s);const a=c(t,["outputMimeType"]);e!==void 0&&a!=null&&d(e,["parameters","outputOptions","mimeType"],a);const l=c(t,["outputCompressionQuality"]);e!==void 0&&l!=null&&d(e,["parameters","outputOptions","compressionQuality"],l);const u=c(t,["enhanceInputImage"]);e!==void 0&&u!=null&&d(e,["parameters","upscaleConfig","enhanceInputImage"],u);const f=c(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&d(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const h=c(t,["labels"]);e!==void 0&&h!=null&&d(e,["labels"],h);const p=c(t,["numberOfImages"]);e!==void 0&&p!=null&&d(e,["parameters","sampleCount"],p);const m=c(t,["mode"]);return e!==void 0&&m!=null&&d(e,["parameters","mode"],m),n}function TB(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["_url","model"],de(t,r));const i=c(e,["image"]);i!=null&&d(n,["instances[0]","image"],Vn(i));const o=c(e,["upscaleFactor"]);o!=null&&d(n,["parameters","upscaleConfig","upscaleFactor"],o);const s=c(e,["config"]);return s!=null&&SB(s,n),n}function IB(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Hd(o))),d(e,["generatedImages"],i)}return e}function kB(t){const e={},n=c(t,["uri"]);n!=null&&d(e,["uri"],n);const r=c(t,["encodedVideo"]);r!=null&&d(e,["videoBytes"],Ei(r));const i=c(t,["encoding"]);return i!=null&&d(e,["mimeType"],i),e}function bB(t){const e={},n=c(t,["gcsUri"]);n!=null&&d(e,["uri"],n);const r=c(t,["bytesBase64Encoded"]);r!=null&&d(e,["videoBytes"],Ei(r));const i=c(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}function NB(t){const e={},n=c(t,["image"]);n!=null&&d(e,["_self"],Vn(n));const r=c(t,["maskMode"]);return r!=null&&d(e,["maskMode"],r),e}function RB(t){const e={},n=c(t,["image"]);n!=null&&d(e,["image"],Bd(n));const r=c(t,["referenceType"]);return r!=null&&d(e,["referenceType"],r),e}function AB(t){const e={},n=c(t,["image"]);n!=null&&d(e,["image"],Vn(n));const r=c(t,["referenceType"]);return r!=null&&d(e,["referenceType"],r),e}function kI(t){const e={},n=c(t,["uri"]);n!=null&&d(e,["uri"],n);const r=c(t,["videoBytes"]);r!=null&&d(e,["encodedVideo"],Ei(r));const i=c(t,["mimeType"]);return i!=null&&d(e,["encoding"],i),e}function bI(t){const e={},n=c(t,["uri"]);n!=null&&d(e,["gcsUri"],n);const r=c(t,["videoBytes"]);r!=null&&d(e,["bytesBase64Encoded"],Ei(r));const i=c(t,["mimeType"]);return i!=null&&d(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PB(t,e){const n={},r=c(t,["displayName"]);return e!==void 0&&r!=null&&d(e,["displayName"],r),n}function MB(t){const e={},n=c(t,["config"]);return n!=null&&PB(n,e),e}function DB(t,e){const n={},r=c(t,["force"]);return e!==void 0&&r!=null&&d(e,["_query","force"],r),n}function LB(t){const e={},n=c(t,["name"]);n!=null&&d(e,["_url","name"],n);const r=c(t,["config"]);return r!=null&&DB(r,e),e}function OB(t){const e={},n=c(t,["name"]);return n!=null&&d(e,["_url","name"],n),e}function UB(t,e){const n={},r=c(t,["customMetadata"]);if(e!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),d(e,["customMetadata"],o)}const i=c(t,["chunkingConfig"]);return e!==void 0&&i!=null&&d(e,["chunkingConfig"],i),n}function FB(t){const e={},n=c(t,["name"]);n!=null&&d(e,["name"],n);const r=c(t,["metadata"]);r!=null&&d(e,["metadata"],r);const i=c(t,["done"]);i!=null&&d(e,["done"],i);const o=c(t,["error"]);o!=null&&d(e,["error"],o);const s=c(t,["response"]);return s!=null&&d(e,["response"],HB(s)),e}function VB(t){const e={},n=c(t,["fileSearchStoreName"]);n!=null&&d(e,["_url","file_search_store_name"],n);const r=c(t,["fileName"]);r!=null&&d(e,["fileName"],r);const i=c(t,["config"]);return i!=null&&UB(i,e),e}function HB(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["parent"]);r!=null&&d(e,["parent"],r);const i=c(t,["documentName"]);return i!=null&&d(e,["documentName"],i),e}function BB(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&d(e,["_query","pageToken"],i),n}function GB(t){const e={},n=c(t,["config"]);return n!=null&&BB(n,e),e}function zB(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const i=c(t,["fileSearchStores"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),d(e,["fileSearchStores"],o)}return e}function NI(t,e){const n={},r=c(t,["mimeType"]);e!==void 0&&r!=null&&d(e,["mimeType"],r);const i=c(t,["displayName"]);e!==void 0&&i!=null&&d(e,["displayName"],i);const o=c(t,["customMetadata"]);if(e!==void 0&&o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>l)),d(e,["customMetadata"],a)}const s=c(t,["chunkingConfig"]);return e!==void 0&&s!=null&&d(e,["chunkingConfig"],s),n}function $B(t){const e={},n=c(t,["fileSearchStoreName"]);n!=null&&d(e,["_url","file_search_store_name"],n);const r=c(t,["config"]);return r!=null&&NI(r,e),e}function WB(t){const e={},n=c(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qB="Content-Type",JB="X-Server-Timeout",jB="User-Agent",Up="x-goog-api-client",KB="1.38.0",YB=`google-genai-sdk/${KB}`,QB="v1beta1",XB="v1beta";class ZB{constructor(e){var n,r,i;this.clientOptions=Object.assign({},e),this.customBaseUrl=(n=e.httpOptions)===null||n===void 0?void 0:n.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const o={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const a=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!a?(o.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?o.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(o.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),o.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:QB}else{if(!this.clientOptions.apiKey)throw new cl({message:"API key must be set when using the Gemini API.",status:403});o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:XB,o.baseUrl="https://generativelanguage.googleapis.com/"}o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e,n){return!(n.baseUrl&&n.baseUrlResourceScope===Ap.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e,n),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[s,a]of Object.entries(e.queryParams))i.searchParams.append(s,String(a));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,i.toString(),e.abortSignal),this.unaryApiCall(i,o,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,o]of Object.entries(n))typeof o=="object"?r[i]=Object.assign(Object.assign({},r[i]),o):o!==void 0&&(r[i]=o);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e,n),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,i.toString(),e.abortSignal),this.streamApiCall(i,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,i){if(n&&n.timeout||i){const o=new AbortController,s=o.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>o.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}i&&i.addEventListener("abort",()=>{o.abort()}),e.signal=s}return n&&n.extraBody!==null&&eG(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await xw(i),new Pp(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await xw(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return Mn(this,arguments,function*(){var r;const i=(r=e==null?void 0:e.body)===null||r===void 0?void 0:r.getReader(),o=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let s="";const a="data:",l=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:u,value:f}=yield X(i.read());if(u){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=o.decode(f,{stream:!0});try{const _=JSON.parse(h);if("error"in _){const x=JSON.parse(JSON.stringify(_.error)),C=x.status,y=x.code,w=`got status: ${C}. ${JSON.stringify(_)}`;if(y>=400&&y<600)throw new cl({message:w,status:y})}}catch(_){if(_.name==="ApiError")throw _}s+=h;let p=-1,m=0;for(;;){p=-1,m=0;for(const C of l){const y=s.indexOf(C);y!==-1&&(p===-1||y<p)&&(p=y,m=C.length)}if(p===-1)break;const _=s.substring(0,p);s=s.substring(p+m);const x=_.trim();if(x.startsWith(a)){const C=x.substring(a.length).trim();try{const y=new Response(C,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield X(new Pp(y))}catch(y){throw new Error(`exception parsing stream chunk ${C}. ${y}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=YB+" "+this.clientOptions.userAgentExtra;return e[jB]=n,e[Up]=n,e[qB]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[i,o]of Object.entries(e.headers))r.append(i,o);e.timeout&&e.timeout>0&&r.append(JB,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(e){var n;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(e,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const o=this.clientOptions.uploader,s=await o.stat(e);i.sizeBytes=String(s.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:s.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l={file:i},u=this.getFileName(e),f=H("upload/v1beta/files",l._url),h=await this.fetchUploadUrl(f,i.sizeBytes,i.mimeType,u,l,n==null?void 0:n.httpOptions);return o.upload(e,h,this)}async uploadFileToFileSearchStore(e,n,r){var i;const o=this.clientOptions.uploader,s=await o.stat(n),a=String(s.size),l=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:s.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${e}:uploadToFileSearchStore`,f=this.getFileName(n),h={};r!=null&&NI(r,h);const p=await this.fetchUploadUrl(u,a,l,f,h,r==null?void 0:r.httpOptions);return o.uploadToFileSearchStore(n,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r,i,o,s){var a;let l={};s?l=s:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const u=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:l});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(a=u==null?void 0:u.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function xw(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new cl({message:i,status:n}):new Error(i)}}function eG(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const o=JSON.parse(t.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(o,s){const a=Object.assign({},o);for(const l in s)if(Object.prototype.hasOwnProperty.call(s,l)){const u=s[l],f=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&f&&typeof f=="object"&&!Array.isArray(f)?a[l]=r(f,u):(f&&u&&typeof f!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof f}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tG="mcp_used/unknown";let nG=!1;function RI(t){for(const e of t)if(rG(e)||typeof e=="object"&&"inputSchema"in e)return!0;return nG}function AI(t){var e;const n=(e=t[Up])!==null&&e!==void 0?e:"";t[Up]=(n+` ${tG}`).trimStart()}function rG(t){return t!==null&&typeof t=="object"&&t instanceof dv}function iG(t){return Mn(this,arguments,function*(n,r=100){let i,o=0;for(;o<r;){const s=yield X(n.listTools({cursor:i}));for(const a of s.tools)yield yield X(a),o++;if(!s.nextCursor)break;i=s.nextCursor}})}class dv{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new dv(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const o={},s=[];for(const f of this.mcpClients)try{for(var a=!0,l=(n=void 0,Dn(iG(f))),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const h=i;s.push(h);const p=h.name;if(o[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);o[p]=f}}catch(h){n={error:h}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=s,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),LV(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const s=await i.callTool({name:r.name,arguments:r.args},void 0,o);n.push({functionResponse:{name:r.name,response:s.isError?{error:s}:s}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function oG(t,e,n){const r=new kV;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),e(r)}class sG{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),s=uG(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const f=new Promise(v=>{u=v}),h=e.callbacks,p=function(){u({})},m=this.apiClient,_={onopen:p,onmessage:v=>{oG(m,h.onmessage,v)},onerror:(n=h==null?void 0:h.onerror)!==null&&n!==void 0?n:function(v){},onclose:(r=h==null?void 0:h.onclose)!==null&&r!==void 0?r:function(v){}},x=this.webSocketFactory.create(l,lG(s),_);x.connect(),await f;const w={setup:{model:de(this.apiClient,e.model)}};return x.send(JSON.stringify(w)),new aG(x,this.apiClient)}}class aG{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=P3(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=A3(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Mo.PLAY)}pause(){this.sendPlaybackControl(Mo.PAUSE)}stop(){this.sendPlaybackControl(Mo.STOP)}resetContext(){this.sendPlaybackControl(Mo.RESET_CONTEXT)}close(){this.conn.close()}}function lG(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function uG(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cG="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function dG(t,e,n){const r=new IV;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const o=JSON.parse(i);if(t.isVertexAI()){const s=L3(o);Object.assign(r,s)}else Object.assign(r,o);e(r)}class fG{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new sG(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,o,s,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let f;const h=this.apiClient.getHeaders();e.config&&e.config.tools&&RI(e.config.tools)&&AI(h);const p=mG(h);if(this.apiClient.isVertexAI()){const R=this.apiClient.getProject(),N=this.apiClient.getLocation(),D=this.apiClient.getApiKey(),G=!!R&&!!N||!!D;this.apiClient.getCustomBaseUrl()&&!G?f=l:(f=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,f))}else{const R=this.apiClient.getApiKey();let N="BidiGenerateContent",D="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),N="BidiGenerateContentConstrained",D="access_token"),f=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${N}?${D}=${R}`}let m=()=>{};const _=new Promise(R=>{m=R}),x=e.callbacks,C=function(){var R;(R=x==null?void 0:x.onopen)===null||R===void 0||R.call(x),m({})},y=this.apiClient,w={onopen:C,onmessage:R=>{dG(y,x.onmessage,R)},onerror:(n=x==null?void 0:x.onerror)!==null&&n!==void 0?n:function(R){},onclose:(r=x==null?void 0:x.onclose)!==null&&r!==void 0?r:function(R){}},v=this.webSocketFactory.create(f,gG(p),w);v.connect(),await _;let E=de(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&E.startsWith("publishers/")){const R=this.apiClient.getProject(),N=this.apiClient.getLocation();R&&N&&(E=`projects/${R}/locations/${N}/`+E)}let I={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Lc.AUDIO]}:e.config.responseModalities=[Lc.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const k=(a=(s=e.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[],b=[];for(const R of k)if(this.isCallableTool(R)){const N=R;b.push(await N.tool())}else b.push(R);b.length>0&&(e.config.tools=b);const T={model:E,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?I=R3(this.apiClient,T):I=N3(this.apiClient,T),delete I.config,v.send(JSON.stringify(I)),new pG(v,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const hG={turnComplete:!0};class pG{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=gn(n.turns),e.isVertexAI()||(r=r.map(i=>Vd(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(cG)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},hG),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:D3(e)}:n={realtimeInput:M3(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function gG(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function mG(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ew=10;function Cw(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const s of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Ko(s)){i=!0;break}if(!i)return!0;const o=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Ko(t){return"callTool"in t&&typeof t.callTool=="function"}function vG(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>Ko(i)))!==null&&r!==void 0?r:!1}function Sw(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((r,i)=>{if(Ko(r))return;const o=r;o.functionDeclarations&&o.functionDeclarations.length>0&&n.push(i)}),n}function Tw(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yG extends kr{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,o,s,a;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!vG(n)||Cw(n.config))return await this.generateContentInternal(l);const u=Sw(n);if(u.length>0){const x=u.map(C=>`tools[${C}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${x}.`)}let f,h;const p=gn(l.contents),m=(o=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:Ew;let _=0;for(;_<m&&(f=await this.generateContentInternal(l),!(!f.functionCalls||f.functionCalls.length===0));){const x=f.candidates[0].content,C=[];for(const y of(a=(s=n.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[])if(Ko(y)){const v=await y.callTool(f.functionCalls);C.push(...v)}_++,h={role:"user",parts:C},l.contents=gn(l.contents),l.contents.push(x),l.contents.push(h),Tw(l.config)&&(p.push(x),p.push(h))}return Tw(l.config)&&(f.automaticFunctionCallingHistory=p),f},this.generateContentStream=async n=>{var r,i,o,s,a;if(this.maybeMoveToResponseJsonSchem(n),Cw(n.config)){const h=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(h)}const l=Sw(n);if(l.length>0){const h=l.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const u=(o=(i=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,f=(a=(s=n==null?void 0:n.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(u&&!f)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let o;const s=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?o=l==null?void 0:l.safetyAttributes:s.push(l);let a;return o?a={generatedImages:s,positivePromptSafetyAttributes:o,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:s,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const s={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((r=s.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new fo(Cr.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(s),s)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,o,s,a,l;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((s=(o=n.source)===null||o===void 0?void 0:o.video)===null||s===void 0)&&s.uri&&(!((l=(a=n.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const o=(n=e.config)===null||n===void 0?void 0:n.tools;if(!o)return e;const s=await Promise.all(o.map(async l=>Ko(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(a.config.tools=s,e.config&&e.config.tools&&RI(e.config.tools)){const l=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),AI(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var n,r,i;const o=new Map;for(const s of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Ko(s)){const a=s,l=await a.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(o.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);o.set(u.name,a)}}return o}async processAfcStream(e){var n,r,i;const o=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:Ew;let s=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,f,h){return Mn(this,arguments,function*(){for(var p,m,_,x,C,y;a<o;){s&&(a++,s=!1);const I=yield X(u.processParamsMaybeAddMcpUsage(h)),k=yield X(u.generateContentStreamInternal(I)),b=[],T=[];try{for(var w=!0,v=(m=void 0,Dn(k)),E;E=yield X(v.next()),p=E.done,!p;w=!0){x=E.value,w=!1;const R=x;if(yield yield X(R),R.candidates&&(!((C=R.candidates[0])===null||C===void 0)&&C.content)){T.push(R.candidates[0].content);for(const N of(y=R.candidates[0].content.parts)!==null&&y!==void 0?y:[])if(a<o&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(N.functionCall.name)){const D=yield X(f.get(N.functionCall.name).callTool([N.functionCall]));b.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(R){m={error:R}}finally{try{!w&&!p&&(_=v.return)&&(yield X(_.call(v)))}finally{if(m)throw m.error}}if(b.length>0){s=!0;const R=new Ys;R.candidates=[{content:{role:"user",parts:b}}],yield yield X(R);const N=[];N.push(...T),N.push({role:"user",parts:b});const D=gn(h.contents).concat(N);h.contents=D}else break}})}(this,l,e)}async generateContentInternal(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=yw(this.apiClient,e);return a=H("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=ww(f),p=new Ys;return Object.assign(p,h),p})}else{const u=vw(this.apiClient,e);return a=H("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=_w(f),p=new Ys;return Object.assign(p,h),p})}}async generateContentStreamInternal(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=yw(this.apiClient,e);return a=H("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),s.then(function(h){return Mn(this,arguments,function*(){var p,m,_,x;try{for(var C=!0,y=Dn(h),w;w=yield X(y.next()),p=w.done,!p;C=!0){x=w.value,C=!1;const v=x,E=ww(yield X(v.json()));E.sdkHttpResponse={headers:v.headers};const I=new Ys;Object.assign(I,E),yield yield X(I)}}catch(v){m={error:v}}finally{try{!C&&!p&&(_=y.return)&&(yield X(_.call(y)))}finally{if(m)throw m.error}}})})}else{const u=vw(this.apiClient,e);return a=H("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),s.then(function(h){return Mn(this,arguments,function*(){var p,m,_,x;try{for(var C=!0,y=Dn(h),w;w=yield X(y.next()),p=w.done,!p;C=!0){x=w.value,C=!1;const v=x,E=_w(yield X(v.json()));E.sdkHttpResponse={headers:v.headers};const I=new Ys;Object.assign(I,E),yield yield X(I)}}catch(v){m={error:v}}finally{try{!C&&!p&&(_=y.return)&&(yield X(_.call(y)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=fH(this.apiClient,e);return a=H("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=pH(f),p=new ew;return Object.assign(p,h),p})}else{const u=dH(this.apiClient,e);return a=H("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=hH(f),p=new ew;return Object.assign(p,h),p})}}async generateImagesInternal(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=TH(this.apiClient,e);return a=H("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=kH(f),p=new tw;return Object.assign(p,h),p})}else{const u=SH(this.apiClient,e);return a=H("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=IH(f),p=new tw;return Object.assign(p,h),p})}}async editImageInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=aH(this.apiClient,e);return o=H("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=lH(l),f=new gV;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=TB(this.apiClient,e);return o=H("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=IB(l),f=new mV;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=sB(this.apiClient,e);return o=H("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=aB(l),f=new vV;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=hB(this.apiClient,e);return o=H("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=pB(l),f=new yV;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=$H(this.apiClient,e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>Op(f))}else{const u=zH(this.apiClient,e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>Lp(f))}}async listInternal(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=ZH(this.apiClient,e);return a=H("{models_url}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=tB(f),p=new nw;return Object.assign(p,h),p})}else{const u=XH(this.apiClient,e);return a=H("{models_url}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=eB(f),p=new nw;return Object.assign(p,h),p})}}async update(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=CB(this.apiClient,e);return a=H("{model}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>Op(f))}else{const u=EB(this.apiClient,e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>Lp(f))}}async delete(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=rH(this.apiClient,e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=oH(f),p=new rw;return Object.assign(p,h),p})}else{const u=nH(this.apiClient,e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=iH(f),p=new rw;return Object.assign(p,h),p})}}async countTokens(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=Z3(this.apiClient,e);return a=H("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=tH(f),p=new iw;return Object.assign(p,h),p})}else{const u=X3(this.apiClient,e);return a=H("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=eH(f),p=new iw;return Object.assign(p,h),p})}}async computeTokens(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=W3(this.apiClient,e);return o=H("{model}:computeTokens",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>{const u=q3(l),f=new _V;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=MH(this.apiClient,e);return a=H("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>{const h=AH(f),p=new Oc;return Object.assign(p,h),p})}else{const u=PH(this.apiClient,e);return a=H("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s.then(f=>{const h=RH(f),p=new Oc;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _G extends kr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=uV(e);return a=H("{operationName}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s}else{const u=lV(e);return a=H("{operationName}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),s}}async fetchPredictVideosOperationInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=tV(e);return o=H("{resourceName}:fetchPredictOperation",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wG(t){const e={},n=c(t,["data"]);if(n!=null&&d(e,["data"],n),c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function xG(t){const e={},n=c(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>RG(o))),d(e,["parts"],i)}const r=c(t,["role"]);return r!=null&&d(e,["role"],r),e}function EG(t,e,n){const r={},i=c(e,["expireTime"]);n!==void 0&&i!=null&&d(n,["expireTime"],i);const o=c(e,["newSessionExpireTime"]);n!==void 0&&o!=null&&d(n,["newSessionExpireTime"],o);const s=c(e,["uses"]);n!==void 0&&s!=null&&d(n,["uses"],s);const a=c(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&d(n,["bidiGenerateContentSetup"],NG(t,a));const l=c(e,["lockAdditionalFields"]);return n!==void 0&&l!=null&&d(n,["fieldMask"],l),r}function CG(t,e){const n={},r=c(e,["config"]);return r!=null&&d(n,["config"],EG(t,r,n)),n}function SG(t){const e={};if(c(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const r=c(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function TG(t){const e={},n=c(t,["id"]);n!=null&&d(e,["id"],n);const r=c(t,["args"]);r!=null&&d(e,["args"],r);const i=c(t,["name"]);if(i!=null&&d(e,["name"],i),c(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(c(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function IG(t){const e={};if(c(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=c(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function kG(t){const e={};if(c(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(c(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=c(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function bG(t,e){const n={},r=c(t,["generationConfig"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig"],r);const i=c(t,["responseModalities"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig","responseModalities"],i);const o=c(t,["temperature"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","temperature"],o);const s=c(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);const a=c(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);const l=c(t,["maxOutputTokens"]);e!==void 0&&l!=null&&d(e,["setup","generationConfig","maxOutputTokens"],l);const u=c(t,["mediaResolution"]);e!==void 0&&u!=null&&d(e,["setup","generationConfig","mediaResolution"],u);const f=c(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);const h=c(t,["speechConfig"]);e!==void 0&&h!=null&&d(e,["setup","generationConfig","speechConfig"],cv(h));const p=c(t,["thinkingConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","thinkingConfig"],p);const m=c(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],m);const _=c(t,["systemInstruction"]);e!==void 0&&_!=null&&d(e,["setup","systemInstruction"],xG(_t(_)));const x=c(t,["tools"]);if(e!==void 0&&x!=null){let k=ks(x);Array.isArray(k)&&(k=k.map(b=>PG(Is(b)))),d(e,["setup","tools"],k)}const C=c(t,["sessionResumption"]);e!==void 0&&C!=null&&d(e,["setup","sessionResumption"],AG(C));const y=c(t,["inputAudioTranscription"]);e!==void 0&&y!=null&&d(e,["setup","inputAudioTranscription"],y);const w=c(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&d(e,["setup","outputAudioTranscription"],w);const v=c(t,["realtimeInputConfig"]);e!==void 0&&v!=null&&d(e,["setup","realtimeInputConfig"],v);const E=c(t,["contextWindowCompression"]);e!==void 0&&E!=null&&d(e,["setup","contextWindowCompression"],E);const I=c(t,["proactivity"]);if(e!==void 0&&I!=null&&d(e,["setup","proactivity"],I),c(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function NG(t,e){const n={},r=c(e,["model"]);r!=null&&d(n,["setup","model"],de(t,r));const i=c(e,["config"]);return i!=null&&d(n,["config"],bG(i,n)),n}function RG(t){const e={},n=c(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);const r=c(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);const i=c(t,["executableCode"]);i!=null&&d(e,["executableCode"],i);const o=c(t,["fileData"]);o!=null&&d(e,["fileData"],SG(o));const s=c(t,["functionCall"]);s!=null&&d(e,["functionCall"],TG(s));const a=c(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);const l=c(t,["inlineData"]);l!=null&&d(e,["inlineData"],wG(l));const u=c(t,["text"]);u!=null&&d(e,["text"],u);const f=c(t,["thought"]);f!=null&&d(e,["thought"],f);const h=c(t,["thoughtSignature"]);h!=null&&d(e,["thoughtSignature"],h);const p=c(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function AG(t){const e={},n=c(t,["handle"]);if(n!=null&&d(e,["handle"],n),c(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function PG(t){const e={};if(c(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=c(t,["computerUse"]);n!=null&&d(e,["computerUse"],n);const r=c(t,["fileSearch"]);r!=null&&d(e,["fileSearch"],r);const i=c(t,["codeExecution"]);if(i!=null&&d(e,["codeExecution"],i),c(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=c(t,["functionDeclarations"]);if(o!=null){let f=o;Array.isArray(f)&&(f=f.map(h=>h)),d(e,["functionDeclarations"],f)}const s=c(t,["googleMaps"]);s!=null&&d(e,["googleMaps"],IG(s));const a=c(t,["googleSearch"]);a!=null&&d(e,["googleSearch"],kG(a));const l=c(t,["googleSearchRetrieval"]);l!=null&&d(e,["googleSearchRetrieval"],l);const u=c(t,["urlContext"]);return u!=null&&d(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function MG(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(o=>`${n}.${o}`);e.push(...i)}else e.push(n)}return e.join(",")}function DG(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const o=r.setup;typeof o=="object"&&o!==null?(t.bidiGenerateContentSetup=o,n=o):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const o=MG(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?t.fieldMask=o:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const s=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];i.length>0&&(a=i.map(u=>s.includes(u)?`generationConfig.${u}`:u));const l=[];o&&l.push(o),a.length>0&&l.push(...a),l.length>0?t.fieldMask=l.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class LG extends kr{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=CG(this.apiClient,e);o=H("auth_tokens",a._url),s=a._query,delete a.config,delete a._url,delete a._query;const l=DG(a,e.config);return i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OG(t,e){const n={},r=c(t,["force"]);return e!==void 0&&r!=null&&d(e,["_query","force"],r),n}function UG(t){const e={},n=c(t,["name"]);n!=null&&d(e,["_url","name"],n);const r=c(t,["config"]);return r!=null&&OG(r,e),e}function FG(t){const e={},n=c(t,["name"]);return n!=null&&d(e,["_url","name"],n),e}function VG(t,e){const n={},r=c(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const i=c(t,["pageToken"]);return e!==void 0&&i!=null&&d(e,["_query","pageToken"],i),n}function HG(t){const e={},n=c(t,["parent"]);n!=null&&d(e,["_url","parent"],n);const r=c(t,["config"]);return r!=null&&VG(r,e),e}function BG(t){const e={},n=c(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=c(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const i=c(t,["documents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),d(e,["documents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GG extends kr{constructor(e){super(),this.apiClient=e,this.list=async n=>new fo(Cr.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=FG(e);return o=H("{name}",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=UG(e);i=H("{name}",s._url),o=s._query,delete s._url,delete s._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=HG(e);return o=H("{parent}/documents",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=BG(l),f=new wV;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zG extends kr{constructor(e,n=new GG(e)){super(),this.apiClient=e,this.documents=n,this.list=async(r={})=>new fo(Cr.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=MB(e);return o=H("fileSearchStores",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async get(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=OB(e);return o=H("{name}",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var n,r;let i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=LB(e);i=H("{name}",s._url),o=s._query,delete s._url,delete s._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=GB(e);return o=H("fileSearchStores",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=zB(l),f=new xV;return Object.assign(f,u),f})}}async uploadToFileSearchStoreInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=$B(e);return o=H("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=WB(l),f=new EV;return Object.assign(f,u),f})}}async importFile(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=VB(e);return o=H("{file_search_store_name}:importFile",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=FB(l),f=new ov;return Object.assign(f,u),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let PI=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return PI=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};const $G=()=>PI();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fp(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const Vp=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wn extends Error{}class Rt extends wn{constructor(e,n,r,i){super(`${Rt.makeMessage(e,n,r)}`),this.status=e,this.headers=i,this.error=n}static makeMessage(e,n,r){const i=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,n,r,i){if(!e||!i)return new Gd({message:r,cause:Vp(n)});const o=n;return e===400?new DI(e,o,r,i):e===401?new LI(e,o,r,i):e===403?new OI(e,o,r,i):e===404?new UI(e,o,r,i):e===409?new FI(e,o,r,i):e===422?new VI(e,o,r,i):e===429?new HI(e,o,r,i):e>=500?new BI(e,o,r,i):new Rt(e,o,r,i)}}class Hp extends Rt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Gd extends Rt{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class MI extends Gd{constructor({message:e}={}){super({message:e??"Request timed out."})}}class DI extends Rt{}class LI extends Rt{}class OI extends Rt{}class UI extends Rt{}class FI extends Rt{}class VI extends Rt{}class HI extends Rt{}class BI extends Rt{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WG=/^[a-z][a-z0-9+.-]*:/i,qG=t=>WG.test(t);let Bp=t=>(Bp=Array.isArray,Bp(t));const JG=Bp;let jG=JG;const Iw=jG;function KG(t){if(!t)return!0;for(const e in t)return!1;return!0}function YG(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const QG=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new wn(`${t} must be an integer`);if(e<0)throw new wn(`${t} must be a positive integer`);return e},XG=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ZG=t=>new Promise(e=>setTimeout(e,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yo="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ez(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const tz=()=>{var t,e,n,r,i;const o=ez();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":yo,"X-Stainless-OS":bw(Deno.build.os),"X-Stainless-Arch":kw(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":yo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":yo,"X-Stainless-OS":bw((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":kw((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const s=nz();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":yo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":yo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function nz(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const i=r[1]||0,o=r[2]||0,s=r[3]||0;return{browser:e,version:`${i}.${o}.${s}`}}}return null}const kw=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",bw=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let du;const rz=()=>du??(du=tz());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iz(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function GI(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function oz(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return GI({start(){},async pull(n){const{done:r,value:i}=await e.next();r?n.close():n.enqueue(i)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function zI(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function sz(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const r=t.getReader(),i=r.cancel();r.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const az=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $I=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Wf(t,e,n){return $I(),new File(t,e??"unknown_file",n)}function lz(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const uz=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WI=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",cz=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&WI(t),dz=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function fz(t,e,n){if($I(),t=await t,cz(t))return t instanceof File?t:Wf([await t.arrayBuffer()],t.name);if(dz(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Wf(await Gp(i),e,n)}const r=await Gp(t);if(e||(e=lz(t)),!(n!=null&&n.type)){const i=r.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof i=="string"&&(n=Object.assign(Object.assign({},n),{type:i}))}return Wf(r,e,n)}async function Gp(t){var e,n,r,i,o;let s=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)s.push(t);else if(WI(t))s.push(t instanceof Blob?t:await t.arrayBuffer());else if(uz(t))try{for(var a=!0,l=Dn(t),u;u=await l.next(),e=u.done,!e;a=!0){i=u.value,a=!1;const f=i;s.push(...await Gp(f))}}catch(f){n={error:f}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}else{const f=(o=t==null?void 0:t.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof t}${f?`; constructor: ${f}`:""}${hz(t)}`)}return s}function hz(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qI{constructor(e){this._client=e}}qI._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JI(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Nw=Object.freeze(Object.create(null)),pz=(t=JI)=>function(n,...r){if(n.length===1)return n[0];let i=!1;const o=[],s=n.reduce((f,h,p)=>{var m,_,x;/[?#]/.test(h)&&(i=!0);const C=r[p];let y=(i?encodeURIComponent:t)(""+C);return p!==r.length&&(C==null||typeof C=="object"&&C.toString===((x=Object.getPrototypeOf((_=Object.getPrototypeOf((m=C.hasOwnProperty)!==null&&m!==void 0?m:Nw))!==null&&_!==void 0?_:Nw))===null||x===void 0?void 0:x.toString))&&(y=C+"",o.push({start:f.length+h.length,length:y.length,error:`Value of type ${Object.prototype.toString.call(C).slice(8,-1)} is not a valid path parameter`})),f+h+(p===r.length?"":y)},""),a=s.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let u;for(;(u=l.exec(a))!==null;)o.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(o.sort((f,h)=>f.start-h.start),o.length>0){let f=0;const h=o.reduce((p,m)=>{const _=" ".repeat(m.start-f),x="^".repeat(m.length);return f=m.start+m.length,p+_+x},"");throw new wn(`Path parameters result in path with invalid segments:
${o.map(p=>p.error).join(`
`)}
${s}
${h}`)}return s},fu=pz(JI);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jI extends qI{create(e,n){var r;const{api_version:i=this._client.apiVersion}=e,o=Fc(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new wn("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new wn("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(fu`/${i}/interactions`,Object.assign(Object.assign({body:o},n),{stream:(r=e.stream)!==null&&r!==void 0?r:!1}))}delete(e,n={},r){const{api_version:i=this._client.apiVersion}=n??{};return this._client.delete(fu`/${i}/interactions/${e}`,r)}cancel(e,n={},r){const{api_version:i=this._client.apiVersion}=n??{};return this._client.post(fu`/${i}/interactions/${e}/cancel`,r)}get(e,n={},r){var i;const o=n??{},{api_version:s=this._client.apiVersion}=o,a=Fc(o,["api_version"]);return this._client.get(fu`/${s}/interactions/${e}`,Object.assign(Object.assign({query:a},r),{stream:(i=n==null?void 0:n.stream)!==null&&i!==void 0?i:!1}))}}jI._key=Object.freeze(["interactions"]);class KI extends jI{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gz(t){let e=0;for(const i of t)e+=i.length;const n=new Uint8Array(e);let r=0;for(const i of t)n.set(i,r),r+=i.length;return n}let hu;function fv(t){let e;return(hu??(e=new globalThis.TextEncoder,hu=e.encode.bind(e)))(t)}let pu;function Rw(t){let e;return(pu??(e=new globalThis.TextDecoder,pu=e.decode.bind(e)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zd{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?fv(e):e;this.buffer=gz([this.buffer,n]);const r=[];let i;for(;(i=mz(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){r.push(Rw(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const o=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,s=Rw(this.buffer.subarray(0,o));r.push(s),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}}zd.NEWLINE_CHARS=new Set([`
`,"\r"]);zd.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function mz(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function vz(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vc={off:0,error:200,warn:300,info:400,debug:500},Aw=(t,e,n)=>{if(t){if(YG(Vc,t))return t;Tt(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Vc))}`)}};function ia(){}function gu(t,e,n){return!e||Vc[t]>Vc[n]?ia:e[t].bind(e)}const yz={error:ia,warn:ia,info:ia,debug:ia};let Pw=new WeakMap;function Tt(t){var e;const n=t.logger,r=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return yz;const i=Pw.get(n);if(i&&i[0]===r)return i[1];const o={error:gu("error",n,r),warn:gu("warn",n,r),info:gu("info",n,r),debug:gu("debug",n,r)};return Pw.set(n,[r,o]),o}const Pi=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Do{constructor(e,n,r){this.iterator=e,this.controller=n,this.client=r}static fromSSEResponse(e,n,r){let i=!1;const o=r?Tt(r):console;function s(){return Mn(this,arguments,function*(){var l,u,f,h;if(i)throw new wn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let p=!1;try{try{for(var m=!0,_=Dn(_z(e,n)),x;x=yield X(_.next()),l=x.done,!l;m=!0){h=x.value,m=!1;const C=h;if(!p)if(C.data.startsWith("[DONE]")){p=!0;continue}else try{yield yield X(JSON.parse(C.data))}catch(y){throw o.error("Could not parse message into JSON:",C.data),o.error("From chunk:",C.raw),y}}}catch(C){u={error:C}}finally{try{!m&&!l&&(f=_.return)&&(yield X(f.call(_)))}finally{if(u)throw u.error}}p=!0}catch(C){if(Fp(C))return yield X(void 0);throw C}finally{p||n.abort()}})}return new Do(s,n,r)}static fromReadableStream(e,n,r){let i=!1;function o(){return Mn(this,arguments,function*(){var l,u,f,h;const p=new zd,m=zI(e);try{for(var _=!0,x=Dn(m),C;C=yield X(x.next()),l=C.done,!l;_=!0){h=C.value,_=!1;const y=h;for(const w of p.decode(y))yield yield X(w)}}catch(y){u={error:y}}finally{try{!_&&!l&&(f=x.return)&&(yield X(f.call(x)))}finally{if(u)throw u.error}}for(const y of p.flush())yield yield X(y)})}function s(){return Mn(this,arguments,function*(){var l,u,f,h;if(i)throw new wn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let p=!1;try{try{for(var m=!0,_=Dn(o()),x;x=yield X(_.next()),l=x.done,!l;m=!0){h=x.value,m=!1;const C=h;p||C&&(yield yield X(JSON.parse(C)))}}catch(C){u={error:C}}finally{try{!m&&!l&&(f=_.return)&&(yield X(f.call(_)))}finally{if(u)throw u.error}}p=!0}catch(C){if(Fp(C))return yield X(void 0);throw C}finally{p||n.abort()}})}return new Do(s,n,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),i=o=>({next:()=>{if(o.length===0){const s=r.next();e.push(s),n.push(s)}return o.shift()}});return[new Do(()=>i(e),this.controller,this.client),new Do(()=>i(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return GI({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:i,done:o}=await n.next();if(o)return r.close();const s=fv(JSON.stringify(i)+`
`);r.enqueue(s)}catch(i){r.error(i)}},async cancel(){var r;await((r=n.return)===null||r===void 0?void 0:r.call(n))}})}}function _z(t,e){return Mn(this,arguments,function*(){var r,i,o,s;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new wn("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new wn("Attempted to iterate over a response with no body");const a=new xz,l=new zd,u=zI(t.body);try{for(var f=!0,h=Dn(wz(u)),p;p=yield X(h.next()),r=p.done,!r;f=!0){s=p.value,f=!1;const m=s;for(const _ of l.decode(m)){const x=a.decode(_);x&&(yield yield X(x))}}}catch(m){i={error:m}}finally{try{!f&&!r&&(o=h.return)&&(yield X(o.call(h)))}finally{if(i)throw i.error}}for(const m of l.flush()){const _=a.decode(m);_&&(yield yield X(_))}})}function wz(t){return Mn(this,arguments,function*(){var n,r,i,o;let s=new Uint8Array;try{for(var a=!0,l=Dn(t),u;u=yield X(l.next()),n=u.done,!n;a=!0){o=u.value,a=!1;const f=o;if(f==null)continue;const h=f instanceof ArrayBuffer?new Uint8Array(f):typeof f=="string"?fv(f):f;let p=new Uint8Array(s.length+h.length);p.set(s),p.set(h,s.length),s=p;let m;for(;(m=vz(s))!==-1;)yield yield X(s.slice(0,m)),s=s.slice(m)}}catch(f){r={error:f}}finally{try{!a&&!n&&(i=l.return)&&(yield X(i.call(l)))}finally{if(r)throw r.error}}s.length>0&&(yield yield X(s))})}class xz{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,i]=Ez(e,":");return i.startsWith(" ")&&(i=i.substring(1)),n==="event"?this.event=i:n==="data"&&this.data.push(i),null}}function Ez(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Cz(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:i,startTime:o}=e,s=await(async()=>{var a;if(e.options.stream)return Tt(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Do.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const l=n.headers.get("content-type"),u=(a=l==null?void 0:l.split(";")[0])===null||a===void 0?void 0:a.trim();return(u==null?void 0:u.includes("application/json"))||(u==null?void 0:u.endsWith("+json"))?await n.json():await n.text()})();return Tt(t).debug(`[${r}] response parsed`,Pi({retryOfRequestLogID:i,url:n.url,status:n.status,body:s,durationMs:Date.now()-o})),s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hv extends Promise{constructor(e,n,r=Cz){super(i=>{i(null)}),this.responsePromise=n,this.parseResponse=r,this.client=e}_thenUnwrap(e){return new hv(this.client,this.responsePromise,async(n,r)=>e(await this.parseResponse(n,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const YI=Symbol("brand.privateNullableHeaders");function*Sz(t){if(!t)return;if(YI in t){const{values:r,nulls:i}=t;yield*r.entries();for(const o of i)yield[o,null];return}let e=!1,n;t instanceof Headers?n=t.entries():Iw(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const i=r[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const o=Iw(r[1])?r[1]:[r[1]];let s=!1;for(const a of o)a!==void 0&&(e&&!s&&(s=!0,yield[i,null]),yield[i,a])}}const Qs=t=>{const e=new Headers,n=new Set;for(const r of t){const i=new Set;for(const[o,s]of Sz(r)){const a=o.toLowerCase();i.has(a)||(e.delete(o),i.add(a)),s===null?(e.delete(o),n.add(a)):(e.append(o,s),n.delete(a))}}return{[YI]:!0,values:e,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qf=t=>{var e,n,r,i,o,s;if(typeof globalThis.process<"u")return(r=(n=(e=K4)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(s=(o=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||o===void 0?void 0:o.call(i,t))===null||s===void 0?void 0:s.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var QI;class $d{constructor(e){var n,r,i,o,s,a,l,{baseURL:u=qf("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:f=(n=qf("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:h="v1beta"}=e,p=Fc(e,["baseURL","apiKey","apiVersion"]);const m=Object.assign(Object.assign({apiKey:f,apiVersion:h},p),{baseURL:u||"https://generativelanguage.googleapis.com"});this.baseURL=m.baseURL,this.timeout=(r=m.timeout)!==null&&r!==void 0?r:$d.DEFAULT_TIMEOUT,this.logger=(i=m.logger)!==null&&i!==void 0?i:console;const _="warn";this.logLevel=_,this.logLevel=(s=(o=Aw(m.logLevel,"ClientOptions.logLevel",this))!==null&&o!==void 0?o:Aw(qf("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&s!==void 0?s:_,this.fetchOptions=m.fetchOptions,this.maxRetries=(a=m.maxRetries)!==null&&a!==void 0?a:2,this.fetch=(l=m.fetch)!==null&&l!==void 0?l:iz(),this.encoder=az,this._options=m,this.apiKey=f,this.apiVersion=h,this.clientAdapter=m.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const n=Qs([e.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return Qs([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Qs([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new wn(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${yo}`}defaultIdempotencyKey(){return`stainless-node-retry-${$G()}`}makeStatusError(e,n,r,i){return Rt.generate(e,n,r,i)}buildURL(e,n,r){const i=!this.baseURLOverridden()&&r||this.baseURL,o=qG(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return KG(s)||(n=Object.assign(Object.assign({},s),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(o.search=this.stringifyQuery(n)),o.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const n=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(i=>Object.assign({method:e,path:n},i)))}request(e,n=null){return new hv(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){var i,o,s;const a=await e,l=(i=a.maxRetries)!==null&&i!==void 0?i:this.maxRetries;n==null&&(n=l),await this.prepareOptions(a);const{req:u,url:f,timeout:h}=await this.buildRequest(a,{retryCount:l-n});await this.prepareRequest(u,{url:f,options:a});const p="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),m=r===void 0?"":`, retryOf: ${r}`,_=Date.now();if(Tt(this).debug(`[${p}] sending request`,Pi({retryOfRequestLogID:r,method:a.method,url:f,options:a,headers:u.headers})),!((o=a.signal)===null||o===void 0)&&o.aborted)throw new Hp;const x=new AbortController,C=await this.fetchWithTimeout(f,u,h,x).catch(Vp),y=Date.now();if(C instanceof globalThis.Error){const v=`retrying, ${n} attempts remaining`;if(!((s=a.signal)===null||s===void 0)&&s.aborted)throw new Hp;const E=Fp(C)||/timed? ?out/i.test(String(C)+("cause"in C?String(C.cause):""));if(n)return Tt(this).info(`[${p}] connection ${E?"timed out":"failed"} - ${v}`),Tt(this).debug(`[${p}] connection ${E?"timed out":"failed"} (${v})`,Pi({retryOfRequestLogID:r,url:f,durationMs:y-_,message:C.message})),this.retryRequest(a,n,r??p);throw Tt(this).info(`[${p}] connection ${E?"timed out":"failed"} - error; no more retries left`),Tt(this).debug(`[${p}] connection ${E?"timed out":"failed"} (error; no more retries left)`,Pi({retryOfRequestLogID:r,url:f,durationMs:y-_,message:C.message})),E?new MI:new Gd({cause:C})}const w=`[${p}${m}] ${u.method} ${f} ${C.ok?"succeeded":"failed"} with status ${C.status} in ${y-_}ms`;if(!C.ok){const v=await this.shouldRetry(C);if(n&&v){const R=`retrying, ${n} attempts remaining`;return await sz(C.body),Tt(this).info(`${w} - ${R}`),Tt(this).debug(`[${p}] response error (${R})`,Pi({retryOfRequestLogID:r,url:C.url,status:C.status,headers:C.headers,durationMs:y-_})),this.retryRequest(a,n,r??p,C.headers)}const E=v?"error; no more retries left":"error; not retryable";Tt(this).info(`${w} - ${E}`);const I=await C.text().catch(R=>Vp(R).message),k=XG(I),b=k?void 0:I;throw Tt(this).debug(`[${p}] response error (${E})`,Pi({retryOfRequestLogID:r,url:C.url,status:C.status,headers:C.headers,message:b,durationMs:Date.now()-_})),this.makeStatusError(C.status,k,b,C.headers)}return Tt(this).info(w),Tt(this).debug(`[${p}] response start`,Pi({retryOfRequestLogID:r,url:C.url,status:C.status,headers:C.headers,durationMs:y-_})),{response:C,options:a,controller:x,requestLogID:p,retryOfRequestLogID:r,startTime:_}}async fetchWithTimeout(e,n,r,i){const o=n||{},{signal:s,method:a}=o,l=Fc(o,["signal","method"]);s&&s.addEventListener("abort",()=>i.abort());const u=setTimeout(()=>i.abort(),r),f=globalThis.ReadableStream&&l.body instanceof globalThis.ReadableStream||typeof l.body=="object"&&l.body!==null&&Symbol.asyncIterator in l.body,h=Object.assign(Object.assign(Object.assign({signal:i.signal},f?{duplex:"half"}:{}),{method:"GET"}),l);a&&(h.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,h)}finally{clearTimeout(u)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,i){var o;let s;const a=i==null?void 0:i.get("retry-after-ms");if(a){const u=parseFloat(a);Number.isNaN(u)||(s=u)}const l=i==null?void 0:i.get("retry-after");if(l&&!s){const u=parseFloat(l);Number.isNaN(u)?s=Date.parse(l)-Date.now():s=u*1e3}if(!(s&&0<=s&&s<60*1e3)){const u=(o=e.maxRetries)!==null&&o!==void 0?o:this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,u)}return await ZG(s),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const o=n-e,s=Math.min(.5*Math.pow(2,o),8),a=1-Math.random()*.25;return s*a*1e3}async buildRequest(e,{retryCount:n=0}={}){var r,i,o;const s=Object.assign({},e),{method:a,path:l,query:u,defaultBaseURL:f}=s,h=this.buildURL(l,u,f);"timeout"in s&&QG("timeout",s.timeout),s.timeout=(r=s.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:p,body:m}=this.buildBody({options:s}),_=await this.buildHeaders({options:e,method:a,bodyHeaders:p,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:a,headers:_},s.signal&&{signal:s.signal}),globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"}),m&&{body:m}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(o=s.fetchOptions)!==null&&o!==void 0?o:{}),url:h,timeout:s.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:i}){let o={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const s=await this.authHeaders(e);let a=Qs([o,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),rz()),this._options.defaultHeaders,r,e.headers,s]);return this.validateHeaders(a),a.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=Qs([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:oz(e)}:this.encoder({body:e,headers:r})}}$d.DEFAULT_TIMEOUT=6e4;class lt extends $d{constructor(){super(...arguments),this.interactions=new KI(this)}}QI=lt;lt.GeminiNextGenAPIClient=QI;lt.GeminiNextGenAPIClientError=wn;lt.APIError=Rt;lt.APIConnectionError=Gd;lt.APIConnectionTimeoutError=MI;lt.APIUserAbortError=Hp;lt.NotFoundError=UI;lt.ConflictError=FI;lt.RateLimitError=HI;lt.BadRequestError=DI;lt.AuthenticationError=LI;lt.InternalServerError=BI;lt.PermissionDeniedError=OI;lt.UnprocessableEntityError=VI;lt.toFile=fz;lt.Interactions=KI;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tz(t,e){const n={},r=c(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function Iz(t,e){const n={},r=c(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function kz(t,e){const n={},r=c(t,["sdkHttpResponse"]);return r!=null&&d(n,["sdkHttpResponse"],r),n}function bz(t,e){const n={},r=c(t,["sdkHttpResponse"]);return r!=null&&d(n,["sdkHttpResponse"],r),n}function Nz(t,e,n){const r={};if(c(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=c(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&d(e,["displayName"],i),c(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=c(t,["epochCount"]);e!==void 0&&o!=null&&d(e,["tuningTask","hyperparameters","epochCount"],o);const s=c(t,["learningRateMultiplier"]);if(s!=null&&d(r,["tuningTask","hyperparameters","learningRateMultiplier"],s),c(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(c(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=c(t,["batchSize"]);e!==void 0&&a!=null&&d(e,["tuningTask","hyperparameters","batchSize"],a);const l=c(t,["learningRate"]);if(e!==void 0&&l!=null&&d(e,["tuningTask","hyperparameters","learningRate"],l),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(c(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function Rz(t,e,n){const r={};let i=c(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const m=c(t,["validationDataset"]);e!==void 0&&m!=null&&d(e,["supervisedTuningSpec"],Mw(m))}else if(i==="PREFERENCE_TUNING"){const m=c(t,["validationDataset"]);e!==void 0&&m!=null&&d(e,["preferenceOptimizationSpec"],Mw(m))}const o=c(t,["tunedModelDisplayName"]);e!==void 0&&o!=null&&d(e,["tunedModelDisplayName"],o);const s=c(t,["description"]);e!==void 0&&s!=null&&d(e,["description"],s);let a=c(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const m=c(t,["epochCount"]);e!==void 0&&m!=null&&d(e,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if(a==="PREFERENCE_TUNING"){const m=c(t,["epochCount"]);e!==void 0&&m!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let l=c(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const m=c(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&d(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if(l==="PREFERENCE_TUNING"){const m=c(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let u=c(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const m=c(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&d(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if(u==="PREFERENCE_TUNING"){const m=c(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&d(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let f=c(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const m=c(t,["adapterSize"]);e!==void 0&&m!=null&&d(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if(f==="PREFERENCE_TUNING"){const m=c(t,["adapterSize"]);e!==void 0&&m!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(c(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=c(t,["labels"]);e!==void 0&&h!=null&&d(e,["labels"],h);const p=c(t,["beta"]);return e!==void 0&&p!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","beta"],p),r}function Az(t,e){const n={},r=c(t,["baseModel"]);r!=null&&d(n,["baseModel"],r);const i=c(t,["preTunedModel"]);i!=null&&d(n,["preTunedModel"],i);const o=c(t,["trainingDataset"]);o!=null&&Gz(o);const s=c(t,["config"]);return s!=null&&Nz(s,n),n}function Pz(t,e){const n={},r=c(t,["baseModel"]);r!=null&&d(n,["baseModel"],r);const i=c(t,["preTunedModel"]);i!=null&&d(n,["preTunedModel"],i);const o=c(t,["trainingDataset"]);o!=null&&zz(o,n,e);const s=c(t,["config"]);return s!=null&&Rz(s,n,e),n}function Mz(t,e){const n={},r=c(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function Dz(t,e){const n={},r=c(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function Lz(t,e,n){const r={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const o=c(t,["pageToken"]);e!==void 0&&o!=null&&d(e,["_query","pageToken"],o);const s=c(t,["filter"]);return e!==void 0&&s!=null&&d(e,["_query","filter"],s),r}function Oz(t,e,n){const r={},i=c(t,["pageSize"]);e!==void 0&&i!=null&&d(e,["_query","pageSize"],i);const o=c(t,["pageToken"]);e!==void 0&&o!=null&&d(e,["_query","pageToken"],o);const s=c(t,["filter"]);return e!==void 0&&s!=null&&d(e,["_query","filter"],s),r}function Uz(t,e){const n={},r=c(t,["config"]);return r!=null&&Lz(r,n),n}function Fz(t,e){const n={},r=c(t,["config"]);return r!=null&&Oz(r,n),n}function Vz(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const i=c(t,["nextPageToken"]);i!=null&&d(n,["nextPageToken"],i);const o=c(t,["tunedModels"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(a=>XI(a))),d(n,["tuningJobs"],s)}return n}function Hz(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const i=c(t,["nextPageToken"]);i!=null&&d(n,["nextPageToken"],i);const o=c(t,["tuningJobs"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(a=>zp(a))),d(n,["tuningJobs"],s)}return n}function Bz(t,e){const n={},r=c(t,["name"]);r!=null&&d(n,["model"],r);const i=c(t,["name"]);return i!=null&&d(n,["endpoint"],i),n}function Gz(t,e){const n={};if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=c(t,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),d(n,["examples","examples"],i)}return n}function zz(t,e,n){const r={};let i=c(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const s=c(t,["gcsUri"]);e!==void 0&&s!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(i==="PREFERENCE_TUNING"){const s=c(t,["gcsUri"]);e!==void 0&&s!=null&&d(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}let o=c(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const s=c(t,["vertexDatasetResource"]);e!==void 0&&s!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(o==="PREFERENCE_TUNING"){const s=c(t,["vertexDatasetResource"]);e!==void 0&&s!=null&&d(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}if(c(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function XI(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const i=c(t,["name"]);i!=null&&d(n,["name"],i);const o=c(t,["state"]);o!=null&&d(n,["state"],pI(o));const s=c(t,["createTime"]);s!=null&&d(n,["createTime"],s);const a=c(t,["tuningTask","startTime"]);a!=null&&d(n,["startTime"],a);const l=c(t,["tuningTask","completeTime"]);l!=null&&d(n,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&d(n,["updateTime"],u);const f=c(t,["description"]);f!=null&&d(n,["description"],f);const h=c(t,["baseModel"]);h!=null&&d(n,["baseModel"],h);const p=c(t,["_self"]);return p!=null&&d(n,["tunedModel"],Bz(p)),n}function zp(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const i=c(t,["name"]);i!=null&&d(n,["name"],i);const o=c(t,["state"]);o!=null&&d(n,["state"],pI(o));const s=c(t,["createTime"]);s!=null&&d(n,["createTime"],s);const a=c(t,["startTime"]);a!=null&&d(n,["startTime"],a);const l=c(t,["endTime"]);l!=null&&d(n,["endTime"],l);const u=c(t,["updateTime"]);u!=null&&d(n,["updateTime"],u);const f=c(t,["error"]);f!=null&&d(n,["error"],f);const h=c(t,["description"]);h!=null&&d(n,["description"],h);const p=c(t,["baseModel"]);p!=null&&d(n,["baseModel"],p);const m=c(t,["tunedModel"]);m!=null&&d(n,["tunedModel"],m);const _=c(t,["preTunedModel"]);_!=null&&d(n,["preTunedModel"],_);const x=c(t,["supervisedTuningSpec"]);x!=null&&d(n,["supervisedTuningSpec"],x);const C=c(t,["preferenceOptimizationSpec"]);C!=null&&d(n,["preferenceOptimizationSpec"],C);const y=c(t,["tuningDataStats"]);y!=null&&d(n,["tuningDataStats"],y);const w=c(t,["encryptionSpec"]);w!=null&&d(n,["encryptionSpec"],w);const v=c(t,["partnerModelTuningSpec"]);v!=null&&d(n,["partnerModelTuningSpec"],v);const E=c(t,["customBaseModel"]);E!=null&&d(n,["customBaseModel"],E);const I=c(t,["experiment"]);I!=null&&d(n,["experiment"],I);const k=c(t,["labels"]);k!=null&&d(n,["labels"],k);const b=c(t,["outputUri"]);b!=null&&d(n,["outputUri"],b);const T=c(t,["pipelineJob"]);T!=null&&d(n,["pipelineJob"],T);const R=c(t,["serviceAccount"]);R!=null&&d(n,["serviceAccount"],R);const N=c(t,["tunedModelDisplayName"]);N!=null&&d(n,["tunedModelDisplayName"],N);const D=c(t,["veoTuningSpec"]);return D!=null&&d(n,["veoTuningSpec"],D),n}function $z(t,e){const n={},r=c(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const i=c(t,["name"]);i!=null&&d(n,["name"],i);const o=c(t,["metadata"]);o!=null&&d(n,["metadata"],o);const s=c(t,["done"]);s!=null&&d(n,["done"],s);const a=c(t,["error"]);return a!=null&&d(n,["error"],a),n}function Mw(t,e){const n={},r=c(t,["gcsUri"]);r!=null&&d(n,["validationDatasetUri"],r);const i=c(t,["vertexDatasetResource"]);return i!=null&&d(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wz extends kr{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new fo(Cr.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},n),{preTunedModel:i});return o.baseModel=void 0,await this.tuneInternal(o)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),o=await this.tuneMldevInternal(i);let s="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?s=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(s=o.name.split("/operations/")[0]),{name:s,state:Rp.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=Dz(e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>zp(f))}else{const u=Mz(e);return a=H("{name}",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>XI(f))}}async listInternal(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=Fz(e);return a=H("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=Hz(f),p=new ow;return Object.assign(p,h),p})}else{const u=Uz(e);return a=H("tunedModels",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=Vz(f),p=new ow;return Object.assign(p,h),p})}}async cancel(e){var n,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const u=Iz(e);return a=H("{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=bz(f),p=new sw;return Object.assign(p,h),p})}else{const u=Tz(e);return a=H("{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const h=kz(f),p=new sw;return Object.assign(p,h),p})}}async tuneInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=Pz(e,e);return o=H("tuningJobs",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>zp(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Az(e);return o=H("tunedModels",a._url),s=a._query,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const f=u;return f.sdkHttpResponse={headers:l.headers},f})),i.then(l=>$z(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qz{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Jz=1024*1024*8,jz=3,Kz=1e3,Yz=2,Hc="x-goog-upload-status";async function Qz(t,e,n){var r;const i=await ZI(t,e,n),o=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[Hc])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function Xz(t,e,n){var r;const i=await ZI(t,e,n),o=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[Hc])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const s=lI(o),a=new sv;return Object.assign(a,s),a}async function ZI(t,e,n){var r,i;let o=0,s=0,a=new Pp(new Response),l="upload";for(o=t.size;s<o;){const u=Math.min(Jz,o-s),f=t.slice(s,s+u);s+u>=o&&(l+=", finalize");let h=0,p=Kz;for(;h<jz&&(a=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(s),"Content-Length":String(u)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[Hc]));)h++,await e6(p),p=p*Yz;if(s+=u,((i=a==null?void 0:a.headers)===null||i===void 0?void 0:i[Hc])!=="active")break;if(o<=s)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function Zz(t){return{size:t.size,type:t.type}}function e6(t){return new Promise(e=>setTimeout(e,t))}class t6{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Qz(e,n,r)}async uploadToFileSearchStore(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Xz(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Zz(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class n6{create(e,n,r){return new r6(e,n,r)}}class r6{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Dw="x-goog-api-key";class i6{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(Dw)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Dw,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const o6="gl-node/";class s6{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new lt({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=Z4(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new i6(this.apiKey);this.apiClient=new ZB({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:o6+"web",uploader:new t6,downloader:new qz}),this.models=new yG(this.apiClient),this.live=new fG(this.apiClient,i,new n6),this.batches=new b5(this.apiClient),this.chats=new u3(this.models,this.apiClient),this.caches=new s3(this.apiClient),this.files=new _3(this.apiClient),this.operations=new _G(this.apiClient),this.authTokens=new LG(this.apiClient),this.tunings=new Wz(this.apiClient),this.fileSearchStores=new zG(this.apiClient)}}const ek=()=>{const t="AIzaSyCPAlaLHaUnYHblJ9fSjji2Y_w4-ecZYMA";if(t.includes("PASTE_YOUR_NEW_KEY"))throw console.error("Critical Error: API Key is missing or invalid."),new Error("Missing API Key. Please update your .env file.");return new s6({apiKey:t})},a6=async(t,e=[],n="")=>{try{const r=ek(),i="gemini-3-flash-preview",o=`
      You are an expert E-Commerce Seller Support Assistant.
      
      GLOBAL SOP CONTEXT:
      ${kN}
      
      USER-SPECIFIC DIRECTIVE:
      ${n||"Standard professional response."}
      
      INSTRUCTIONS:
      - Answer the user's query professionally based on the context.
      - Provide a single, clear response in the primary language (English) unless explicitly asked to translate.
      - Use "We" and "Our" to represent the brand.
      - Maintain a professional, empathetic, and helpful tone.
    `;return(await r.chats.create({model:i,history:e,config:{systemInstruction:o}}).sendMessage({message:t})).text||""}catch(r){console.error("Gemini Error:",r);const i=r.message||JSON.stringify(r);return i.includes("API key expired")||i.includes("API_KEY_INVALID")?" SYSTEM ERROR: The Google API Key has expired. Please generate a new key at aistudio.google.com and update the website configuration.":`Error: ${r.message||"I encountered an issue connecting to the AI service."}`}},l6=async(t,e)=>{try{return(await ek().models.generateContent({model:"gemini-3-flash-preview",contents:`Translate the following text to ${e}. 
      Maintain a professional Customer Service tone suitable for e-commerce. 
      If there is slang, translate it to its professional equivalent in the target language.
      
      Text to translate:
      ${t}`,config:{systemInstruction:"You are a professional translator for Customer Service. Focus on speed, accuracy, and professional tone."}})).text||"Translation failed."}catch(n){if(console.error("Translation Error:",n),(n.message||"").includes("API key expired"))return"Error: API Key Expired. Please update config.";throw new Error(n.message||"Translation failed")}},u6=({user:t,isAdmin:e=!1})=>{var R;const[n,r]=S.useState(""),[i,o]=S.useState(()=>{if(t!=null&&t.uid){const N=localStorage.getItem(`chat_history_${t.uid}`);if(N)try{return JSON.parse(N,(D,G)=>D==="timestamp"?new Date(G):G)}catch(D){console.error("Failed to parse local chat history",D)}}return[]}),[s,a]=S.useState(!1),[l,u]=S.useState(!1),[f,h]=S.useState({aboutMe:"",responseStyle:"",isEnabled:!0}),[p,m]=S.useState(!1),[_,x]=S.useState(!1),C=S.useRef(null),y=S.useRef(null);S.useEffect(()=>{if(!(t!=null&&t.uid))return;const N=we.ref(`chats/${t.uid}`),D=we.ref(`user_config/${t.uid}/custom_instructions`),G=J=>{const re=J.val();if(re){const Oe=Date.now(),ee=72*60*60*1e3,V={},P=[];Object.entries(re).forEach(([A,B])=>{const $=new Date(B.timestamp).getTime();Oe-$>ee?V[A]=null:P.push({...B,id:A,timestamp:new Date(B.timestamp)})}),Object.keys(V).length>0&&N.update(V).catch(console.error),P.sort((A,B)=>A.timestamp.getTime()-B.timestamp.getTime()),o(P)}else if(i.length===0){const Oe=`Hello ${t.displayName||"there"}! I'm your Seller Support Assistant.

I can help you with customer inquiries, policy details, and SOPs.`;o([{id:"welcome",role:"model",text:Oe,timestamp:new Date}])}},F=J=>{const re=J.val();re&&h(re)};return N.on("value",G),D.on("value",F),()=>{N.off("value",G),D.off("value",F)}},[t]),S.useEffect(()=>{t!=null&&t.uid&&i.length>0&&localStorage.setItem(`chat_history_${t.uid}`,JSON.stringify(i))},[i,t]);const w=()=>{var N;(N=C.current)==null||N.scrollIntoView({behavior:"smooth"})};S.useEffect(()=>{w()},[i,s]),S.useEffect(()=>{y.current&&(y.current.style.height="auto",y.current.style.height=`${Math.min(y.current.scrollHeight,200)}px`)},[n]);const v=async()=>{if(t!=null&&t.uid){m(!0);try{await we.ref(`user_config/${t.uid}/custom_instructions`).set(f),x(!0),setTimeout(()=>x(!1),3e3)}catch(N){console.error(N)}finally{m(!1)}}},E=async()=>{if(t!=null&&t.uid&&window.confirm("Delete all chat messages? This cannot be undone."))try{const N=we.ref(`chats/${t.uid}`);o([]),localStorage.removeItem(`chat_history_${t.uid}`),await N.set(null)}catch(N){console.error("Failed to clear history",N),alert("Failed to clear history. Please try again.")}},I=async()=>{if(!n.trim()||s||!(t!=null&&t.uid))return;const N=n;r(""),a(!0),y.current&&(y.current.style.height="auto");const D=f.isEnabled?`CONTEXT ABOUT ME: ${f.aboutMe}

MY PREFERRED RESPONSE STYLE: ${f.responseStyle}`:"",G=we.ref(`chats/${t.uid}`);await G.push({role:"user",text:N,timestamp:new Date().toISOString()});try{const F=i.filter(re=>re.id!=="welcome"&&!re.text.startsWith("Error:")).map(re=>({role:re.role,parts:[{text:re.text}]})),J=await a6(N,F,D);await G.push({role:"model",text:J,timestamp:new Date().toISOString()})}catch(F){console.error(F);const J=`Error: ${F.message||"Check your configuration."}`;o(re=>[...re,{id:"error-"+Date.now(),role:"model",text:J,timestamp:new Date}])}finally{a(!1)}},k=N=>{if(N.key==="Enter"){if(N.shiftKey)return;N.preventDefault(),I()}},b=N=>{navigator.clipboard.writeText(N)},T=({text:N})=>{let D={english:N,portuguese:""};try{const F=JSON.parse(N);(F.english||F.portuguese)&&(D=F)}catch{}const G=F=>(F==null?void 0:F.replace(/\*\*/g,"").replace(/<br>/g,`
`).replace(/`/g,""))||"";return g.jsx("div",{className:"w-full",children:D.portuguese?g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[g.jsxs("div",{className:"flex flex-col gap-2",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-slate-300",children:"English Response"}),g.jsx("button",{onClick:()=>b(G(D.english)),className:"text-gray-400 hover:text-gray-900 dark:text-slate-500 dark:hover:text-white transition-colors",title:"Copy English",children:g.jsx(ji,{size:14})})]}),g.jsx("p",{className:"text-[15px] leading-relaxed text-gray-800 dark:text-slate-200 whitespace-pre-wrap font-normal",children:G(D.english)})]}),g.jsxs("div",{className:"flex flex-col gap-2",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-slate-300",children:"Portuguese Response"}),g.jsx("button",{onClick:()=>b(G(D.portuguese)),className:"text-gray-400 hover:text-gray-900 dark:text-slate-500 dark:hover:text-white transition-colors",title:"Copy Portuguese",children:g.jsx(ji,{size:14})})]}),g.jsx("p",{className:"text-[15px] leading-relaxed text-gray-800 dark:text-slate-200 whitespace-pre-wrap font-normal",children:G(D.portuguese)})]})]}):g.jsx("p",{className:"text-[15px] leading-relaxed text-gray-800 dark:text-slate-200 whitespace-pre-wrap font-normal",children:G(D.english)})})};return g.jsxs("div",{className:"h-full flex flex-col bg-[#f0f2f5] dark:bg-[#202124] text-gray-900 dark:text-white overflow-hidden relative font-sans animate-fade-in transition-colors duration-300",children:[!e&&g.jsx("div",{className:"absolute inset-0 z-50 bg-white/60 dark:bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white dark:bg-[#1e1e1e] border border-gray-200 dark:border-gray-700 rounded-3xl p-8 max-w-sm w-full shadow-2xl text-center transform scale-100",children:[g.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-6 text-gray-400 dark:text-gray-500",children:g.jsx(Ga,{size:32})}),g.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Coming Soon"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 leading-relaxed mb-6",children:"This feature is currently under maintenance or in development. Please check back later or contact an administrator."}),g.jsx("div",{className:"flex justify-center",children:g.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-500 rounded-full text-[10px] font-bold uppercase tracking-widest",children:"Under Maintenance"})})]})}),g.jsx("div",{className:`flex-1 overflow-y-auto px-4 md:px-0 py-6 custom-scrollbar scroll-smooth ${e?"":"blur-sm opacity-50 overflow-hidden"}`,children:g.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[i.length===0&&g.jsxs("div",{className:"mt-20 text-center space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[g.jsx("div",{className:"w-16 h-16 bg-gradient-to-tr from-blue-500 to-red-500 rounded-full mx-auto flex items-center justify-center shadow-lg shadow-purple-500/20 mb-6",children:g.jsx(ZN,{size:32,className:"text-white fill-white"})}),g.jsxs("h1",{className:"text-4xl md:text-5xl font-medium bg-gradient-to-r from-blue-600 via-purple-600 to-red-500 text-transparent bg-clip-text",children:["Hello, ",((R=t.displayName)==null?void 0:R.split(" ")[0])||"Agent"]}),g.jsx("p",{className:"text-xl text-gray-500 dark:text-slate-400 font-light",children:"How can I help with your cases today?"})]}),i.map(N=>g.jsx("div",{className:"group animate-in fade-in slide-in-from-bottom-2 duration-500",children:N.role==="user"?g.jsx("div",{className:"flex justify-end mb-6",children:g.jsx("div",{className:"bg-white dark:bg-[#282a2c] text-gray-800 dark:text-white px-5 py-3.5 rounded-3xl rounded-br-sm max-w-[80%] shadow-sm border border-gray-200 dark:border-transparent text-[15px] leading-relaxed whitespace-pre-wrap",children:N.text})}):g.jsxs("div",{className:"flex gap-4 mb-8",children:[g.jsx("div",{className:"flex-shrink-0 mt-1",children:g.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-tr from-blue-600 to-red-600 flex items-center justify-center shadow-lg",children:g.jsx(Cf,{size:16,className:"text-white fill-white"})})}),g.jsx("div",{className:"flex-1 min-w-0 py-1",children:g.jsx(T,{text:N.text})})]})},N.id)),s&&g.jsxs("div",{className:"flex gap-4 mb-8 animate-pulse",children:[g.jsx("div",{className:"flex-shrink-0 mt-1",children:g.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-tr from-blue-600 to-red-600 flex items-center justify-center",children:g.jsx(Cf,{size:16,className:"text-white"})})}),g.jsxs("div",{className:"flex-1 space-y-3 py-2",children:[g.jsx("div",{className:"h-4 bg-gray-200 dark:bg-[#282a2c] rounded w-3/4"}),g.jsx("div",{className:"h-4 bg-gray-200 dark:bg-[#282a2c] rounded w-1/2"})]})]}),g.jsx("div",{ref:C,className:"h-4"})]})}),g.jsx("div",{className:`p-4 md:p-6 bg-[#f0f2f5] dark:bg-[#202124] transition-colors duration-300 ${e?"":"blur-sm opacity-50 pointer-events-none"}`,children:g.jsxs("div",{className:"max-w-3xl mx-auto",children:[g.jsxs("div",{className:"relative bg-white dark:bg-[#1e1f20] rounded-3xl border border-gray-200 dark:border-transparent focus-within:ring-2 focus-within:ring-blue-100 dark:focus-within:bg-[#282a2c] dark:focus-within:ring-0 shadow-sm transition-all",children:[f.isEnabled&&(f.aboutMe||f.responseStyle)&&g.jsx("div",{className:"absolute -top-8 left-4 flex items-center gap-2",children:g.jsxs("div",{className:"flex items-center gap-1.5 bg-white dark:bg-[#1e1f20] text-gray-500 dark:text-slate-400 text-[10px] font-medium uppercase px-3 py-1 rounded-full border border-gray-200 dark:border-[#282a2c] shadow-sm",children:[g.jsx(LN,{size:12}),g.jsx("span",{children:"Custom Instructions Active"})]})}),g.jsx("textarea",{ref:y,value:n,onChange:N=>r(N.target.value),onKeyDown:k,placeholder:"Ask Gemini",className:"w-full bg-transparent text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-slate-500 rounded-3xl pl-6 pr-14 py-4 focus:outline-none resize-none custom-scrollbar overflow-hidden min-h-[56px] text-base",disabled:s,rows:1}),g.jsxs("div",{className:"absolute right-2 bottom-2 flex items-center gap-1",children:[g.jsx("button",{onClick:()=>u(!0),className:"p-2 text-gray-400 hover:text-gray-900 dark:text-slate-400 dark:hover:text-white rounded-full hover:bg-gray-100 dark:hover:bg-[#333537] transition-colors",title:"Instructions",children:g.jsx(XN,{size:20})}),g.jsx("button",{onClick:E,className:"p-2 text-gray-400 hover:text-red-500 dark:text-slate-400 dark:hover:text-red-500 rounded-full hover:bg-gray-100 dark:hover:bg-[#333537] transition-colors",title:"Clear History",children:g.jsx(_r,{size:20})}),g.jsx("button",{onClick:I,disabled:s||!n.trim(),className:`p-2 rounded-full transition-all flex items-center justify-center ${n.trim()?"bg-blue-600 text-white hover:bg-blue-700 dark:bg-white dark:text-black dark:hover:bg-slate-200":"bg-gray-200 text-gray-400 dark:bg-[#333537] dark:text-slate-500 cursor-not-allowed"}`,children:s?g.jsx(Vg,{className:"animate-spin",size:20}):g.jsx(QN,{size:20,className:n.trim()?"ml-0.5":""})})]})]}),g.jsx("p",{className:"text-center text-[11px] text-gray-400 dark:text-slate-500 mt-3",children:"Gemini can make mistakes. Chat is saved locally and synced for continuity."})]})}),l&&g.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:g.jsxs("div",{className:"bg-white dark:bg-[#1e1f20] border border-gray-200 dark:border-[#282a2c] w-full max-w-xl rounded-3xl shadow-2xl overflow-hidden flex flex-col transition-colors",children:[g.jsxs("div",{className:"px-8 py-6 border-b border-gray-100 dark:border-[#282a2c] flex justify-between items-center",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(Cf,{className:"text-blue-500 dark:text-blue-400",size:18}),g.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"System Instructions"})]}),g.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-900 dark:text-slate-400 dark:hover:text-white transition-colors",children:g.jsx(io,{size:20})})]}),g.jsxs("div",{className:"p-8 space-y-6",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"text-xs font-medium text-gray-500 dark:text-slate-400",children:"What should the AI know about you?"}),g.jsx("textarea",{value:f.aboutMe,onChange:N=>h({...f,aboutMe:N.target.value}),className:"w-full h-24 bg-gray-50 dark:bg-[#0b0b0b] border border-gray-200 dark:border-[#282a2c] rounded-xl p-4 text-sm text-gray-900 dark:text-slate-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none resize-none transition-all placeholder-gray-400 dark:placeholder-slate-600",placeholder:"e.g., I am a senior agent handling escalated logistics cases."})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"text-xs font-medium text-gray-500 dark:text-slate-400",children:"How should the AI respond?"}),g.jsx("textarea",{value:f.responseStyle,onChange:N=>h({...f,responseStyle:N.target.value}),className:"w-full h-24 bg-gray-50 dark:bg-[#0b0b0b] border border-gray-200 dark:border-[#282a2c] rounded-xl p-4 text-sm text-gray-900 dark:text-slate-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none resize-none transition-all placeholder-gray-400 dark:placeholder-slate-600",placeholder:"e.g., Use a very formal tone, always include the ticket ID placeholder."})]}),g.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100 dark:border-[#282a2c]",children:[g.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[g.jsx("div",{className:`w-10 h-6 rounded-full p-1 transition-colors ${f.isEnabled?"bg-blue-600":"bg-gray-300 dark:bg-[#333537]"}`,children:g.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-sm transition-transform ${f.isEnabled?"translate-x-4":"translate-x-0"}`})}),g.jsx("input",{type:"checkbox",className:"hidden",checked:f.isEnabled,onChange:N=>h({...f,isEnabled:N.target.checked})}),g.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-slate-300",children:"Enable Custom Instructions"})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[_&&g.jsx("span",{className:"text-xs text-green-500 dark:text-green-400",children:"Saved"}),g.jsx("button",{onClick:v,className:"bg-gray-900 dark:bg-white text-white dark:text-black hover:opacity-90 px-6 py-2 rounded-full text-xs font-bold transition-all",children:p?"Saving...":"Save"})]})]})]}),g.jsx("div",{className:"p-4 bg-gray-50 dark:bg-[#282a2c]/50 text-center",children:g.jsxs("button",{onClick:E,className:"text-xs text-red-500 hover:text-red-600 dark:text-red-400 dark:hover:text-red-300 flex items-center justify-center gap-2 w-full",children:[g.jsx(_r,{size:12})," Clear Chat History"]})})]})})]})},c6=({isAdmin:t=!1})=>{const[e,n]=S.useState(""),[r,i]=S.useState(""),[o,s]=S.useState(!1),[a,l]=S.useState(!1),[u,f]=S.useState("Portuguese (Brazil)"),[h,p]=S.useState("English"),m=S.useRef(null);S.useEffect(()=>{if(m.current&&clearTimeout(m.current),!e.trim()){i(""),s(!1);return}return s(!0),m.current=setTimeout(()=>{_()},1e3),()=>{m.current&&clearTimeout(m.current)}},[e,u]);const _=async()=>{if(e.trim()){s(!0);try{const y=await l6(e,u);i(y)}catch(y){console.error("Translation failed",y)}finally{s(!1)}}},x=()=>{r&&(navigator.clipboard.writeText(r),l(!0),setTimeout(()=>l(!1),2e3))},C=()=>{const y=h,w=u,v=e,E=r;p(w),f(y),n(E),i(v)};return g.jsxs("div",{className:"p-6 md:p-12 max-w-6xl mx-auto h-full flex flex-col animate-fade-in overflow-y-auto relative",children:[!t&&g.jsx("div",{className:"absolute inset-0 z-50 bg-white/60 dark:bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white dark:bg-[#1e1e1e] border border-gray-200 dark:border-gray-700 rounded-3xl p-8 max-w-sm w-full shadow-2xl text-center transform scale-100",children:[g.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-6 text-gray-400 dark:text-gray-500",children:g.jsx(Ga,{size:32})}),g.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Coming Soon"}),g.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 leading-relaxed mb-6",children:"This feature is currently under maintenance or in development. Please check back later or contact an administrator."}),g.jsx("div",{className:"flex justify-center",children:g.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-500 rounded-full text-[10px] font-bold uppercase tracking-widest",children:"Under Maintenance"})})]})}),g.jsxs("div",{className:`mb-8 text-center md:text-left ${t?"":"blur-sm opacity-50"}`,children:[g.jsxs("div",{className:"flex items-center gap-2 mb-2 justify-center md:justify-start",children:[g.jsx(rd,{className:"text-orange-500",size:20}),g.jsx("span",{className:"text-xs font-black text-orange-500 uppercase tracking-widest",children:"AI Intelligence Tool"})]}),g.jsx("h2",{className:"text-4xl font-bold mb-4 text-gray-900 dark:text-white",children:"AI Pro Translator"}),g.jsx("p",{className:"text-gray-500 dark:text-slate-400 text-lg max-w-2xl",children:"Lightning-fast translations between English and Portuguese, optimized for professional Customer Service."})]}),g.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 gap-6 flex-1 min-h-[400px] ${t?"":"blur-sm opacity-50"}`,children:[g.jsxs("div",{className:"group relative bg-white dark:bg-slate-800 rounded-2xl border border-gray-200 dark:border-slate-700 p-6 flex flex-col transition-all shadow-xl overflow-hidden",children:[g.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-blue-500 to-indigo-700 opacity-5 blur-2xl rounded-full -mr-10 -mt-10"}),g.jsxs("div",{className:"flex items-center justify-between mb-4 relative z-10",children:[g.jsx("span",{className:"text-[10px] font-black text-gray-500 dark:text-slate-500 uppercase tracking-widest",children:h}),g.jsx("button",{onClick:C,className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-full text-gray-500 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 transition-all active:rotate-180 duration-500",title:"Swap Languages",children:g.jsx(MN,{size:16})})]}),g.jsx("textarea",{value:e,onChange:y=>n(y.target.value),placeholder:"Start typing to translate...",className:"flex-1 bg-transparent text-gray-900 dark:text-white text-xl placeholder-gray-400 dark:placeholder-slate-600 focus:outline-none resize-none custom-scrollbar font-medium relative z-10"}),e&&g.jsx("button",{onClick:()=>n(""),className:"absolute bottom-6 right-6 p-2 bg-gray-100 dark:bg-slate-700 hover:bg-gray-200 dark:hover:bg-slate-600 text-gray-500 dark:text-slate-400 rounded-lg text-[9px] font-black uppercase tracking-widest transition-colors z-10",children:"Clear"})]}),g.jsxs("div",{className:"group relative bg-gray-50 dark:bg-slate-900 rounded-2xl border border-gray-200 dark:border-slate-800 p-6 flex flex-col transition-all shadow-2xl overflow-hidden",children:[g.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-orange-500 to-red-700 opacity-5 blur-2xl rounded-full -mr-10 -mt-10"}),g.jsxs("div",{className:"flex items-center justify-between mb-4 relative z-10",children:[g.jsx("span",{className:"text-[10px] font-black text-blue-600 dark:text-blue-400 uppercase tracking-widest",children:u}),r&&!o&&g.jsxs("button",{onClick:x,className:"flex items-center gap-1.5 text-[9px] font-black text-gray-500 dark:text-slate-500 hover:text-gray-900 dark:hover:text-white transition-colors bg-white dark:bg-slate-800 px-3 py-1 rounded-full border border-gray-200 dark:border-slate-700 shadow-sm",children:[a?g.jsx(KE,{size:12,className:"text-green-500"}):g.jsx(ji,{size:12}),a?"COPIED":"COPY"]})]}),g.jsxs("div",{className:"flex-1 relative z-10 overflow-y-auto custom-scrollbar",children:[o?g.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-50/40 dark:bg-slate-900/40 backdrop-blur-[1px]",children:[g.jsx(Vg,{className:"animate-spin text-blue-500",size:32}),g.jsx("span",{className:"mt-3 text-[9px] font-black text-gray-400 dark:text-slate-500 uppercase tracking-widest animate-pulse",children:"Processing"})]}):null,g.jsx("p",{className:`text-xl font-medium leading-relaxed ${r?"text-gray-900 dark:text-white":"text-gray-400 dark:text-slate-700 italic"}`,children:r||"Translation result..."})]})]})]}),g.jsxs("div",{className:`mt-6 bg-white/50 dark:bg-slate-800/50 p-6 rounded-2xl border border-gray-200 dark:border-slate-700 flex flex-wrap items-center justify-between gap-6 shadow-lg ${t?"":"blur-sm opacity-50"}`,children:[g.jsxs("div",{className:"flex items-center gap-8",children:[g.jsxs("div",{className:"flex flex-col",children:[g.jsx("span",{className:"text-[9px] font-black text-gray-500 dark:text-slate-500 uppercase tracking-widest mb-1",children:"Target Language"}),g.jsxs("select",{value:u,onChange:y=>f(y.target.value),className:"bg-gray-100 dark:bg-slate-700 text-gray-900 dark:text-white font-black text-xs px-3 py-1.5 rounded-lg focus:outline-none cursor-pointer hover:bg-gray-200 dark:hover:bg-slate-600 transition-colors border-none",children:[g.jsx("option",{value:"Portuguese (Brazil)",children:"Portuguese (Brazil)"}),g.jsx("option",{value:"English",children:"English"}),g.jsx("option",{value:"Spanish",children:"Spanish"}),g.jsx("option",{value:"Chinese (Simplified)",children:"Chinese (Simplified)"})]})]}),g.jsx("div",{className:"h-10 w-px bg-gray-200 dark:bg-slate-700 hidden sm:block"}),g.jsxs("div",{className:"flex flex-col",children:[g.jsx("span",{className:"text-[9px] font-black text-gray-500 dark:text-slate-500 uppercase tracking-widest mb-1",children:"AI Engine"}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(iR,{size:14,className:"text-yellow-500"}),g.jsx("span",{className:"text-gray-900 dark:text-white font-black text-xs uppercase tracking-tight",children:"Gemini 3 Flash"})]})]})]}),g.jsx("div",{className:"text-[10px] font-bold text-gray-500 dark:text-slate-500 uppercase tracking-wider text-right max-w-xs leading-relaxed hidden sm:block",children:"Optimized for professional tone and e-commerce terminology."})]})]})},mu="spiel_editor_state",d6=()=>{var ee,V;const t=S.useRef(null),e=S.useRef(null),[n,r]=S.useState(null),[i,o]=S.useState([]),[s,a]=S.useState(null),[l,u]=S.useState("select"),[f,h]=S.useState(!1),[p,m]=S.useState({x:0,y:0}),[_,x]=S.useState("#ef4444"),[C,y]=S.useState([[]]),[w,v]=S.useState(0);S.useEffect(()=>{(()=>{try{const A=localStorage.getItem(mu);if(A){const B=JSON.parse(A);if(B.imageBase64){const $=new Image;$.src=B.imageBase64,$.onload=()=>r($)}B.objects&&B.objects.length>0&&(o(B.objects),y([B.objects]),v(0))}}catch(A){console.error("Failed to load editor state from localStorage",A)}})()},[]),S.useEffect(()=>{const P=async()=>{if(!n)return;let A=n.src;if(n.src.startsWith("blob:"))try{const $=await(await fetch(n.src)).blob(),q=new FileReader;q.readAsDataURL($),q.onloadend=()=>{const ue=q.result;try{localStorage.setItem(mu,JSON.stringify({imageBase64:ue,objects:i,timestamp:Date.now()}))}catch{console.warn("LocalStorage quota exceeded, cannot save image state.")}};return}catch(B){console.error("Failed to convert blob for saving",B);return}try{localStorage.setItem(mu,JSON.stringify({imageBase64:A,objects:i,timestamp:Date.now()}))}catch{console.warn("LocalStorage quota exceeded, cannot save image state.")}};if(n){const A=setTimeout(P,500);return()=>clearTimeout(A)}},[n,i]);const E=P=>{const A=C.slice(0,w+1);A.push(P),y(A),v(A.length-1),o(P)},I=S.useCallback(()=>{if(w>0){const P=w-1;v(P),o(C[P])}},[C,w]),k=S.useCallback(()=>{if(w<C.length-1){const P=w+1;v(P),o(C[P])}},[C,w]),b=S.useCallback(()=>{if(i.length>0){const P=i.slice(0,-1);E(P)}},[i,C,w]);S.useEffect(()=>{const P=A=>{(A.ctrlKey||A.metaKey)&&A.key==="z"&&(A.preventDefault(),I()),(A.ctrlKey||A.metaKey)&&(A.key==="y"||A.shiftKey&&A.key==="Z")&&(A.preventDefault(),k()),(A.key==="Backspace"||A.key==="Delete")&&i.length>0&&(A.preventDefault(),b())};return window.addEventListener("keydown",P),()=>window.removeEventListener("keydown",P)},[I,k,b,i]),S.useEffect(()=>{const P=A=>{var $;const B=($=A.clipboardData)==null?void 0:$.items;if(B){for(let q=0;q<B.length;q++)if(B[q].type.indexOf("image")!==-1){const ue=B[q].getAsFile();if(ue){const ve=new Image;ve.src=URL.createObjectURL(ue),ve.onload=()=>{r(ve),o([]),y([[]]),v(0),a(null)}}}}};return window.addEventListener("paste",P),()=>window.removeEventListener("paste",P)},[]);const T=(P,A,B,$,q)=>{const ve=$-A,ae=q-B,Ae=Math.atan2(ae,ve);P.moveTo(A,B),P.lineTo($,q),P.lineTo($-20*Math.cos(Ae-Math.PI/6),q-20*Math.sin(Ae-Math.PI/6)),P.moveTo($,q),P.lineTo($-20*Math.cos(Ae+Math.PI/6),q-20*Math.sin(Ae+Math.PI/6))},R=(P,A,B,$,q)=>{const ue=Math.abs($-A)/2,ve=Math.abs(q-B)/2,ae=Math.min(A,$)+ue,Ae=Math.min(B,q)+ve;P.ellipse(ae,Ae,ue,ve,0,0,2*Math.PI)},N=(P,A,B,$,q)=>{P.rect(A,B,$-A,q-B)};S.useEffect(()=>{const P=t.current;if(!P||!e.current)return;const A=P.getContext("2d");if(!A)return;const B=e.current;if(A.clearRect(0,0,P.width,P.height),n){const q=B.clientWidth-40,ue=B.clientHeight-40;let ve=n.width,ae=n.height;if(ve>q||ae>ue){const Ae=Math.min(q/ve,ue/ae);ve*=Ae,ae*=Ae}P.width=ve,P.height=ae,A.drawImage(n,0,0,ve,ae)}else P.width=B.clientWidth-40,P.height=500,A.fillStyle=window.matchMedia("(prefers-color-scheme: dark)").matches?"#282a2c":"#ffffff",A.fillRect(0,0,P.width,P.height),A.strokeStyle="#94a3b8",A.lineWidth=2,A.setLineDash([10,10]),A.strokeRect(10,10,P.width-20,P.height-20),A.setLineDash([]),A.fillStyle="#94a3b8",A.font="bold 20px Inter, sans-serif",A.textAlign="center",A.fillText("Paste Image (Ctrl+V) to Start Editing",P.width/2,P.height/2);const $=q=>{A.strokeStyle=q.color,A.lineWidth=4,A.lineCap="round",A.lineJoin="round",A.beginPath(),q.type==="arrow"?T(A,q.x,q.y,q.endX,q.endY):q.type==="circle"?R(A,q.x,q.y,q.endX,q.endY):q.type==="box"&&N(A,q.x,q.y,q.endX,q.endY),A.stroke()};i.forEach($),s&&(A.save(),A.shadowColor="rgba(0,0,0,0.5)",A.shadowBlur=10,$(s),A.restore())},[n,i,s,(ee=e.current)==null?void 0:ee.clientWidth,(V=e.current)==null?void 0:V.clientHeight]);const D=P=>{const A=t.current;if(!A)return{x:0,y:0};const B=A.getBoundingClientRect();return{x:P.clientX-B.left,y:P.clientY-B.top}},G=P=>{if(l==="select"||!n)return;h(!0);const A=D(P);m(A)},F=P=>{if(!f||l==="select")return;const A=D(P);a({type:l,x:p.x,y:p.y,endX:A.x,endY:A.y,color:_})},J=P=>{if(!(!f||l==="select")&&(h(!1),s)){const A=[...i,s];E(A),a(null)}},re=async()=>{t.current&&t.current.toBlob(P=>{P&&(navigator.clipboard.write([new ClipboardItem({"image/png":P})]),alert("Copied to clipboard!"))})},Oe=async()=>{r(null),o([]),y([[]]),v(0),a(null),localStorage.removeItem(mu)};return g.jsxs("div",{className:"h-full flex flex-col bg-[#f0f2f5] dark:bg-[#202124]",children:[g.jsxs("div",{className:"p-4 bg-white dark:bg-[#1e1e1e] border-b border-gray-200 dark:border-gray-700 flex flex-wrap items-center justify-between gap-4 shadow-sm z-10",children:[g.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[g.jsxs("div",{className:"flex items-center bg-gray-100 dark:bg-gray-800 p-1 rounded-lg",children:[g.jsx("button",{onClick:()=>u("select"),className:`p-2 rounded-md transition-all ${l==="select"?"bg-white dark:bg-gray-600 text-blue-600 dark:text-blue-300 shadow-sm":"text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,title:"View Mode",children:g.jsx(JN,{size:18})}),g.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-2"}),g.jsx("button",{onClick:()=>u("arrow"),className:`p-2 rounded-md transition-all ${l==="arrow"?"bg-white dark:bg-gray-600 text-blue-600 dark:text-blue-300 shadow-sm":"text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,title:"Draw Arrow",children:g.jsx(DN,{size:18})}),g.jsx("button",{onClick:()=>u("box"),className:`p-2 rounded-md transition-all ${l==="box"?"bg-white dark:bg-gray-600 text-blue-600 dark:text-blue-300 shadow-sm":"text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,title:"Draw Box",children:g.jsx(eR,{size:18})}),g.jsx("button",{onClick:()=>u("circle"),className:`p-2 rounded-md transition-all ${l==="circle"?"bg-white dark:bg-gray-600 text-blue-600 dark:text-blue-300 shadow-sm":"text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"}`,title:"Draw Circle",children:g.jsx(UN,{size:18})})]}),g.jsx("div",{className:"flex items-center bg-gray-100 dark:bg-gray-800 p-1 rounded-lg px-2 gap-3",children:g.jsx("input",{type:"color",value:_,onChange:P=>x(P.target.value),className:"w-6 h-6 rounded cursor-pointer border-0 bg-transparent p-0",title:"Choose Color"})}),g.jsx("div",{className:"h-8 w-px bg-gray-200 dark:bg-gray-700 mx-1"}),g.jsx("button",{onClick:I,disabled:w<=0,className:"p-2.5 text-gray-500 dark:text-gray-400 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors flex items-center gap-2 disabled:opacity-30 disabled:hover:bg-transparent disabled:hover:text-gray-500",title:"Undo (Ctrl+Z)",children:g.jsx(tR,{size:16})}),g.jsx("button",{onClick:k,disabled:w>=C.length-1,className:"p-2.5 text-gray-500 dark:text-gray-400 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors flex items-center gap-2 disabled:opacity-30 disabled:hover:bg-transparent disabled:hover:text-gray-500",title:"Redo (Ctrl+Y)",children:g.jsx(KN,{size:16})}),g.jsx("div",{className:"h-8 w-px bg-gray-200 dark:bg-gray-700 mx-1"}),g.jsx("button",{onClick:b,disabled:i.length===0,className:"p-2.5 text-gray-500 dark:text-gray-400 hover:text-orange-500 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-lg transition-colors flex items-center gap-2 disabled:opacity-30",title:"Eraser: Undo Last Shape (Delete Key)",children:g.jsx(VN,{size:16})}),g.jsx("button",{onClick:Oe,disabled:!n,className:"p-2.5 text-gray-500 dark:text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors flex items-center gap-2 disabled:opacity-30",title:"Reset: Delete Image & Clear All",children:g.jsx(_r,{size:16})})]}),g.jsx("div",{children:g.jsxs("button",{onClick:re,disabled:!n,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-xl text-xs font-black uppercase tracking-widest shadow-lg shadow-blue-500/30 transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:hover:translate-y-0",children:[g.jsx(ji,{size:16})," Copy Result"]})})]}),g.jsx("div",{ref:e,className:"flex-1 bg-gray-200 dark:bg-[#0f172a] overflow-hidden flex items-center justify-center relative",children:g.jsx("canvas",{ref:t,onMouseDown:G,onMouseMove:F,onMouseUp:J,onMouseLeave:J,className:`shadow-2xl rounded-lg transition-shadow ${l==="select"?"cursor-default":"cursor-crosshair"}`})}),g.jsx("div",{className:"bg-white dark:bg-[#1e1e1e] p-2 border-t border-gray-200 dark:border-gray-800 text-center",children:g.jsxs("p",{className:"text-[10px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest flex items-center justify-center gap-2",children:[g.jsx(ZE,{size:12}),"Paste Image (Ctrl+V)  Undo (Ctrl+Z)  Redo (Ctrl+Y)  Auto-saved Locally"]})})]})},f6=({currentUserEmail:t})=>{const[e,n]=S.useState([]),[r,i]=S.useState(!0),[o,s]=S.useState(""),[a,l]=S.useState(""),[u,f]=S.useState("user"),[h,p]=S.useState(""),[m,_]=S.useState(null);S.useEffect(()=>{const v=we.ref("accounts"),E=I=>{const k=I.val();if(k){const b=Object.values(k).map(T=>({role:T.role||"user",email:T.email||"",username:T.username||"",displayName:T.displayName||T.username||T.email||"Unknown",photoURL:T.photoURL||null,uid:T.uid||"",isLocal:T.isLocal||!1,password:T.password}));n(b.sort((T,R)=>{if(T.role==="admin"&&R.role!=="admin")return-1;if(T.role!=="admin"&&R.role==="admin")return 1;const N=T.email||T.username||"",D=R.email||R.username||"";return N.localeCompare(D)}))}else n([]);i(!1)};return v.on("value",E),()=>v.off("value",E)},[]);const x=async v=>{if(v.preventDefault(),!o.trim())return;const E=o.trim(),I=E.replace(/\./g,",");if(e.find(b=>b.username===E||b.email===E)){window.confirm(`User ${E} already exists. Update role to ${u}?`)&&(await we.ref(`accounts/${I}/role`).set(u),a&&await we.ref(`accounts/${I}/password`).set(a),_(`Updated user: ${E}`),s(""),l(""));return}try{const b=E.includes("@"),T={role:u,addedBy:t,addedAt:Date.now(),displayName:E.split("@")[0],photoURL:null,isLocal:!b||!!a};b&&!a?T.email=E:(T.username=E,T.password=a),await we.ref(`accounts/${I}`).set(T),_(`Added ${u}: ${E}`),s(""),l("")}catch(b){console.error(b),_("Failed to add user.")}},C=async v=>{const E=v.email||v.username;if(!E)return;if(E==="admin@internal"){_("Master Admin role cannot be changed.");return}if(E===t&&!window.confirm("You are about to change your own role. You might lose access to this panel. Continue?"))return;const I=v.role==="admin"?"user":"admin",k=E.replace(/\./g,",");try{await we.ref(`accounts/${k}/role`).set(I),_(`Changed ${E} to ${I}`)}catch(b){console.error(b),_("Failed to update role")}},y=async v=>{const E=v.email||v.username;if(E){if(E==="admin@internal"){_("Cannot delete the Master Admin.");return}if(E===t){_("You cannot delete yourself.");return}if(window.confirm(`Are you sure you want to remove ${E}?`))try{const I=E.replace(/\./g,",");await we.ref(`accounts/${I}`).remove(),_(`Removed user: ${E}`)}catch(I){console.error(I),_("Failed to remove user.")}}},w=e.filter(v=>{if(!v)return!1;const E=h.toLowerCase(),I=(v.email||"").toLowerCase().includes(E),k=(v.username||"").toLowerCase().includes(E),b=(v.displayName||"").toLowerCase().includes(E);return I||k||b});return g.jsxs("div",{className:"p-6 md:p-12 max-w-5xl mx-auto h-full flex flex-col animate-fade-in overflow-y-auto",children:[m&&g.jsx(jh,{message:m}),g.jsxs("div",{className:"mb-8",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[g.jsx(Bh,{className:"text-blue-600",size:24}),g.jsx("span",{className:"text-xs font-black text-blue-600 uppercase tracking-widest",children:"Super Admin Console"})]}),g.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Member Accounts"}),g.jsx("p",{className:"text-gray-500 dark:text-slate-400",children:"Manage access. Create local credentials or pre-approve Google emails."})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[g.jsx("div",{className:"lg:col-span-1",children:g.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg border border-gray-100 dark:border-slate-700 sticky top-4",children:[g.jsxs("h3",{className:"text-sm font-black uppercase tracking-wide text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[g.jsx(rR,{size:16})," Add Member"]}),g.jsxs("form",{onSubmit:x,className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-slate-400 mb-1.5 uppercase",children:"Username or Email"}),g.jsxs("div",{className:"relative",children:[g.jsx(pa,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),g.jsx("input",{type:"text",value:o,onChange:v=>s(v.target.value),className:"w-full pl-10 p-3 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-700 rounded-xl text-sm text-gray-900 dark:text-white outline-none focus:border-blue-500 transition-colors placeholder-gray-400",placeholder:"john.doe or john@gmail.com",required:!0})]})]}),g.jsxs("div",{children:[g.jsxs("label",{className:"block text-xs font-bold text-gray-500 dark:text-slate-400 mb-1.5 uppercase",children:["Password ",g.jsx("span",{className:"text-gray-400 font-normal lowercase",children:"(optional for Google users)"})]}),g.jsxs("div",{className:"relative",children:[g.jsx(Ga,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),g.jsx("input",{type:"text",value:a,onChange:v=>l(v.target.value),className:"w-full pl-10 p-3 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-700 rounded-xl text-sm text-gray-900 dark:text-white outline-none focus:border-blue-500 transition-colors placeholder-gray-400",placeholder:"Set a password"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-gray-500 dark:text-slate-400 mb-1.5 uppercase",children:"Initial Role"}),g.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[g.jsxs("button",{type:"button",onClick:()=>f("user"),className:`p-3 rounded-xl border flex items-center justify-center gap-2 text-sm font-bold transition-all ${u==="user"?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300":"bg-gray-50 border-gray-200 dark:border-slate-700 text-gray-500 hover:bg-gray-100 dark:bg-slate-900 dark:text-slate-400"}`,children:[g.jsx(pa,{size:16})," User"]}),g.jsxs("button",{type:"button",onClick:()=>f("admin"),className:`p-3 rounded-xl border flex items-center justify-center gap-2 text-sm font-bold transition-all ${u==="admin"?"bg-purple-50 border-purple-200 text-purple-700 dark:bg-purple-900/30 dark:border-purple-800 dark:text-purple-300":"bg-gray-50 border-gray-200 dark:border-slate-700 text-gray-500 hover:bg-gray-100 dark:bg-slate-900 dark:text-slate-400"}`,children:[g.jsx(Bh,{size:16})," Admin"]})]})]}),g.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-sm shadow-lg shadow-blue-500/30 transition-all flex items-center justify-center gap-2",children:"Create / Update User"})]}),g.jsxs("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-slate-900/50 rounded-xl border border-blue-100 dark:border-slate-700",children:[g.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[g.jsx(YE,{size:14,className:"text-blue-500 mt-0.5"}),g.jsx("p",{className:"text-[10px] font-bold text-blue-700 dark:text-blue-400 uppercase tracking-wide",children:"Sync Info"})]}),g.jsxs("p",{className:"text-[11px] text-gray-600 dark:text-slate-400 leading-relaxed",children:[g.jsx("strong",{children:"Don't see a user?"}),g.jsx("br",{}),"Google accounts from Firebase only appear here ",g.jsx("em",{children:"after"})," they log in to this app for the first time."]})]})]})}),g.jsx("div",{className:"lg:col-span-2",children:g.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg border border-gray-100 dark:border-slate-700 overflow-hidden flex flex-col h-[600px]",children:[g.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-slate-700 flex items-center justify-between gap-4",children:[g.jsxs("h3",{className:"text-sm font-black uppercase tracking-wide text-gray-900 dark:text-white flex-shrink-0",children:["Total Accounts (",e.length,")"]}),g.jsxs("div",{className:"relative flex-1 max-w-xs",children:[g.jsx(YN,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:14}),g.jsx("input",{type:"text",placeholder:"Search accounts...",value:h,onChange:v=>p(v.target.value),className:"w-full pl-9 pr-3 py-2 bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-700 rounded-lg text-xs text-gray-900 dark:text-white outline-none focus:ring-1 focus:ring-blue-500 placeholder-gray-400"})]})]}),g.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2",children:r?g.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-sm",children:"Loading accounts..."}):w.length===0?g.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 gap-2",children:[g.jsx(pa,{size:32,className:"opacity-20"}),g.jsx("p",{className:"text-sm",children:"No accounts found."})]}):g.jsx("div",{className:"space-y-2",children:w.map(v=>{const E=v.email||v.username||"Unknown",I=E==="admin@internal",k=v.role==="admin";return g.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors border border-transparent hover:border-gray-100 dark:hover:border-slate-700 group",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[v.photoURL?g.jsx("img",{src:v.photoURL,alt:v.displayName||E,className:"w-10 h-10 rounded-full object-cover border border-gray-200 dark:border-slate-600"}):g.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-white shadow-sm font-bold ${k?"bg-gradient-to-br from-purple-500 to-indigo-600":"bg-gradient-to-br from-blue-400 to-cyan-500"}`,children:(v.displayName||E).charAt(0).toUpperCase()}),g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-white",children:v.displayName||E}),I&&g.jsx("span",{className:"text-[9px] bg-yellow-100 text-yellow-800 px-1.5 rounded font-bold",children:"MASTER"}),v.password&&g.jsx("div",{title:"Local Password Set",children:g.jsx(Ga,{size:10,className:"text-gray-400"})})]}),g.jsx("p",{className:"text-xs text-gray-400",children:E})]})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("div",{className:"flex flex-col items-end gap-1",children:[g.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Admin Access"}),g.jsx("button",{onClick:()=>C(v),className:`
                                                relative w-11 h-6 rounded-full transition-colors duration-200 ease-in-out focus:outline-none
                                                ${k?"bg-purple-600":"bg-gray-200 dark:bg-slate-600"}
                                            `,title:k?"Revoke Admin":"Grant Admin",children:g.jsx("span",{className:`
                                                    absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 ease-in-out shadow-sm
                                                    ${k?"translate-x-5":"translate-x-0"}
                                                `})})]}),g.jsx("button",{onClick:()=>y(v),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:"Delete Account",children:g.jsx(_r,{size:16})})]})]},E)})})})]})})]})]})},h6=()=>{const[t,e]=S.useState(null),[n,r]=S.useState([]),[i,o]=S.useState(!0);return S.useEffect(()=>{const s=bp.onAuthStateChanged(u=>{if(e(u),o(!1),u){const f=we.ref("/status/"+u.uid),h=we.ref(".info/connected");h.on("value",m=>{m.val()!==!1&&f.onDisconnect().remove().then(()=>{f.set({uid:u.uid,displayName:u.displayName,photoURL:u.photoURL,email:u.email,status:"online",lastSeen:Xt.database.ServerValue.TIMESTAMP})})});const p=()=>{document.visibilityState==="hidden"?f.update({status:"idle"}):f.update({status:"online",lastSeen:Xt.database.ServerValue.TIMESTAMP})};return document.addEventListener("visibilitychange",p),()=>{document.removeEventListener("visibilitychange",p),h.off()}}}),a=we.ref("/status"),l=u=>{const f=u.val();if(f){const h=Object.values(f);r(h)}else r([])};return a.on("value",l),()=>{s(),a.off("value",l)}},[]),{currentUser:t,activeUsers:n,loading:i}},p6=()=>{var gt,En;const{currentUser:t,activeUsers:e,loading:n}=h6(),[r,i]=S.useState(null),[o,s]=S.useState(!1),a=S.useMemo(()=>r?{uid:r.uid||"local_user_"+Date.now(),displayName:r.displayName||r.username||"Local User",email:r.email||r.username||"local_user",photoURL:r.photoURL||null,isLocal:!0,role:r.role}:t?{uid:t.uid,displayName:t.displayName||"User",email:t.email||"",photoURL:t.photoURL,isLocal:!1,role:null}:null,[t,r]),[l,u]=S.useState([]),[f,h]=S.useState(Cy),[p,m]=S.useState(""),[_,x]=S.useState("All"),[C,y]=S.useState(()=>{try{const M=localStorage.getItem("app_current_view");if(M&&Object.values(Ce).includes(M))return M}catch(M){console.error("Failed to load view state",M)}return Ce.HOME});S.useEffect(()=>{localStorage.setItem("app_current_view",C)},[C]);const[w,v]=S.useState(!1),[E,I]=S.useState(!1),[k,b]=S.useState(!1),[T,R]=S.useState({isOpen:!1,type:"add",initialValue:"",targetCategory:null}),[N,D]=S.useState({isOpen:!1,category:null}),[G,F]=S.useState(null),J=S.useRef(null);S.useEffect(()=>{if(r){F(r.role);return}if(!a||!a.email){F(null),J.current=null;return}const M=a.email;if(J.current!==M)try{const W=M.replace(/\./g,","),Y=we.ref(`accounts/${W}`);Y.once("value").then(ye=>{const ie=ye.val();if(ie)Y.update({displayName:a.displayName,photoURL:a.photoURL,lastLogin:Date.now()}),F(ie.role||"user");else{const Xe={email:M,role:"user",displayName:a.displayName,photoURL:a.photoURL,lastLogin:Date.now(),uid:a.uid,isLocal:!1};Y.set(Xe),F("user")}J.current=M}).catch(ye=>{console.error("Auth DB Error:",ye),F("user")})}catch(W){console.error("Critical Auth Error:",W),F("user")}},[a,r]);const re=S.useMemo(()=>G==="admin",[G]),[Oe,ee]=S.useState(!1),[V,P]=S.useState(void 0),[A,B]=S.useState(null),[$,q]=S.useState(null),[ue,ve]=S.useState(null),[ae,Ae]=S.useState(!1),[Mt,Et]=S.useState(null),[he,Ci]=S.useState("cloud"),[Ct,Nr]=S.useState(!1),[on,Rr]=S.useState(!0),[Ar,Si]=S.useState(!1),[Wd,Ns]=S.useState({show:!1,title:"",message:"",type:"info"}),Hn=()=>s(!0),Ti=async()=>{try{await bp.signInWithPopup(z4),s(!1)}catch(M){console.error("Login failed",M),Ee("Google Login failed")}},Ii=M=>{i(M),Ee(`Welcome, ${M.displayName||M.username}`),s(!1)},Ul=async()=>{try{y(Ce.HOME),localStorage.removeItem("app_current_view"),r?i(null):await bp.signOut(),u([]),F(null),J.current=null,Ee("Logged out")}catch(M){console.error("Logout failed",M)}};S.useEffect(()=>{if(!(a!=null&&a.uid)){u([]);return}Ae(!0);const M=we.ref(`users/${a.uid}/spiels`),W=ye=>{const ie=ye.val();if(ie){const Xe=Object.values(ie).map(_e=>({..._e,id:_e.id||"unknown_"+Math.random(),title:_e.title||"Untitled",english:_e.english||"",brazil:_e.brazil||"",tags:_e.tags||[],images:_e.images||[],category:_e.category||"N/A",createdAt:_e.createdAt||Date.now(),color:_e.color||"bg-white dark:bg-[#202124]"}));Xe.sort((_e,St)=>_e.order!==void 0&&St.order!==void 0?_e.order-St.order:St.createdAt-_e.createdAt),u(Xe)}else u([]);Ae(!1)};return we.ref(`users/${a.uid}/settings/categories`).once("value").then(ye=>{const ie=ye.val();ie&&Array.isArray(ie)?h(ie):h(Cy)}),M.on("value",W,ye=>{console.error(ye),Ae(!1),Ci("error")}),()=>{M.off("value",W)}},[a]),S.useEffect(()=>{Ct?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[Ct]);const Ee=M=>{ve(M),setTimeout(()=>ve(null),3e3)},ho=S.useMemo(()=>l,[l]),ki=S.useMemo(()=>ho.filter(M=>{if(M.isDeleted)return!1;const W=_==="All"||M.category===_,Y=p.toLowerCase(),ye=(M.title||"").toLowerCase(),ie=(M.english||"").toLowerCase(),Xe=(M.brazil||"").toLowerCase(),_e=ye.includes(Y)||ie.includes(Y)||Xe.includes(Y)||(M.tags||[]).some(St=>St.toLowerCase().includes(Y));return W&&_e}),[ho,_,p]),Pr=S.useMemo(()=>ho.filter(M=>M.isDeleted),[ho]),Bn=S.useMemo(()=>ki.filter(M=>M.isPinned),[ki]),Mr=S.useMemo(()=>ki.filter(M=>!M.isPinned),[ki]),Fl=M=>{if(C!==Ce.HOME)y(Ce.HOME),setTimeout(()=>{const W=document.getElementById(M);W&&(W.scrollIntoView({behavior:"smooth",block:"center"}),W.classList.add("ring-2","ring-blue-500"),setTimeout(()=>W.classList.remove("ring-2","ring-blue-500"),2e3))},100);else{const W=document.getElementById(M);W&&(W.scrollIntoView({behavior:"smooth",block:"center"}),W.classList.add("ring-2","ring-blue-500"),setTimeout(()=>W.classList.remove("ring-2","ring-blue-500"),2e3))}Si(!1)},Gn=async M=>{if(!(a!=null&&a.uid)){Ns({show:!0,title:"Login Required",message:"You must be logged in to create or edit personal templates.",type:"error"});return}try{if(V)await we.ref(`users/${a.uid}/spiels/${V.id}`).set({...V,...M}),Ee("Template updated");else{const Y=we.ref(`users/${a.uid}/spiels`).push(),ye=l.length,ie={...M,id:Y.key,createdAt:Date.now(),isDeleted:!1,isDefault:!1,isPinned:!1,order:ye};await Y.set(ie),Ee("New template created")}ee(!1),P(void 0)}catch(W){console.error(W),Ee("Error saving template")}},Vl=async(M,W)=>{if(a!=null&&a.uid)try{await we.ref(`users/${a.uid}/spiels/${M}`).update(W),Ee("Saved")}catch(Y){console.error("Quick save failed",Y),Ee("Failed to save changes")}},po=async M=>{if(a!=null&&a.uid)try{await we.ref(`users/${a.uid}/settings/categories`).set(M),h(M)}catch(W){console.error("Failed to save categories",W),Ee("Failed to save categories")}},qd=()=>{R({isOpen:!0,type:"add",initialValue:"",targetCategory:null})},Rs=M=>{R({isOpen:!0,type:"edit",initialValue:M,targetCategory:M})},Hl=M=>{D({isOpen:!0,category:M})},Jd=async M=>{const W=M.trim();if(W){if(T.type==="add"){if(f.includes(W)){Ee("Category already exists");return}const Y=[...f,W];await po(Y),Ee("Category added")}else if(T.type==="edit"&&T.targetCategory){const Y=T.targetCategory;if(W!==Y){if(f.includes(W)){Ee("Category name already exists");return}const ye=f.map(ie=>ie===Y?W:ie);if(await po(ye),a!=null&&a.uid){const ie={};l.forEach(Xe=>{Xe.category===Y&&(ie[`users/${a.uid}/spiels/${Xe.id}/category`]=W)}),Object.keys(ie).length>0&&(await we.ref().update(ie),Ee(`Updated spiels to "${W}"`))}}}R({...T,isOpen:!1})}},Bl=async()=>{const M=N.category;if(!M)return;const W=f.filter(Y=>Y!==M);if(await po(W),_===M&&x("All"),a!=null&&a.uid){const Y={};l.forEach(ye=>{ye.category===M&&(Y[`users/${a.uid}/spiels/${ye.id}/category`]="N/A")}),Object.keys(Y).length>0&&await we.ref().update(Y),Ee("Category deleted")}D({isOpen:!1,category:null})},Gl=async M=>{if(!(a!=null&&a.uid)){Ee("Login to pin items");return}try{await we.ref(`users/${a.uid}/spiels/${M.id}`).set({...M,isPinned:!M.isPinned})}catch(W){console.error(W),Ee("Failed to pin")}},As=async M=>{if(!(a!=null&&a.uid))return;const W=l.find(Y=>Y.id===M);W&&(await we.ref(`users/${a.uid}/spiels/${M}`).set({...W,isDeleted:!1}),Ee("Spiel restored"))},jd=async()=>{if(!Mt||!(a!=null&&a.uid))return;const M=Mt,W=we.ref(`users/${a.uid}/spiels/${M}`),Y=l.find(ye=>ye.id===M);Y!=null&&Y.isDeleted?(await W.remove(),Ee("Spiel permanently deleted")):Y&&(await W.set({...Y,isDeleted:!0}),Ee("Moved to Trash")),Et(null)},We=M=>{M.isDefault?B(M):(P(M),ee(!0))},pt=()=>g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"p-4 pl-6 border-b border-gray-100 dark:border-gray-800",children:g.jsxs("div",{className:"space-y-1",children:[g.jsxs("button",{onClick:()=>y(Ce.CHAT),className:`w-full text-left px-3 py-2 text-xs font-bold rounded-lg flex items-center gap-2 ${C===Ce.CHAT?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[g.jsx(qN,{size:14,className:C===Ce.CHAT?"text-blue-500":"text-gray-400"}),g.jsx("span",{className:re?"":"line-through decoration-gray-400 opacity-70",children:"Chat AI"})]}),g.jsxs("button",{onClick:()=>y(Ce.TRANSLATOR),className:`w-full text-left px-3 py-2 text-xs font-bold rounded-lg flex items-center gap-2 ${C===Ce.TRANSLATOR?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[g.jsx(zN,{size:14,className:C===Ce.TRANSLATOR?"text-orange-500":"text-gray-400"}),g.jsx("span",{className:re?"":"line-through decoration-gray-400 opacity-70",children:"Translator AI"})]}),g.jsxs("button",{onClick:()=>y(Ce.EDITOR),className:`w-full text-left px-3 py-2 text-xs font-bold rounded-lg flex items-center gap-2 ${C===Ce.EDITOR?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[g.jsx(ZE,{size:14,className:C===Ce.EDITOR?"text-purple-500":"text-gray-400"})," Image Editor"]}),re&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"my-2 border-t border-gray-100 dark:border-gray-800 mx-2"}),g.jsxs("button",{onClick:()=>y(Ce.ADMIN),className:`w-full text-left px-3 py-2 text-xs font-bold rounded-lg flex items-center gap-2 ${C===Ce.ADMIN?"bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400":"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[g.jsx(Bh,{size:14,className:C===Ce.ADMIN?"text-purple-500":"text-gray-400"})," Administrator"]})]})]})}),g.jsx("div",{className:"flex flex-col flex-1 min-h-0",children:g.jsxs("div",{className:"pt-6",children:[g.jsxs("div",{className:"px-5 mb-3 flex items-center justify-between group",children:[g.jsx("button",{onClick:()=>{y(Ce.HOME),Si(!1)},className:"text-sm font-semibold text-gray-800 dark:text-gray-200 hover:text-blue-600 dark:hover:text-blue-400 transition-colors flex items-center gap-2 w-full text-left",children:"Spiels"}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("button",{onClick:()=>b(!0),className:"p-1.5 rounded-lg transition-all text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-600 dark:hover:text-gray-300",title:"View Trash",children:g.jsx(_r,{size:16})}),g.jsx("button",{onClick:()=>{P(void 0),ee(!0),y(Ce.HOME)},className:"p-1.5 rounded-lg text-gray-400 hover:bg-blue-50 hover:text-blue-600 dark:hover:bg-blue-900/20 dark:hover:text-blue-400 transition-all",title:"Create Spiel",children:g.jsx(Nu,{size:16})})]})]}),g.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mx-5 mb-2"}),g.jsx("div",{className:"px-0",children:g.jsx(ZA,{spiels:l.filter(M=>!M.isDeleted),onSelectSpiel:Fl,filterText:p,variant:"user"})})]})}),g.jsx("div",{className:"p-6 border-t border-gray-100 dark:border-gray-800 mt-auto bg-gray-50/50 dark:bg-black/20",children:g.jsxs("div",{className:"group flex items-start gap-3 p-3 rounded-xl hover:bg-white dark:hover:bg-slate-800 transition-all border border-transparent hover:border-gray-200 dark:hover:border-slate-700",children:[g.jsx(jE,{size:14,className:"text-gray-400 group-hover:text-blue-500 mt-0.5"}),g.jsxs("p",{className:"text-[10px] font-bold text-gray-500 dark:text-gray-500 leading-relaxed group-hover:text-gray-900 dark:group-hover:text-gray-200 transition-colors",children:["If there's a bug or improvements, kindly contact ",g.jsx("a",{href:"#",className:"text-blue-600 dark:text-blue-400 font-black hover:underline",children:"Kong"}),"."]})]})})]});return n?g.jsx("div",{className:"h-screen w-full flex items-center justify-center bg-gray-50 dark:bg-slate-900",children:g.jsx(Vg,{className:"animate-spin text-blue-500",size:32})}):a?g.jsxs("div",{className:"h-screen flex flex-col bg-[#f0f2f5] dark:bg-[#202124] transition-colors duration-300 overflow-hidden font-sans relative",children:[g.jsx(sR,{isAdmin:re||!1,activeUsers:e,currentUser:a,onLogin:Hn,onLogout:Ul,syncStatus:he,isSyncing:ae,isDarkMode:Ct,toggleDarkMode:()=>Nr(!Ct),onToggleSidebar:()=>Rr(!on),onLogoClick:()=>y(Ce.HOME)}),o&&g.jsx(t_,{onClose:()=>s(!1),onGoogleLogin:Ti,onAdminLogin:Ii}),$&&g.jsx(q4,{src:$,onClose:()=>q(null),onCopy:Ee}),T.isOpen&&g.jsx(J4,{title:T.type==="add"?"New Category":"Rename Category",initialValue:T.initialValue,placeholder:"Enter category name",onConfirm:Jd,onCancel:()=>R({...T,isOpen:!1})}),N.isOpen&&g.jsx(Uy,{title:"Delete Category?",message:`Are you sure you want to delete "${N.category}"? Spiels will be moved to 'N/A'.`,onConfirm:Bl,onCancel:()=>D({isOpen:!1,category:null})}),A&&g.jsx(W4,{spiel:A,onClose:()=>B(null),onCopy:Ee,isAdmin:!A.isDefault,onEdit:()=>{B(null),P(A),ee(!0)},onSave:Vl,onViewImage:q}),g.jsxs("div",{className:"flex flex-1 overflow-hidden relative",children:[g.jsx("aside",{className:`
          bg-white dark:bg-[#202124] border-r border-gray-100 dark:border-gray-800 flex-shrink-0 hidden md:flex flex-col z-10 transition-all duration-300 ease-in-out
          ${on?"w-72 opacity-100":"w-0 opacity-0 overflow-hidden border-none"}
        `,children:g.jsx(pt,{})}),Ar&&g.jsxs("div",{className:"fixed inset-0 z-50 md:hidden flex",children:[g.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>Si(!1)}),g.jsxs("aside",{className:"relative w-72 bg-white dark:bg-[#202124] h-full shadow-2xl flex flex-col transition-all animate-in slide-in-from-left duration-300",children:[g.jsxs("div",{className:"p-4 flex justify-between items-center border-b border-gray-100 dark:border-gray-800 bg-gray-50 dark:bg-black/20",children:[g.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-gray-500 dark:text-gray-400",children:"Navigation"}),g.jsx("button",{onClick:()=>Si(!1),className:"text-gray-400 hover:text-red-500 transition-colors bg-transparent p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",children:g.jsx(io,{size:18})})]}),g.jsx(pt,{})]})]}),g.jsx("main",{className:"flex-1 flex flex-col min-w-0 overflow-hidden relative",children:C===Ce.HOME?g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"bg-[#f0f2f5]/90 dark:bg-[#202124]/90 backdrop-blur-md z-20 px-4 sm:px-8 pt-6 pb-2",children:g.jsxs("div",{className:"w-full mx-auto space-y-4",children:[g.jsx("div",{className:"flex items-center gap-4",children:g.jsx("div",{className:"flex-1 flex justify-center",children:g.jsx(aR,{value:p,onChange:m})})}),g.jsx("div",{className:"w-full border-t border-gray-200 dark:border-gray-800 pt-2",children:g.jsx(YA,{categories:f,selected:_,onSelect:x,isAdmin:!0,onReorder:po,isEditMode:E,onToggleEditMode:()=>I(!E),onAddCategory:qd,onEditCategory:Rs,onDeleteCategory:Hl})})]})}),g.jsx("div",{className:"flex-1 overflow-y-auto px-4 sm:px-8 scroll-smooth",children:g.jsxs("div",{className:"w-full pb-24 mx-auto",children:[l.length===0&&!ae&&g.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] text-center animate-in fade-in slide-in-from-bottom-4",children:[g.jsx("div",{className:"w-24 h-24 bg-white dark:bg-[#303134] rounded-full flex items-center justify-center shadow-xl mb-6",children:g.jsx(Nu,{size:48,className:"text-gray-300 dark:text-gray-600"})}),g.jsx("h2",{className:"text-2xl font-black text-gray-800 dark:text-gray-200 mb-2",children:"You don't have spiels yet"}),g.jsx("p",{className:"text-gray-500 dark:text-gray-400 max-w-sm mb-8 leading-relaxed",children:"Start building your personal library of response templates. They will appear here like sticky notes."}),g.jsxs("button",{onClick:()=>{P(void 0),ee(!0)},className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-2xl font-bold shadow-lg shadow-blue-500/30 transition-all hover:-translate-y-1",children:[g.jsx(Nu,{size:20}),"Create your first spiel"]})]}),Bn.length>0&&g.jsxs("div",{className:"mb-8",children:[g.jsx("div",{className:"flex items-center gap-2 mb-4 px-1",children:g.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Pinned"})}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-4",children:Bn.map(M=>g.jsx(Jh,{spiel:M,onCopy:Ee,isAdmin:!M.isDefault,onClick:()=>We(M),onDelete:()=>Et(M.id),onRestore:()=>As(M.id),onPin:()=>Gl(M),onExpand:()=>B(M),onViewImage:q,isEditMode:w},M.id))}),g.jsx("div",{className:"my-8 border-t border-gray-200 dark:border-gray-700"})]}),Bn.length>0&&Mr.length>0&&g.jsx("div",{className:"flex items-center gap-2 mb-4 px-1",children:g.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Others"})}),l.length>0&&g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-4",children:Mr.map(M=>g.jsx(Jh,{spiel:M,onCopy:Ee,isAdmin:!M.isDefault,onClick:()=>We(M),onDelete:()=>Et(M.id),onRestore:()=>As(M.id),onPin:()=>Gl(M),onExpand:()=>B(M),onViewImage:q,isEditMode:w},M.id))}),ki.length===0&&l.length>0&&g.jsx("div",{className:"text-center py-20 opacity-50",children:g.jsx("p",{children:"No spiels match your search."})})]})})]}):g.jsxs("div",{className:"h-full w-full overflow-hidden bg-[#f0f2f5] dark:bg-[#202124]",children:[C===Ce.CHAT&&g.jsx(u6,{user:a,isAdmin:re||!1}),C===Ce.TRANSLATOR&&g.jsx(c6,{isAdmin:re||!1}),C===Ce.EDITOR&&g.jsx(d6,{}),C===Ce.ADMIN&&g.jsx(f6,{currentUserEmail:(a==null?void 0:a.email)||(a==null?void 0:a.displayName)||"Admin"})]})})]}),k&&g.jsx(j4,{deletedSpiels:Pr,onClose:()=>b(!1),onRestore:As,onDeleteForever:M=>Et(M)}),Oe&&g.jsx(XA,{categories:f,onClose:()=>ee(!1),onSubmit:Gn,initialData:V,currentSpiels:l,isAdmin:re}),Mt&&g.jsx(Uy,{title:(gt=l.find(M=>M.id===Mt))!=null&&gt.isDeleted?"Delete Forever?":"Move to Trash?",message:(En=l.find(M=>M.id===Mt))!=null&&En.isDeleted?"This action cannot be undone.":"You can restore this later from the Trash.",onConfirm:jd,onCancel:()=>Et(null)}),ue&&g.jsx(jh,{message:ue})]}):g.jsxs(g.Fragment,{children:[g.jsx(t_,{onClose:()=>{},onGoogleLogin:Ti,onAdminLogin:Ii,isLanding:!0}),ue&&g.jsx(jh,{message:ue})]})},$p=document.getElementById("root");if(!$p)throw console.error("CRITICAL: Root element not found!"),new Error("Could not find root element to mount to");try{Jf.createRoot($p).render(g.jsx(kt.StrictMode,{children:g.jsx(p6,{})}))}catch(t){console.error("CRITICAL: React render failed",t),$p.innerHTML='<div style="color:red; padding: 20px; text-align: center;"><h1>Application Error</h1><p>Failed to start application. Please check the console for details.</p></div>'}
